---
title: "Data Structure and Algorithm Analysis (H) Final Review Note"
tags:
- DSAA
- Review Note
excerpt: "Final review note for CS217 Data Structure and Algorithm Analysis (H)"
---

<!DOCTYPE html><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>1 Sorting Algorithms</title>
<!--Generated on Sat Jul 27 22:27:28 2024 by LaTeXML (version 0.8.6) http://dlmf.nist.gov/LaTeXML/.-->

<link rel="stylesheet" href="{{ site.baseurl }}/assets/css/LaTeXML.css" type="text/css">
<link rel="stylesheet" href="{{ site.baseurl }}/assets/css/ltx-article.css" type="text/css">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document">
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Sorting Algorithms</h2>

<section id="S1.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">1.1 </span>Sorting Based on Comparison</h3>

<section id="S1.SS1.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">1.1.1 </span>Insertion Sort</h4>

<div id="S1.SS1.SSS1.p1" class="ltx_para ltx_noindent">
<p class="ltx_p">Inserting sort maintains a subarray of sorted element.
At each iteration, it inserts a new element into the subarray on the correct position.</p>
</div>
<div id="S1.SS1.SSS1.p2" class="ltx_para ltx_noindent">
<p class="ltx_p"><span class="ltx_text ltx_font_bold">Runtime:</span>
<math id="S1.SS1.SSS1.p2.m1" class="ltx_Math" alttext="\Omega(n)" display="inline"><mrow><mi mathvariant="normal">Ω</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></mrow></math>, <math id="S1.SS1.SSS1.p2.m2" class="ltx_Math" alttext="O(n^{2})" display="inline"><mrow><mi>O</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><msup><mi>n</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mrow></mrow></math></p>
</div>
<div id="S1.SS1.SSS1.p3" class="ltx_para ltx_noindent">
<p class="ltx_p"><span class="ltx_text ltx_font_bold">Correctness:</span>
Proof by loop invariant: at the start of each iteration of the for loop, the subarray <math id="S1.SS1.SSS1.p3.m1" class="ltx_Math" alttext="A[1..j-1]" display="inline"><mrow><mi>A</mi><mrow><mo stretchy="false">[</mo><mn>1</mn><mo>.</mo><mo>.</mo><mi>j</mi><mo>-</mo><mn>1</mn><mo stretchy="false">]</mo></mrow></mrow></math> consists of the element originally in <math id="S1.SS1.SSS1.p3.m2" class="ltx_Math" alttext="A[1..j-1]" display="inline"><mrow><mi>A</mi><mrow><mo stretchy="false">[</mo><mn>1</mn><mo>.</mo><mo>.</mo><mi>j</mi><mo>-</mo><mn>1</mn><mo stretchy="false">]</mo></mrow></mrow></math>, but in sorted order.</p>
</div>
<div id="S1.SS1.SSS1.p4" class="ltx_para ltx_noindent">
<p class="ltx_p"><span class="ltx_text ltx_font_bold">Inplace:</span>
Yes</p>
</div>
<div id="S1.SS1.SSS1.p5" class="ltx_para ltx_noindent">
<p class="ltx_p"><span class="ltx_text ltx_font_bold">Stable:</span>
Yes</p>
</div>
<div id="S1.SS1.SSS1.p6" class="ltx_para ltx_align_center">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr class="ltx_tr">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" colspan="2"><span class="ltx_text ltx_font_smallcaps">Insertion-Sort<math id="S1.SS1.SSS1.p6.m1" class="ltx_Math" alttext="(A)" display="inline"><mrow><mo mathvariant="normal" stretchy="false">(</mo><mi>A</mi><mo mathvariant="normal" stretchy="false">)</mo></mrow></math></span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">1.</th>
<td class="ltx_td ltx_align_left ltx_border_t">
<span class="ltx_text ltx_font_bold">for</span> <math id="S1.SS1.SSS1.p6.m2" class="ltx_Math" alttext="j=2" display="inline"><mrow><mi>j</mi><mo>=</mo><mn>2</mn></mrow></math> to <math id="S1.SS1.SSS1.p6.m3" class="ltx_Math" alttext="A.length" display="inline"><mrow><mi>A</mi><mo>.</mo><mrow><mi>l</mi><mo>⁢</mo><mi>e</mi><mo>⁢</mo><mi>n</mi><mo>⁢</mo><mi>g</mi><mo>⁢</mo><mi>t</mi><mo>⁢</mo><mi>h</mi></mrow></mrow></math>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row">2.</th>
<td class="ltx_td ltx_align_left"> <math id="S1.SS1.SSS1.p6.m4" class="ltx_Math" alttext="key=A[j]" display="inline"><mrow><mrow><mi>k</mi><mo>⁢</mo><mi>e</mi><mo>⁢</mo><mi>y</mi></mrow><mo>=</mo><mrow><mi>A</mi><mo>⁢</mo><mrow><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo></mrow></mrow></mrow></math>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row">3.</th>
<td class="ltx_td ltx_align_left"> <math id="S1.SS1.SSS1.p6.m5" class="ltx_Math" alttext="i=j-1" display="inline"><mrow><mi>i</mi><mo>=</mo><mrow><mi>j</mi><mo>-</mo><mn>1</mn></mrow></mrow></math>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row">4.</th>
<td class="ltx_td ltx_align_left"> <span class="ltx_text ltx_font_bold">while</span> <math id="S1.SS1.SSS1.p6.m6" class="ltx_Math" alttext="i&gt;0" display="inline"><mrow><mi>i</mi><mo>&gt;</mo><mn>0</mn></mrow></math> and <math id="S1.SS1.SSS1.p6.m7" class="ltx_Math" alttext="A[i]&gt;key" display="inline"><mrow><mrow><mi>A</mi><mo>⁢</mo><mrow><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo></mrow></mrow><mo>&gt;</mo><mrow><mi>k</mi><mo>⁢</mo><mi>e</mi><mo>⁢</mo><mi>y</mi></mrow></mrow></math>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row">5.</th>
<td class="ltx_td ltx_align_left">  <math id="S1.SS1.SSS1.p6.m8" class="ltx_Math" alttext="A[i+1]=A[i]" display="inline"><mrow><mrow><mi>A</mi><mo>⁢</mo><mrow><mo stretchy="false">[</mo><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow><mo stretchy="false">]</mo></mrow></mrow><mo>=</mo><mrow><mi>A</mi><mo>⁢</mo><mrow><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo></mrow></mrow></mrow></math>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row">6.</th>
<td class="ltx_td ltx_align_left">  <math id="S1.SS1.SSS1.p6.m9" class="ltx_Math" alttext="i=i-1" display="inline"><mrow><mi>i</mi><mo>=</mo><mrow><mi>i</mi><mo>-</mo><mn>1</mn></mrow></mrow></math>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb">7.</th>
<td class="ltx_td ltx_align_left ltx_border_bb"> <math id="S1.SS1.SSS1.p6.m10" class="ltx_Math" alttext="A[i+1]=key" display="inline"><mrow><mrow><mi>A</mi><mo>⁢</mo><mrow><mo stretchy="false">[</mo><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow><mo stretchy="false">]</mo></mrow></mrow><mo>=</mo><mrow><mi>k</mi><mo>⁢</mo><mi>e</mi><mo>⁢</mo><mi>y</mi></mrow></mrow></math>
</td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="S1.SS1.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">1.1.2 </span>Selection Sort</h4>

<div id="S1.SS1.SSS2.p1" class="ltx_para ltx_noindent">
<p class="ltx_p">Selection sort maintains a subarray of sorted element.
At each iteration, it selects the smallest element in the unsorted subarray, and swap it with the first element in the unsorted subarray.</p>
</div>
<div id="S1.SS1.SSS2.p2" class="ltx_para ltx_noindent">
<p class="ltx_p"><span class="ltx_text ltx_font_bold">Runtime:</span>
<math id="S1.SS1.SSS2.p2.m1" class="ltx_Math" alttext="\Theta(n^{2})" display="inline"><mrow><mi mathvariant="normal">Θ</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><msup><mi>n</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mrow></mrow></math></p>
</div>
<div id="S1.SS1.SSS2.p3" class="ltx_para ltx_noindent">
<p class="ltx_p"><span class="ltx_text ltx_font_bold">Correctness:</span>
Proof by loop invariant: at the start of each iteration of the for loop, the subarray <math id="S1.SS1.SSS2.p3.m1" class="ltx_Math" alttext="A[1..i-1]" display="inline"><mrow><mi>A</mi><mrow><mo stretchy="false">[</mo><mn>1</mn><mo>.</mo><mo>.</mo><mi>i</mi><mo>-</mo><mn>1</mn><mo stretchy="false">]</mo></mrow></mrow></math> consists of the <math id="S1.SS1.SSS2.p3.m2" class="ltx_Math" alttext="i-1" display="inline"><mrow><mi>i</mi><mo>-</mo><mn>1</mn></mrow></math> smallest elements.</p>
</div>
<div id="S1.SS1.SSS2.p4" class="ltx_para ltx_noindent">
<p class="ltx_p"><span class="ltx_text ltx_font_bold">Inplace:</span>
Yes</p>
</div>
<div id="S1.SS1.SSS2.p5" class="ltx_para ltx_noindent">
<p class="ltx_p"><span class="ltx_text ltx_font_bold">Stable:</span>
No (example: <math id="S1.SS1.SSS2.p5.m1" class="ltx_Math" alttext="[2_{a},2_{b},1]" display="inline"><mrow><mo stretchy="false">[</mo><msub><mn>2</mn><mi>a</mi></msub><mo>,</mo><msub><mn>2</mn><mi>b</mi></msub><mo>,</mo><mn>1</mn><mo stretchy="false">]</mo></mrow></math>)</p>
</div>
<div id="S1.SS1.SSS2.p6" class="ltx_para ltx_align_center">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr class="ltx_tr">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" colspan="2"><span class="ltx_text ltx_font_smallcaps">Selection-Sort<math id="S1.SS1.SSS2.p6.m1" class="ltx_Math" alttext="(A)" display="inline"><mrow><mo mathvariant="normal" stretchy="false">(</mo><mi>A</mi><mo mathvariant="normal" stretchy="false">)</mo></mrow></math></span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">1.</th>
<td class="ltx_td ltx_align_left ltx_border_t">
<span class="ltx_text ltx_font_bold">for</span> <math id="S1.SS1.SSS2.p6.m2" class="ltx_Math" alttext="i=1" display="inline"><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow></math> to <math id="S1.SS1.SSS2.p6.m3" class="ltx_Math" alttext="A.length-1" display="inline"><mrow><mi>A</mi><mo>.</mo><mrow><mrow><mi>l</mi><mo>⁢</mo><mi>e</mi><mo>⁢</mo><mi>n</mi><mo>⁢</mo><mi>g</mi><mo>⁢</mo><mi>t</mi><mo>⁢</mo><mi>h</mi></mrow><mo>-</mo><mn>1</mn></mrow></mrow></math>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row">2.</th>
<td class="ltx_td ltx_align_left"> <math id="S1.SS1.SSS2.p6.m4" class="ltx_Math" alttext="min=i" display="inline"><mrow><mrow><mi>m</mi><mo>⁢</mo><mi>i</mi><mo>⁢</mo><mi>n</mi></mrow><mo>=</mo><mi>i</mi></mrow></math>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row">3.</th>
<td class="ltx_td ltx_align_left"> <span class="ltx_text ltx_font_bold">for</span> <math id="S1.SS1.SSS2.p6.m5" class="ltx_Math" alttext="j=i+1" display="inline"><mrow><mi>j</mi><mo>=</mo><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></mrow></math> to <math id="S1.SS1.SSS2.p6.m6" class="ltx_Math" alttext="A.length" display="inline"><mrow><mi>A</mi><mo>.</mo><mrow><mi>l</mi><mo>⁢</mo><mi>e</mi><mo>⁢</mo><mi>n</mi><mo>⁢</mo><mi>g</mi><mo>⁢</mo><mi>t</mi><mo>⁢</mo><mi>h</mi></mrow></mrow></math>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row">4.</th>
<td class="ltx_td ltx_align_left">  <span class="ltx_text ltx_font_bold">if</span> <math id="S1.SS1.SSS2.p6.m7" class="ltx_Math" alttext="A[j]&lt;A[min]" display="inline"><mrow><mrow><mi>A</mi><mo>⁢</mo><mrow><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo></mrow></mrow><mo>&lt;</mo><mrow><mi>A</mi><mo>⁢</mo><mrow><mo stretchy="false">[</mo><mrow><mi>m</mi><mo>⁢</mo><mi>i</mi><mo>⁢</mo><mi>n</mi></mrow><mo stretchy="false">]</mo></mrow></mrow></mrow></math>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row">5.</th>
<td class="ltx_td ltx_align_left">   <math id="S1.SS1.SSS2.p6.m8" class="ltx_Math" alttext="min=j" display="inline"><mrow><mrow><mi>m</mi><mo>⁢</mo><mi>i</mi><mo>⁢</mo><mi>n</mi></mrow><mo>=</mo><mi>j</mi></mrow></math>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb">6.</th>
<td class="ltx_td ltx_align_left ltx_border_bb"> exchange <math id="S1.SS1.SSS2.p6.m9" class="ltx_Math" alttext="A[i]" display="inline"><mrow><mi>A</mi><mo>⁢</mo><mrow><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo></mrow></mrow></math> with <math id="S1.SS1.SSS2.p6.m10" class="ltx_Math" alttext="A[min]" display="inline"><mrow><mi>A</mi><mo>⁢</mo><mrow><mo stretchy="false">[</mo><mrow><mi>m</mi><mo>⁢</mo><mi>i</mi><mo>⁢</mo><mi>n</mi></mrow><mo stretchy="false">]</mo></mrow></mrow></math>
</td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="S1.SS1.SSS3" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">1.1.3 </span>Merge Sort</h4>

<div id="S1.SS1.SSS3.p1" class="ltx_para ltx_noindent">
<p class="ltx_p">Merge sort divides the array into two parts, sort each part recursively, and then merge the two sorted parts.</p>
</div>
<div id="S1.SS1.SSS3.p2" class="ltx_para ltx_noindent">
<p class="ltx_p"><span class="ltx_text ltx_font_bold">Runtime:</span>
<math id="S1.SS1.SSS3.p2.m1" class="ltx_Math" alttext="\Theta(n\log n)" display="inline"><mrow><mi mathvariant="normal">Θ</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mi>n</mi><mo>⁢</mo><mrow><mi>log</mi><mo>⁡</mo><mi>n</mi></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow></math></p>
</div>
<div id="S1.SS1.SSS3.p3" class="ltx_para ltx_noindent">
<p class="ltx_p"><span class="ltx_text ltx_font_bold">Correctness:</span></p>
<ul id="S1.I1" class="ltx_itemize">
<li id="S1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i1.p1" class="ltx_para ltx_noindent">
<p class="ltx_p">Merge: By loop invariant: At the start of each iteration of the for loop, the subarray <math id="S1.I1.i1.p1.m1" class="ltx_Math" alttext="A[p..k-1]" display="inline"><mrow><mi>A</mi><mrow><mo stretchy="false">[</mo><mi>p</mi><mo>.</mo><mo>.</mo><mi>k</mi><mo>-</mo><mn>1</mn><mo stretchy="false">]</mo></mrow></mrow></math> contains the <math id="S1.I1.i1.p1.m2" class="ltx_Math" alttext="k-p" display="inline"><mrow><mi>k</mi><mo>-</mo><mi>p</mi></mrow></math> smallest elements of <math id="S1.I1.i1.p1.m3" class="ltx_Math" alttext="L[1..n_{1}+1]" display="inline"><mrow><mi>L</mi><mrow><mo stretchy="false">[</mo><mn>1</mn><mo>.</mo><mo>.</mo><msub><mi>n</mi><mn>1</mn></msub><mo>+</mo><mn>1</mn><mo stretchy="false">]</mo></mrow></mrow></math> and <math id="S1.I1.i1.p1.m4" class="ltx_Math" alttext="R[1..n_{2}+1]" display="inline"><mrow><mi>R</mi><mrow><mo stretchy="false">[</mo><mn>1</mn><mo>.</mo><mo>.</mo><msub><mi>n</mi><mn>2</mn></msub><mo>+</mo><mn>1</mn><mo stretchy="false">]</mo></mrow></mrow></math>, in sorted order.
</p>
</div>
</li>
<li id="S1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i2.p1" class="ltx_para ltx_noindent">
<p class="ltx_p">Merge sort: By induction: The two smaller subarrays are sorted correctly with induction hypothesis, and the merge step merges the two subarrays correctly.</p>
</div>
</li>
</ul>
</div>
<div id="S1.SS1.SSS3.p4" class="ltx_para ltx_noindent">
<p class="ltx_p"><span class="ltx_text ltx_font_bold">Inplace:</span>
No</p>
</div>
<div id="S1.SS1.SSS3.p5" class="ltx_para ltx_noindent">
<p class="ltx_p"><span class="ltx_text ltx_font_bold">Stable:</span>
Yes</p>
</div>
<div id="S1.SS1.SSS3.p6" class="ltx_para ltx_align_center">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr class="ltx_tr">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" colspan="2"><span class="ltx_text ltx_font_smallcaps">Merge<math id="S1.SS1.SSS3.p6.m1" class="ltx_Math" alttext="(A,p,q,r)" display="inline"><mrow><mo mathvariant="normal" stretchy="false">(</mo><mi>A</mi><mo mathvariant="normal">,</mo><mi>p</mi><mo mathvariant="normal">,</mo><mi>q</mi><mo mathvariant="normal">,</mo><mi>r</mi><mo mathvariant="normal" stretchy="false">)</mo></mrow></math></span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_t">1.</th>
<td class="ltx_td ltx_align_left ltx_border_t"><math id="S1.SS1.SSS3.p6.m2" class="ltx_Math" alttext="n_{1}=q-p+1" display="inline"><mrow><msub><mi>n</mi><mn>1</mn></msub><mo>=</mo><mrow><mrow><mi>q</mi><mo>-</mo><mi>p</mi></mrow><mo>+</mo><mn>1</mn></mrow></mrow></math></td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">2.</th>
<td class="ltx_td ltx_align_left"><math id="S1.SS1.SSS3.p6.m3" class="ltx_Math" alttext="n_{2}=r-q" display="inline"><mrow><msub><mi>n</mi><mn>2</mn></msub><mo>=</mo><mrow><mi>r</mi><mo>-</mo><mi>q</mi></mrow></mrow></math></td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">3.</th>
<td class="ltx_td ltx_align_left">let <math id="S1.SS1.SSS3.p6.m4" class="ltx_Math" alttext="L[1\dots n_{1}+1]" display="inline"><mrow><mi>L</mi><mo>⁢</mo><mrow><mo stretchy="false">[</mo><mrow><mrow><mn>1</mn><mo>⁢</mo><mi mathvariant="normal">…</mi><mo>⁢</mo><msub><mi>n</mi><mn>1</mn></msub></mrow><mo>+</mo><mn>1</mn></mrow><mo stretchy="false">]</mo></mrow></mrow></math> and <math id="S1.SS1.SSS3.p6.m5" class="ltx_Math" alttext="R[1\dots n_{2}+1]" display="inline"><mrow><mi>R</mi><mo>⁢</mo><mrow><mo stretchy="false">[</mo><mrow><mrow><mn>1</mn><mo>⁢</mo><mi mathvariant="normal">…</mi><mo>⁢</mo><msub><mi>n</mi><mn>2</mn></msub></mrow><mo>+</mo><mn>1</mn></mrow><mo stretchy="false">]</mo></mrow></mrow></math> be new arrays</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">4.</th>
<td class="ltx_td ltx_align_left">
<span class="ltx_text ltx_font_bold">for</span> <math id="S1.SS1.SSS3.p6.m6" class="ltx_Math" alttext="i=1" display="inline"><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow></math> to <math id="S1.SS1.SSS3.p6.m7" class="ltx_Math" alttext="n_{1}" display="inline"><msub><mi>n</mi><mn>1</mn></msub></math>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">5.</th>
<td class="ltx_td ltx_align_left"> <math id="S1.SS1.SSS3.p6.m8" class="ltx_Math" alttext="L[i]=A[p+i-1]" display="inline"><mrow><mrow><mi>L</mi><mo>⁢</mo><mrow><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo></mrow></mrow><mo>=</mo><mrow><mi>A</mi><mo>⁢</mo><mrow><mo stretchy="false">[</mo><mrow><mrow><mi>p</mi><mo>+</mo><mi>i</mi></mrow><mo>-</mo><mn>1</mn></mrow><mo stretchy="false">]</mo></mrow></mrow></mrow></math>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">6.</th>
<td class="ltx_td ltx_align_left">
<span class="ltx_text ltx_font_bold">for</span> <math id="S1.SS1.SSS3.p6.m9" class="ltx_Math" alttext="j=1" display="inline"><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow></math> to <math id="S1.SS1.SSS3.p6.m10" class="ltx_Math" alttext="n_{2}" display="inline"><msub><mi>n</mi><mn>2</mn></msub></math>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">7.</th>
<td class="ltx_td ltx_align_left"> <math id="S1.SS1.SSS3.p6.m11" class="ltx_Math" alttext="R[j]=A[q+j]" display="inline"><mrow><mrow><mi>R</mi><mo>⁢</mo><mrow><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo></mrow></mrow><mo>=</mo><mrow><mi>A</mi><mo>⁢</mo><mrow><mo stretchy="false">[</mo><mrow><mi>q</mi><mo>+</mo><mi>j</mi></mrow><mo stretchy="false">]</mo></mrow></mrow></mrow></math>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">8.</th>
<td class="ltx_td ltx_align_left"><math id="S1.SS1.SSS3.p6.m12" class="ltx_Math" alttext="L[n_{1}+1]=\infty" display="inline"><mrow><mrow><mi>L</mi><mo>⁢</mo><mrow><mo stretchy="false">[</mo><mrow><msub><mi>n</mi><mn>1</mn></msub><mo>+</mo><mn>1</mn></mrow><mo stretchy="false">]</mo></mrow></mrow><mo>=</mo><mi mathvariant="normal">∞</mi></mrow></math></td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">9.</th>
<td class="ltx_td ltx_align_left"><math id="S1.SS1.SSS3.p6.m13" class="ltx_Math" alttext="R[n_{2}+1]=\infty" display="inline"><mrow><mrow><mi>R</mi><mo>⁢</mo><mrow><mo stretchy="false">[</mo><mrow><msub><mi>n</mi><mn>2</mn></msub><mo>+</mo><mn>1</mn></mrow><mo stretchy="false">]</mo></mrow></mrow><mo>=</mo><mi mathvariant="normal">∞</mi></mrow></math></td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">10.</th>
<td class="ltx_td ltx_align_left"><math id="S1.SS1.SSS3.p6.m14" class="ltx_Math" alttext="i=1" display="inline"><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow></math></td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">11.</th>
<td class="ltx_td ltx_align_left"><math id="S1.SS1.SSS3.p6.m15" class="ltx_Math" alttext="j=1" display="inline"><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow></math></td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">12.</th>
<td class="ltx_td ltx_align_left">
<span class="ltx_text ltx_font_bold">for</span> <math id="S1.SS1.SSS3.p6.m16" class="ltx_Math" alttext="k=p" display="inline"><mrow><mi>k</mi><mo>=</mo><mi>p</mi></mrow></math> to <math id="S1.SS1.SSS3.p6.m17" class="ltx_Math" alttext="r" display="inline"><mi>r</mi></math>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">13.</th>
<td class="ltx_td ltx_align_left"> <span class="ltx_text ltx_font_bold">if</span> <math id="S1.SS1.SSS3.p6.m18" class="ltx_Math" alttext="L[i]\leq R[j]" display="inline"><mrow><mrow><mi>L</mi><mo>⁢</mo><mrow><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo></mrow></mrow><mo>≤</mo><mrow><mi>R</mi><mo>⁢</mo><mrow><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo></mrow></mrow></mrow></math>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">14.</th>
<td class="ltx_td ltx_align_left">  <math id="S1.SS1.SSS3.p6.m19" class="ltx_Math" alttext="A[k]=L[i]" display="inline"><mrow><mrow><mi>A</mi><mo>⁢</mo><mrow><mo stretchy="false">[</mo><mi>k</mi><mo stretchy="false">]</mo></mrow></mrow><mo>=</mo><mrow><mi>L</mi><mo>⁢</mo><mrow><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo></mrow></mrow></mrow></math>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">15.</th>
<td class="ltx_td ltx_align_left">  <math id="S1.SS1.SSS3.p6.m20" class="ltx_Math" alttext="i=i+1" display="inline"><mrow><mi>i</mi><mo>=</mo><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></mrow></math>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">16.</th>
<td class="ltx_td ltx_align_left"> <span class="ltx_text ltx_font_bold">else</span>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">17.</th>
<td class="ltx_td ltx_align_left">  <math id="S1.SS1.SSS3.p6.m21" class="ltx_Math" alttext="A[k]=R[j]" display="inline"><mrow><mrow><mi>A</mi><mo>⁢</mo><mrow><mo stretchy="false">[</mo><mi>k</mi><mo stretchy="false">]</mo></mrow></mrow><mo>=</mo><mrow><mi>R</mi><mo>⁢</mo><mrow><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo></mrow></mrow></mrow></math>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_bb">18.</th>
<td class="ltx_td ltx_align_left ltx_border_bb">  <math id="S1.SS1.SSS3.p6.m22" class="ltx_Math" alttext="j=j+1" display="inline"><mrow><mi>j</mi><mo>=</mo><mrow><mi>j</mi><mo>+</mo><mn>1</mn></mrow></mrow></math>
</td>
</tr>
</tbody>
</table>
</div>
<div id="S1.SS1.SSS3.p7" class="ltx_para ltx_align_center">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr class="ltx_tr">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt" colspan="2"><span class="ltx_text ltx_font_smallcaps">Merge-Sort<math id="S1.SS1.SSS3.p7.m1" class="ltx_Math" alttext="(A,p,r)" display="inline"><mrow><mo mathvariant="normal" stretchy="false">(</mo><mi>A</mi><mo mathvariant="normal">,</mo><mi>p</mi><mo mathvariant="normal">,</mo><mi>r</mi><mo mathvariant="normal" stretchy="false">)</mo></mrow></math></span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">1.</th>
<td class="ltx_td ltx_align_left ltx_border_t">
<span class="ltx_text ltx_font_bold">if</span> <math id="S1.SS1.SSS3.p7.m2" class="ltx_Math" alttext="p&lt;r" display="inline"><mrow><mi>p</mi><mo>&lt;</mo><mi>r</mi></mrow></math>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row">2.</th>
<td class="ltx_td ltx_align_left"> <math id="S1.SS1.SSS3.p7.m3" class="ltx_Math" alttext="q=\lfloor(p+r)/2\rfloor" display="inline"><mrow><mi>q</mi><mo>=</mo><mrow><mo stretchy="false">⌊</mo><mrow><mrow><mo stretchy="false">(</mo><mrow><mi>p</mi><mo>+</mo><mi>r</mi></mrow><mo stretchy="false">)</mo></mrow><mo>/</mo><mn>2</mn></mrow><mo stretchy="false">⌋</mo></mrow></mrow></math>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row">3.</th>
<td class="ltx_td ltx_align_left"> <span class="ltx_text ltx_font_smallcaps">Merge-Sort<math id="S1.SS1.SSS3.p7.m4" class="ltx_Math" alttext="(A,p,q)" display="inline"><mrow><mo mathvariant="normal" stretchy="false">(</mo><mi>A</mi><mo mathvariant="normal">,</mo><mi>p</mi><mo mathvariant="normal">,</mo><mi>q</mi><mo mathvariant="normal" stretchy="false">)</mo></mrow></math></span>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row">4.</th>
<td class="ltx_td ltx_align_left"> <span class="ltx_text ltx_font_smallcaps">Merge-Sort<math id="S1.SS1.SSS3.p7.m5" class="ltx_Math" alttext="(A,q+1,r)" display="inline"><mrow><mo mathvariant="normal" stretchy="false">(</mo><mi>A</mi><mo mathvariant="normal">,</mo><mrow><mi>q</mi><mo mathvariant="normal">+</mo><mn mathvariant="normal">1</mn></mrow><mo mathvariant="normal">,</mo><mi>r</mi><mo mathvariant="normal" stretchy="false">)</mo></mrow></math></span>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb">5.</th>
<td class="ltx_td ltx_align_left ltx_border_bb"> <span class="ltx_text ltx_font_smallcaps">Merge<math id="S1.SS1.SSS3.p7.m6" class="ltx_Math" alttext="(A,p,q,r)" display="inline"><mrow><mo mathvariant="normal" stretchy="false">(</mo><mi>A</mi><mo mathvariant="normal">,</mo><mi>p</mi><mo mathvariant="normal">,</mo><mi>q</mi><mo mathvariant="normal">,</mo><mi>r</mi><mo mathvariant="normal" stretchy="false">)</mo></mrow></math></span>
</td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="S1.SS1.SSS4" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">1.1.4 </span>Heap Sort</h4>

<div id="S1.SS1.SSS4.p1" class="ltx_para ltx_noindent">
<p class="ltx_p">A heap is a binary tree with the following properties (assume the array starts from index 1):</p>
<ol id="S1.I2" class="ltx_enumerate">
<li id="S1.I2.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1.</span> 
<div id="S1.I2.i1.p1" class="ltx_para ltx_noindent">
<p class="ltx_p"><math id="S1.I2.i1.p1.m1" class="ltx_Math" alttext="A[Parent(i)]=\lfloor i/2\rfloor" display="inline"><mrow><mrow><mi>A</mi><mo>⁢</mo><mrow><mo stretchy="false">[</mo><mrow><mi>P</mi><mo>⁢</mo><mi>a</mi><mo>⁢</mo><mi>r</mi><mo>⁢</mo><mi>e</mi><mo>⁢</mo><mi>n</mi><mo>⁢</mo><mi>t</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></mrow><mo stretchy="false">]</mo></mrow></mrow><mo>=</mo><mrow><mo stretchy="false">⌊</mo><mrow><mi>i</mi><mo>/</mo><mn>2</mn></mrow><mo stretchy="false">⌋</mo></mrow></mrow></math>.</p>
</div>
</li>
<li id="S1.I2.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">2.</span> 
<div id="S1.I2.i2.p1" class="ltx_para ltx_noindent">
<p class="ltx_p"><math id="S1.I2.i2.p1.m1" class="ltx_Math" alttext="A[Left(i)]=2i" display="inline"><mrow><mrow><mi>A</mi><mo>⁢</mo><mrow><mo stretchy="false">[</mo><mrow><mi>L</mi><mo>⁢</mo><mi>e</mi><mo>⁢</mo><mi>f</mi><mo>⁢</mo><mi>t</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></mrow><mo stretchy="false">]</mo></mrow></mrow><mo>=</mo><mrow><mn>2</mn><mo>⁢</mo><mi>i</mi></mrow></mrow></math>.</p>
</div>
</li>
<li id="S1.I2.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">3.</span> 
<div id="S1.I2.i3.p1" class="ltx_para ltx_noindent">
<p class="ltx_p"><math id="S1.I2.i3.p1.m1" class="ltx_Math" alttext="A[Right(i)]=2i+1" display="inline"><mrow><mrow><mi>A</mi><mo>⁢</mo><mrow><mo stretchy="false">[</mo><mrow><mi>R</mi><mo>⁢</mo><mi>i</mi><mo>⁢</mo><mi>g</mi><mo>⁢</mo><mi>h</mi><mo>⁢</mo><mi>t</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></mrow><mo stretchy="false">]</mo></mrow></mrow><mo>=</mo><mrow><mrow><mn>2</mn><mo>⁢</mo><mi>i</mi></mrow><mo>+</mo><mn>1</mn></mrow></mrow></math>.</p>
</div>
</li>
<li id="S1.I2.i4" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">4.</span> 
<div id="S1.I2.i4.p1" class="ltx_para ltx_noindent">
<p class="ltx_p">Max-heap property: <math id="S1.I2.i4.p1.m1" class="ltx_Math" alttext="A[Parent(i)]\geq A[i]" display="inline"><mrow><mrow><mi>A</mi><mo>⁢</mo><mrow><mo stretchy="false">[</mo><mrow><mi>P</mi><mo>⁢</mo><mi>a</mi><mo>⁢</mo><mi>r</mi><mo>⁢</mo><mi>e</mi><mo>⁢</mo><mi>n</mi><mo>⁢</mo><mi>t</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></mrow><mo stretchy="false">]</mo></mrow></mrow><mo>≥</mo><mrow><mi>A</mi><mo>⁢</mo><mrow><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo></mrow></mrow></mrow></math>.</p>
</div>
</li>
<li id="S1.I2.i5" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">5.</span> 
<div id="S1.I2.i5.p1" class="ltx_para ltx_noindent">
<p class="ltx_p">Min-heap property: <math id="S1.I2.i5.p1.m1" class="ltx_Math" alttext="A[Parent(i)]\leq A[i]" display="inline"><mrow><mrow><mi>A</mi><mo>⁢</mo><mrow><mo stretchy="false">[</mo><mrow><mi>P</mi><mo>⁢</mo><mi>a</mi><mo>⁢</mo><mi>r</mi><mo>⁢</mo><mi>e</mi><mo>⁢</mo><mi>n</mi><mo>⁢</mo><mi>t</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></mrow><mo stretchy="false">]</mo></mrow></mrow><mo>≤</mo><mrow><mi>A</mi><mo>⁢</mo><mrow><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo></mrow></mrow></mrow></math>.</p>
</div>
</li>
</ol>
</div>
<div id="S1.SS1.SSS4.p2" class="ltx_para ltx_noindent">
<p class="ltx_p"><span class="ltx_text ltx_font_bold">Max-heapify:</span></p>
</div>
<div id="S1.SS1.SSS4.p3" class="ltx_para ltx_noindent">
<p class="ltx_p">Assume the binary trees rooted at <math id="S1.SS1.SSS4.p3.m1" class="ltx_Math" alttext="Left(i)" display="inline"><mrow><mi>L</mi><mo>⁢</mo><mi>e</mi><mo>⁢</mo><mi>f</mi><mo>⁢</mo><mi>t</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></mrow></math> and <math id="S1.SS1.SSS4.p3.m2" class="ltx_Math" alttext="Right(i)" display="inline"><mrow><mi>R</mi><mo>⁢</mo><mi>i</mi><mo>⁢</mo><mi>g</mi><mo>⁢</mo><mi>h</mi><mo>⁢</mo><mi>t</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></mrow></math> are max-heaps, but max-heap property may be violated at node <math id="S1.SS1.SSS4.p3.m3" class="ltx_Math" alttext="i" display="inline"><mi>i</mi></math>.
We let the value at node <math id="S1.SS1.SSS4.p3.m4" class="ltx_Math" alttext="i" display="inline"><mi>i</mi></math> float down, so that the subtree rooted at node <math id="S1.SS1.SSS4.p3.m5" class="ltx_Math" alttext="i" display="inline"><mi>i</mi></math> becomes a max-heap.</p>
</div>
<div id="S1.SS1.SSS4.p4" class="ltx_para ltx_noindent">
<p class="ltx_p"><span class="ltx_text ltx_font_bold">Runtime:</span>
<math id="S1.SS1.SSS4.p4.m1" class="ltx_Math" alttext="O(\log n)" display="inline"><mrow><mi>O</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mi>log</mi><mo>⁡</mo><mi>n</mi></mrow><mo stretchy="false">)</mo></mrow></mrow></math> (height of the tree)</p>
</div>
<div id="S1.SS1.SSS4.p5" class="ltx_para ltx_noindent">
<p class="ltx_p"><span class="ltx_text ltx_font_bold">Correctness:</span>
By induction:
Assume max-heapify works for <math id="S1.SS1.SSS4.p5.m1" class="ltx_Math" alttext="h=i-1" display="inline"><mrow><mi>h</mi><mo>=</mo><mrow><mi>i</mi><mo>-</mo><mn>1</mn></mrow></mrow></math>.
Now we consider <math id="S1.SS1.SSS4.p5.m2" class="ltx_Math" alttext="h=i" display="inline"><mrow><mi>h</mi><mo>=</mo><mi>i</mi></mrow></math>.
After we swap the value at node <math id="S1.SS1.SSS4.p5.m3" class="ltx_Math" alttext="i" display="inline"><mi>i</mi></math> with the value at node <math id="S1.SS1.SSS4.p5.m4" class="ltx_Math" alttext="largest" display="inline"><mrow><mi>l</mi><mo>⁢</mo><mi>a</mi><mo>⁢</mo><mi>r</mi><mo>⁢</mo><mi>g</mi><mo>⁢</mo><mi>e</mi><mo>⁢</mo><mi>s</mi><mo>⁢</mo><mi>t</mi></mrow></math>, this maintains the max-heap property for node <math id="S1.SS1.SSS4.p5.m5" class="ltx_Math" alttext="i" display="inline"><mi>i</mi></math>.
Now one of the subtrees rooted at <math id="S1.SS1.SSS4.p5.m6" class="ltx_Math" alttext="Left(i)" display="inline"><mrow><mi>L</mi><mo>⁢</mo><mi>e</mi><mo>⁢</mo><mi>f</mi><mo>⁢</mo><mi>t</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></mrow></math> or <math id="S1.SS1.SSS4.p5.m7" class="ltx_Math" alttext="Right(i)" display="inline"><mrow><mi>R</mi><mo>⁢</mo><mi>i</mi><mo>⁢</mo><mi>g</mi><mo>⁢</mo><mi>h</mi><mo>⁢</mo><mi>t</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></mrow></math> may violate the max-heap property.
By induction hypothesis, we know that we can call max-heapify to make the subtree rooted at <math id="S1.SS1.SSS4.p5.m8" class="ltx_Math" alttext="Left(i)" display="inline"><mrow><mi>L</mi><mo>⁢</mo><mi>e</mi><mo>⁢</mo><mi>f</mi><mo>⁢</mo><mi>t</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></mrow></math> or <math id="S1.SS1.SSS4.p5.m9" class="ltx_Math" alttext="Right(i)" display="inline"><mrow><mi>R</mi><mo>⁢</mo><mi>i</mi><mo>⁢</mo><mi>g</mi><mo>⁢</mo><mi>h</mi><mo>⁢</mo><mi>t</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></mrow></math> a max-heap.</p>
</div>
<div id="S1.SS1.SSS4.p6" class="ltx_para ltx_align_center">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr class="ltx_tr">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" colspan="2"><span class="ltx_text ltx_font_smallcaps">Max-Heapify<math id="S1.SS1.SSS4.p6.m1" class="ltx_Math" alttext="(A,i)" display="inline"><mrow><mo mathvariant="normal" stretchy="false">(</mo><mi>A</mi><mo mathvariant="normal">,</mo><mi>i</mi><mo mathvariant="normal" stretchy="false">)</mo></mrow></math></span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_t">1.</th>
<td class="ltx_td ltx_align_left ltx_border_t"><math id="S1.SS1.SSS4.p6.m2" class="ltx_Math" alttext="l=Left(i)" display="inline"><mrow><mi>l</mi><mo>=</mo><mrow><mi>L</mi><mo>⁢</mo><mi>e</mi><mo>⁢</mo><mi>f</mi><mo>⁢</mo><mi>t</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></mrow></mrow></math></td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">2.</th>
<td class="ltx_td ltx_align_left"><math id="S1.SS1.SSS4.p6.m3" class="ltx_Math" alttext="r=Right(i)" display="inline"><mrow><mi>r</mi><mo>=</mo><mrow><mi>R</mi><mo>⁢</mo><mi>i</mi><mo>⁢</mo><mi>g</mi><mo>⁢</mo><mi>h</mi><mo>⁢</mo><mi>t</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></mrow></mrow></math></td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">3.</th>
<td class="ltx_td ltx_align_left">
<span class="ltx_text ltx_font_bold">if</span> <math id="S1.SS1.SSS4.p6.m4" class="ltx_Math" alttext="l\leq A.heap-size" display="inline"><mrow><mrow><mi>l</mi><mo>≤</mo><mi>A</mi></mrow><mo>.</mo><mrow><mrow><mi>h</mi><mo>⁢</mo><mi>e</mi><mo>⁢</mo><mi>a</mi><mo>⁢</mo><mi>p</mi></mrow><mo>-</mo><mrow><mi>s</mi><mo>⁢</mo><mi>i</mi><mo>⁢</mo><mi>z</mi><mo>⁢</mo><mi>e</mi></mrow></mrow></mrow></math> and <math id="S1.SS1.SSS4.p6.m5" class="ltx_Math" alttext="A[l]&gt;A[i]" display="inline"><mrow><mrow><mi>A</mi><mo>⁢</mo><mrow><mo stretchy="false">[</mo><mi>l</mi><mo stretchy="false">]</mo></mrow></mrow><mo>&gt;</mo><mrow><mi>A</mi><mo>⁢</mo><mrow><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo></mrow></mrow></mrow></math>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">4.</th>
<td class="ltx_td ltx_align_left"> <math id="S1.SS1.SSS4.p6.m6" class="ltx_Math" alttext="largest=l" display="inline"><mrow><mrow><mi>l</mi><mo>⁢</mo><mi>a</mi><mo>⁢</mo><mi>r</mi><mo>⁢</mo><mi>g</mi><mo>⁢</mo><mi>e</mi><mo>⁢</mo><mi>s</mi><mo>⁢</mo><mi>t</mi></mrow><mo>=</mo><mi>l</mi></mrow></math>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">5.</th>
<td class="ltx_td ltx_align_left">
<span class="ltx_text ltx_font_bold">else</span> <math id="S1.SS1.SSS4.p6.m7" class="ltx_Math" alttext="largest=i" display="inline"><mrow><mrow><mi>l</mi><mo>⁢</mo><mi>a</mi><mo>⁢</mo><mi>r</mi><mo>⁢</mo><mi>g</mi><mo>⁢</mo><mi>e</mi><mo>⁢</mo><mi>s</mi><mo>⁢</mo><mi>t</mi></mrow><mo>=</mo><mi>i</mi></mrow></math>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">6.</th>
<td class="ltx_td ltx_align_left">
<span class="ltx_text ltx_font_bold">if</span> <math id="S1.SS1.SSS4.p6.m8" class="ltx_Math" alttext="r\leq A.heap-size" display="inline"><mrow><mrow><mi>r</mi><mo>≤</mo><mi>A</mi></mrow><mo>.</mo><mrow><mrow><mi>h</mi><mo>⁢</mo><mi>e</mi><mo>⁢</mo><mi>a</mi><mo>⁢</mo><mi>p</mi></mrow><mo>-</mo><mrow><mi>s</mi><mo>⁢</mo><mi>i</mi><mo>⁢</mo><mi>z</mi><mo>⁢</mo><mi>e</mi></mrow></mrow></mrow></math> and <math id="S1.SS1.SSS4.p6.m9" class="ltx_Math" alttext="A[r]&gt;A[largest]" display="inline"><mrow><mrow><mi>A</mi><mo>⁢</mo><mrow><mo stretchy="false">[</mo><mi>r</mi><mo stretchy="false">]</mo></mrow></mrow><mo>&gt;</mo><mrow><mi>A</mi><mo>⁢</mo><mrow><mo stretchy="false">[</mo><mrow><mi>l</mi><mo>⁢</mo><mi>a</mi><mo>⁢</mo><mi>r</mi><mo>⁢</mo><mi>g</mi><mo>⁢</mo><mi>e</mi><mo>⁢</mo><mi>s</mi><mo>⁢</mo><mi>t</mi></mrow><mo stretchy="false">]</mo></mrow></mrow></mrow></math>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">7.</th>
<td class="ltx_td ltx_align_left"> <math id="S1.SS1.SSS4.p6.m10" class="ltx_Math" alttext="largest=r" display="inline"><mrow><mrow><mi>l</mi><mo>⁢</mo><mi>a</mi><mo>⁢</mo><mi>r</mi><mo>⁢</mo><mi>g</mi><mo>⁢</mo><mi>e</mi><mo>⁢</mo><mi>s</mi><mo>⁢</mo><mi>t</mi></mrow><mo>=</mo><mi>r</mi></mrow></math>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">8.</th>
<td class="ltx_td ltx_align_left">
<span class="ltx_text ltx_font_bold">if</span> <math id="S1.SS1.SSS4.p6.m11" class="ltx_Math" alttext="largest\neq i" display="inline"><mrow><mrow><mi>l</mi><mo>⁢</mo><mi>a</mi><mo>⁢</mo><mi>r</mi><mo>⁢</mo><mi>g</mi><mo>⁢</mo><mi>e</mi><mo>⁢</mo><mi>s</mi><mo>⁢</mo><mi>t</mi></mrow><mo>≠</mo><mi>i</mi></mrow></math>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">9.</th>
<td class="ltx_td ltx_align_left"> exchange <math id="S1.SS1.SSS4.p6.m12" class="ltx_Math" alttext="A[i]" display="inline"><mrow><mi>A</mi><mo>⁢</mo><mrow><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo></mrow></mrow></math> with <math id="S1.SS1.SSS4.p6.m13" class="ltx_Math" alttext="A[largest]" display="inline"><mrow><mi>A</mi><mo>⁢</mo><mrow><mo stretchy="false">[</mo><mrow><mi>l</mi><mo>⁢</mo><mi>a</mi><mo>⁢</mo><mi>r</mi><mo>⁢</mo><mi>g</mi><mo>⁢</mo><mi>e</mi><mo>⁢</mo><mi>s</mi><mo>⁢</mo><mi>t</mi></mrow><mo stretchy="false">]</mo></mrow></mrow></math>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_bb">10.</th>
<td class="ltx_td ltx_align_left ltx_border_bb"> <span class="ltx_text ltx_font_smallcaps">Max-Heapify<math id="S1.SS1.SSS4.p6.m14" class="ltx_Math" alttext="(A,largest)" display="inline"><mrow><mo mathvariant="normal" stretchy="false">(</mo><mi>A</mi><mo mathvariant="normal">,</mo><mrow><mi>l</mi><mo class="ltx_font_smallcaps" mathvariant="normal">⁢</mo><mi>a</mi><mo class="ltx_font_smallcaps" mathvariant="normal">⁢</mo><mi>r</mi><mo class="ltx_font_smallcaps" mathvariant="normal">⁢</mo><mi>g</mi><mo class="ltx_font_smallcaps" mathvariant="normal">⁢</mo><mi>e</mi><mo class="ltx_font_smallcaps" mathvariant="normal">⁢</mo><mi>s</mi><mo class="ltx_font_smallcaps" mathvariant="normal">⁢</mo><mi>t</mi></mrow><mo mathvariant="normal" stretchy="false">)</mo></mrow></math></span>
</td>
</tr>
</tbody>
</table>
</div>
<div id="S1.SS1.SSS4.p7" class="ltx_para ltx_noindent">
<p class="ltx_p"><span class="ltx_text ltx_font_bold">Build-max-heap:</span></p>
</div>
<div id="S1.SS1.SSS4.p8" class="ltx_para ltx_noindent">
<p class="ltx_p">Build-max-heap is used to build a max-heap from an unordered array.
We can only do bottom-up, since we need to maintain the max-heap property for all nodes.</p>
</div>
<div id="S1.SS1.SSS4.p9" class="ltx_para ltx_noindent">
<p class="ltx_p"><span class="ltx_text ltx_font_bold">Runtime:</span>
<math id="S1.SS1.SSS4.p9.m1" class="ltx_Math" alttext="O(n)" display="inline"><mrow><mi>O</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></mrow></math>
The maximum number of nodes of height <math id="S1.SS1.SSS4.p9.m2" class="ltx_Math" alttext="h" display="inline"><mi>h</mi></math> is <math id="S1.SS1.SSS4.p9.m3" class="ltx_Math" alttext="\lfloor n/2^{h+1}\rfloor" display="inline"><mrow><mo stretchy="false">⌊</mo><mrow><mi>n</mi><mo>/</mo><msup><mn>2</mn><mrow><mi>h</mi><mo>+</mo><mn>1</mn></mrow></msup></mrow><mo stretchy="false">⌋</mo></mrow></math>.
Hence, the total runtime is <math id="S1.SS1.SSS4.p9.m4" class="ltx_Math" alttext="\sum_{h=0}^{\lfloor\log n\rfloor}\lfloor n/2^{h+1}\rfloor O(h)=O(n)" display="inline"><mrow><mrow><msubsup><mo largeop="true" symmetric="true">∑</mo><mrow><mi>h</mi><mo>=</mo><mn>0</mn></mrow><mrow><mo stretchy="false">⌊</mo><mrow><mi>log</mi><mo>⁡</mo><mi>n</mi></mrow><mo stretchy="false">⌋</mo></mrow></msubsup><mrow><mrow><mo stretchy="false">⌊</mo><mrow><mi>n</mi><mo>/</mo><msup><mn>2</mn><mrow><mi>h</mi><mo>+</mo><mn>1</mn></mrow></msup></mrow><mo stretchy="false">⌋</mo></mrow><mo>⁢</mo><mi>O</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>h</mi><mo stretchy="false">)</mo></mrow></mrow></mrow><mo>=</mo><mrow><mi>O</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></mrow></mrow></math>.</p>
</div>
<div id="S1.SS1.SSS4.p10" class="ltx_para ltx_noindent">
<p class="ltx_p"><span class="ltx_text ltx_font_bold">Correctness:</span>
By loop invariant:
At the start of each iteration of the for loop, each node <math id="S1.SS1.SSS4.p10.m1" class="ltx_Math" alttext="i+1,i+2,\dots,n" display="inline"><mrow><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow><mo>,</mo><mrow><mi>i</mi><mo>+</mo><mn>2</mn></mrow><mo>,</mo><mi mathvariant="normal">…</mi><mo>,</mo><mi>n</mi></mrow></math> have the max-heap property.</p>
</div>
<div id="S1.SS1.SSS4.p11" class="ltx_para ltx_align_center">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr class="ltx_tr">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" colspan="2"><span class="ltx_text ltx_font_smallcaps">Build-Max-Heap<math id="S1.SS1.SSS4.p11.m1" class="ltx_Math" alttext="(A)" display="inline"><mrow><mo mathvariant="normal" stretchy="false">(</mo><mi>A</mi><mo mathvariant="normal" stretchy="false">)</mo></mrow></math></span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_t">1.</th>
<td class="ltx_td ltx_align_left ltx_border_t"><math id="S1.SS1.SSS4.p11.m2" class="ltx_Math" alttext="A.heap-size=A.length" display="inline"><mrow><mi>A</mi><mo>.</mo><mrow><mrow><mrow><mi>h</mi><mo>⁢</mo><mi>e</mi><mo>⁢</mo><mi>a</mi><mo>⁢</mo><mi>p</mi></mrow><mo>-</mo><mrow><mi>s</mi><mo>⁢</mo><mi>i</mi><mo>⁢</mo><mi>z</mi><mo>⁢</mo><mi>e</mi></mrow></mrow><mo>=</mo><mi>A</mi></mrow><mo>.</mo><mrow><mi>l</mi><mo>⁢</mo><mi>e</mi><mo>⁢</mo><mi>n</mi><mo>⁢</mo><mi>g</mi><mo>⁢</mo><mi>t</mi><mo>⁢</mo><mi>h</mi></mrow></mrow></math></td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">2.</th>
<td class="ltx_td ltx_align_left">
<span class="ltx_text ltx_font_bold">for</span> <math id="S1.SS1.SSS4.p11.m3" class="ltx_Math" alttext="i=\lfloor A.length/2\rfloor" display="inline"><mrow><mi>i</mi><mo>=</mo><mrow><mo stretchy="false">⌊</mo><mi>A</mi><mo>.</mo><mi>l</mi><mi>e</mi><mi>n</mi><mi>g</mi><mi>t</mi><mi>h</mi><mo>/</mo><mn>2</mn><mo stretchy="false">⌋</mo></mrow></mrow></math> downto <math id="S1.SS1.SSS4.p11.m4" class="ltx_Math" alttext="1" display="inline"><mn>1</mn></math>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_bb">3.</th>
<td class="ltx_td ltx_align_left ltx_border_bb"> <span class="ltx_text ltx_font_smallcaps">Max-Heapify<math id="S1.SS1.SSS4.p11.m5" class="ltx_Math" alttext="(A,i)" display="inline"><mrow><mo mathvariant="normal" stretchy="false">(</mo><mi>A</mi><mo mathvariant="normal">,</mo><mi>i</mi><mo mathvariant="normal" stretchy="false">)</mo></mrow></math></span>
</td>
</tr>
</tbody>
</table>
</div>
<div id="S1.SS1.SSS4.p12" class="ltx_para ltx_noindent">
<p class="ltx_p"><span class="ltx_text ltx_font_bold">Heap-sort:</span></p>
</div>
<div id="S1.SS1.SSS4.p13" class="ltx_para ltx_noindent">
<p class="ltx_p">We first build a max-heap from the array.
Then we can extract the maximum element from the heap, and put it at the end of the array.
Now we exchange the first element with the last element, decrease the heap size by 1, and call max-heapify to maintain the max-heap property.</p>
</div>
<div id="S1.SS1.SSS4.p14" class="ltx_para ltx_noindent">
<p class="ltx_p"><span class="ltx_text ltx_font_bold">Runtime:</span>
<math id="S1.SS1.SSS4.p14.m1" class="ltx_Math" alttext="\Theta(n\log n)" display="inline"><mrow><mi mathvariant="normal">Θ</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mi>n</mi><mo>⁢</mo><mrow><mi>log</mi><mo>⁡</mo><mi>n</mi></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow></math></p>
</div>
<div id="S1.SS1.SSS4.p15" class="ltx_para ltx_noindent">
<p class="ltx_p"><span class="ltx_text ltx_font_bold">Correctness:</span>
By loop invariant:
At the start of each iteration of the for loop, the subarray <math id="S1.SS1.SSS4.p15.m1" class="ltx_Math" alttext="A[1..i]" display="inline"><mrow><mi>A</mi><mrow><mo stretchy="false">[</mo><mn>1</mn><mo>.</mo><mo>.</mo><mi>i</mi><mo stretchy="false">]</mo></mrow></mrow></math> is a max-heap that contains the first <math id="S1.SS1.SSS4.p15.m2" class="ltx_Math" alttext="i" display="inline"><mi>i</mi></math> smallest elements, and the subarray <math id="S1.SS1.SSS4.p15.m3" class="ltx_Math" alttext="A[i+1..n]" display="inline"><mrow><mi>A</mi><mrow><mo stretchy="false">[</mo><mi>i</mi><mo>+</mo><mn>1</mn><mo>.</mo><mo>.</mo><mi>n</mi><mo stretchy="false">]</mo></mrow></mrow></math> contains the <math id="S1.SS1.SSS4.p15.m4" class="ltx_Math" alttext="n-i" display="inline"><mrow><mi>n</mi><mo>-</mo><mi>i</mi></mrow></math> largest elements.</p>
</div>
<div id="S1.SS1.SSS4.p16" class="ltx_para ltx_noindent">
<p class="ltx_p"><span class="ltx_text ltx_font_bold">Inplace:</span>
Yes</p>
</div>
<div id="S1.SS1.SSS4.p17" class="ltx_para ltx_noindent">
<p class="ltx_p"><span class="ltx_text ltx_font_bold">Stable:</span>
No (example: <math id="S1.SS1.SSS4.p17.m1" class="ltx_Math" alttext="[1_{a},1_{b}]" display="inline"><mrow><mo stretchy="false">[</mo><msub><mn>1</mn><mi>a</mi></msub><mo>,</mo><msub><mn>1</mn><mi>b</mi></msub><mo stretchy="false">]</mo></mrow></math>)</p>
</div>
<div id="S1.SS1.SSS4.p18" class="ltx_para ltx_align_center">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr class="ltx_tr">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" colspan="2"><span class="ltx_text ltx_font_smallcaps">Heap-Sort<math id="S1.SS1.SSS4.p18.m1" class="ltx_Math" alttext="(A)" display="inline"><mrow><mo mathvariant="normal" stretchy="false">(</mo><mi>A</mi><mo mathvariant="normal" stretchy="false">)</mo></mrow></math></span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_t">1.</th>
<td class="ltx_td ltx_align_left ltx_border_t"><span class="ltx_text ltx_font_smallcaps">Build-Max-Heap<math id="S1.SS1.SSS4.p18.m2" class="ltx_Math" alttext="(A)" display="inline"><mrow><mo mathvariant="normal" stretchy="false">(</mo><mi>A</mi><mo mathvariant="normal" stretchy="false">)</mo></mrow></math></span></td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">2.</th>
<td class="ltx_td ltx_align_left">
<span class="ltx_text ltx_font_bold">for</span> <math id="S1.SS1.SSS4.p18.m3" class="ltx_Math" alttext="i=A.length" display="inline"><mrow><mrow><mi>i</mi><mo>=</mo><mi>A</mi></mrow><mo>.</mo><mrow><mi>l</mi><mo>⁢</mo><mi>e</mi><mo>⁢</mo><mi>n</mi><mo>⁢</mo><mi>g</mi><mo>⁢</mo><mi>t</mi><mo>⁢</mo><mi>h</mi></mrow></mrow></math> downto <math id="S1.SS1.SSS4.p18.m4" class="ltx_Math" alttext="2" display="inline"><mn>2</mn></math>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">3.</th>
<td class="ltx_td ltx_align_left"> exchange <math id="S1.SS1.SSS4.p18.m5" class="ltx_Math" alttext="A[1]" display="inline"><mrow><mi>A</mi><mo>⁢</mo><mrow><mo stretchy="false">[</mo><mn>1</mn><mo stretchy="false">]</mo></mrow></mrow></math> with <math id="S1.SS1.SSS4.p18.m6" class="ltx_Math" alttext="A[i]" display="inline"><mrow><mi>A</mi><mo>⁢</mo><mrow><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo></mrow></mrow></math>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">4.</th>
<td class="ltx_td ltx_align_left"> <math id="S1.SS1.SSS4.p18.m7" class="ltx_Math" alttext="A.heap-size=A.heap-size-1" display="inline"><mrow><mi>A</mi><mo>.</mo><mrow><mrow><mrow><mi>h</mi><mo>⁢</mo><mi>e</mi><mo>⁢</mo><mi>a</mi><mo>⁢</mo><mi>p</mi></mrow><mo>-</mo><mrow><mi>s</mi><mo>⁢</mo><mi>i</mi><mo>⁢</mo><mi>z</mi><mo>⁢</mo><mi>e</mi></mrow></mrow><mo>=</mo><mi>A</mi></mrow><mo>.</mo><mrow><mrow><mi>h</mi><mo>⁢</mo><mi>e</mi><mo>⁢</mo><mi>a</mi><mo>⁢</mo><mi>p</mi></mrow><mo>-</mo><mrow><mi>s</mi><mo>⁢</mo><mi>i</mi><mo>⁢</mo><mi>z</mi><mo>⁢</mo><mi>e</mi></mrow><mo>-</mo><mn>1</mn></mrow></mrow></math>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_bb">5.</th>
<td class="ltx_td ltx_align_left ltx_border_bb"> <span class="ltx_text ltx_font_smallcaps">Max-Heapify<math id="S1.SS1.SSS4.p18.m8" class="ltx_Math" alttext="(A,1)" display="inline"><mrow><mo mathvariant="normal" stretchy="false">(</mo><mi>A</mi><mo mathvariant="normal">,</mo><mn mathvariant="normal">1</mn><mo mathvariant="normal" stretchy="false">)</mo></mrow></math></span>
</td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="S1.SS1.SSS5" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">1.1.5 </span>Priority Queue</h4>

<div id="S1.SS1.SSS5.p1" class="ltx_para ltx_noindent">
<p class="ltx_p">A priority queue is very similar to a heap, but with the following operations:</p>
<ol id="S1.I3" class="ltx_enumerate">
<li id="S1.I3.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1.</span> 
<div id="S1.I3.i1.p1" class="ltx_para ltx_noindent">
<p class="ltx_p"><span class="ltx_text ltx_font_smallcaps">Insert<math id="S1.I3.i1.p1.m1" class="ltx_Math" alttext="(Q,x)" display="inline"><mrow><mo mathvariant="normal" stretchy="false">(</mo><mi>Q</mi><mo mathvariant="normal">,</mo><mi>x</mi><mo mathvariant="normal" stretchy="false">)</mo></mrow></math></span>: insert <math id="S1.I3.i1.p1.m2" class="ltx_Math" alttext="x" display="inline"><mi>x</mi></math> into <math id="S1.I3.i1.p1.m3" class="ltx_Math" alttext="Q" display="inline"><mi>Q</mi></math>.</p>
</div>
</li>
<li id="S1.I3.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">2.</span> 
<div id="S1.I3.i2.p1" class="ltx_para ltx_noindent">
<p class="ltx_p"><span class="ltx_text ltx_font_smallcaps">Maximum<math id="S1.I3.i2.p1.m1" class="ltx_Math" alttext="(Q)" display="inline"><mrow><mo mathvariant="normal" stretchy="false">(</mo><mi>Q</mi><mo mathvariant="normal" stretchy="false">)</mo></mrow></math></span>: return the element with the largest key.</p>
</div>
</li>
<li id="S1.I3.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">3.</span> 
<div id="S1.I3.i3.p1" class="ltx_para ltx_noindent">
<p class="ltx_p"><span class="ltx_text ltx_font_smallcaps">Extract-Max<math id="S1.I3.i3.p1.m1" class="ltx_Math" alttext="(Q)" display="inline"><mrow><mo mathvariant="normal" stretchy="false">(</mo><mi>Q</mi><mo mathvariant="normal" stretchy="false">)</mo></mrow></math></span>: remove and return the element with the largest key.</p>
</div>
</li>
<li id="S1.I3.i4" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">4.</span> 
<div id="S1.I3.i4.p1" class="ltx_para ltx_noindent">
<p class="ltx_p"><span class="ltx_text ltx_font_smallcaps">Increase-Key<math id="S1.I3.i4.p1.m1" class="ltx_Math" alttext="(Q,x,k)" display="inline"><mrow><mo mathvariant="normal" stretchy="false">(</mo><mi>Q</mi><mo mathvariant="normal">,</mo><mi>x</mi><mo mathvariant="normal">,</mo><mi>k</mi><mo mathvariant="normal" stretchy="false">)</mo></mrow></math></span>: increase the key of <math id="S1.I3.i4.p1.m2" class="ltx_Math" alttext="x" display="inline"><mi>x</mi></math> to <math id="S1.I3.i4.p1.m3" class="ltx_Math" alttext="k" display="inline"><mi>k</mi></math>.</p>
</div>
</li>
</ol>
</div>
<div id="S1.SS1.SSS5.p2" class="ltx_para ltx_noindent">
<p class="ltx_p">The only new operation is <span class="ltx_text ltx_font_smallcaps">Increase-Key</span>, which can be implemented by “bubbling up” the element.
Its runtime is <math id="S1.SS1.SSS5.p2.m1" class="ltx_Math" alttext="O(\log n)" display="inline"><mrow><mi>O</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mi>log</mi><mo>⁡</mo><mi>n</mi></mrow><mo stretchy="false">)</mo></mrow></mrow></math>.</p>
</div>
</section>
<section id="S1.SS1.SSS6" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">1.1.6 </span>Quick Sort</h4>

<div id="S1.SS1.SSS6.p1" class="ltx_para ltx_noindent">
<p class="ltx_p"><span class="ltx_text ltx_font_bold">Partition:</span></p>
</div>
<div id="S1.SS1.SSS6.p2" class="ltx_para ltx_noindent">
<p class="ltx_p">Partition is used to partition an array into two parts, such that all elements in the first part are smaller than the pivot, and all elements in the second part are larger than the pivot.</p>
</div>
<div id="S1.SS1.SSS6.p3" class="ltx_para ltx_noindent">
<p class="ltx_p"><span class="ltx_text ltx_font_bold">Runtime:</span>
Worst case: <math id="S1.SS1.SSS6.p3.m1" class="ltx_Math" alttext="O(n^{2})" display="inline"><mrow><mi>O</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><msup><mi>n</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mrow></mrow></math>, Best case: <math id="S1.SS1.SSS6.p3.m2" class="ltx_Math" alttext="O(n\log n)" display="inline"><mrow><mi>O</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mi>n</mi><mo>⁢</mo><mrow><mi>log</mi><mo>⁡</mo><mi>n</mi></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow></math>, Average case: <math id="S1.SS1.SSS6.p3.m3" class="ltx_Math" alttext="O(n\log n)" display="inline"><mrow><mi>O</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mi>n</mi><mo>⁢</mo><mrow><mi>log</mi><mo>⁡</mo><mi>n</mi></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow></math></p>
</div>
<div id="S1.SS1.SSS6.p4" class="ltx_para ltx_noindent">
<p class="ltx_p"><span class="ltx_text ltx_font_bold">Correctness:</span>
By loop invariant:
At the start of each iteration of the for loop, the subarray <math id="S1.SS1.SSS6.p4.m1" class="ltx_Math" alttext="A[p..j-1]" display="inline"><mrow><mi>A</mi><mrow><mo stretchy="false">[</mo><mi>p</mi><mo>.</mo><mo>.</mo><mi>j</mi><mo>-</mo><mn>1</mn><mo stretchy="false">]</mo></mrow></mrow></math> consists of elements smaller than the pivot, and the subarray <math id="S1.SS1.SSS6.p4.m2" class="ltx_Math" alttext="A[j+1..r]" display="inline"><mrow><mi>A</mi><mrow><mo stretchy="false">[</mo><mi>j</mi><mo>+</mo><mn>1</mn><mo>.</mo><mo>.</mo><mi>r</mi><mo stretchy="false">]</mo></mrow></mrow></math> consists of elements larger than the pivot.</p>
</div>
<div id="S1.SS1.SSS6.p5" class="ltx_para ltx_align_center">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr class="ltx_tr">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" colspan="2"><span class="ltx_text ltx_font_smallcaps">Partition<math id="S1.SS1.SSS6.p5.m1" class="ltx_Math" alttext="(A,p,r)" display="inline"><mrow><mo mathvariant="normal" stretchy="false">(</mo><mi>A</mi><mo mathvariant="normal">,</mo><mi>p</mi><mo mathvariant="normal">,</mo><mi>r</mi><mo mathvariant="normal" stretchy="false">)</mo></mrow></math></span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_t">1.</th>
<td class="ltx_td ltx_align_left ltx_border_t"><math id="S1.SS1.SSS6.p5.m2" class="ltx_Math" alttext="x=A[r]" display="inline"><mrow><mi>x</mi><mo>=</mo><mrow><mi>A</mi><mo>⁢</mo><mrow><mo stretchy="false">[</mo><mi>r</mi><mo stretchy="false">]</mo></mrow></mrow></mrow></math></td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">2.</th>
<td class="ltx_td ltx_align_left"><math id="S1.SS1.SSS6.p5.m3" class="ltx_Math" alttext="i=p-1" display="inline"><mrow><mi>i</mi><mo>=</mo><mrow><mi>p</mi><mo>-</mo><mn>1</mn></mrow></mrow></math></td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">3.</th>
<td class="ltx_td ltx_align_left">
<span class="ltx_text ltx_font_bold">for</span> <math id="S1.SS1.SSS6.p5.m4" class="ltx_Math" alttext="j=p" display="inline"><mrow><mi>j</mi><mo>=</mo><mi>p</mi></mrow></math> to <math id="S1.SS1.SSS6.p5.m5" class="ltx_Math" alttext="r-1" display="inline"><mrow><mi>r</mi><mo>-</mo><mn>1</mn></mrow></math>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">4.</th>
<td class="ltx_td ltx_align_left"> <span class="ltx_text ltx_font_bold">if</span> <math id="S1.SS1.SSS6.p5.m6" class="ltx_Math" alttext="A[j]\leq x" display="inline"><mrow><mrow><mi>A</mi><mo>⁢</mo><mrow><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo></mrow></mrow><mo>≤</mo><mi>x</mi></mrow></math>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">5.</th>
<td class="ltx_td ltx_align_left">  <math id="S1.SS1.SSS6.p5.m7" class="ltx_Math" alttext="i=i+1" display="inline"><mrow><mi>i</mi><mo>=</mo><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></mrow></math>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">6.</th>
<td class="ltx_td ltx_align_left">  exchange <math id="S1.SS1.SSS6.p5.m8" class="ltx_Math" alttext="A[i]" display="inline"><mrow><mi>A</mi><mo>⁢</mo><mrow><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo></mrow></mrow></math> with <math id="S1.SS1.SSS6.p5.m9" class="ltx_Math" alttext="A[j]" display="inline"><mrow><mi>A</mi><mo>⁢</mo><mrow><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo></mrow></mrow></math>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">7.</th>
<td class="ltx_td ltx_align_left">exchange <math id="S1.SS1.SSS6.p5.m10" class="ltx_Math" alttext="A[i+1]" display="inline"><mrow><mi>A</mi><mo>⁢</mo><mrow><mo stretchy="false">[</mo><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow><mo stretchy="false">]</mo></mrow></mrow></math> with <math id="S1.SS1.SSS6.p5.m11" class="ltx_Math" alttext="A[r]" display="inline"><mrow><mi>A</mi><mo>⁢</mo><mrow><mo stretchy="false">[</mo><mi>r</mi><mo stretchy="false">]</mo></mrow></mrow></math>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_bb">8.</th>
<td class="ltx_td ltx_align_left ltx_border_bb">
<span class="ltx_text ltx_font_bold">return</span> <math id="S1.SS1.SSS6.p5.m12" class="ltx_Math" alttext="i+1" display="inline"><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></math>
</td>
</tr>
</tbody>
</table>
</div>
<div id="S1.SS1.SSS6.p6" class="ltx_para ltx_align_center">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr class="ltx_tr">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" colspan="2"><span class="ltx_text ltx_font_smallcaps">Randomized-Partition<math id="S1.SS1.SSS6.p6.m1" class="ltx_Math" alttext="(A,p,r)" display="inline"><mrow><mo mathvariant="normal" stretchy="false">(</mo><mi>A</mi><mo mathvariant="normal">,</mo><mi>p</mi><mo mathvariant="normal">,</mo><mi>r</mi><mo mathvariant="normal" stretchy="false">)</mo></mrow></math></span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_t">1.</th>
<td class="ltx_td ltx_align_left ltx_border_t"><math id="S1.SS1.SSS6.p6.m2" class="ltx_Math" alttext="i=Random(p,r)" display="inline"><mrow><mi>i</mi><mo>=</mo><mrow><mi>R</mi><mo>⁢</mo><mi>a</mi><mo>⁢</mo><mi>n</mi><mo>⁢</mo><mi>d</mi><mo>⁢</mo><mi>o</mi><mo>⁢</mo><mi>m</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>p</mi><mo>,</mo><mi>r</mi><mo stretchy="false">)</mo></mrow></mrow></mrow></math></td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">2.</th>
<td class="ltx_td ltx_align_left">exchange <math id="S1.SS1.SSS6.p6.m3" class="ltx_Math" alttext="A[r]" display="inline"><mrow><mi>A</mi><mo>⁢</mo><mrow><mo stretchy="false">[</mo><mi>r</mi><mo stretchy="false">]</mo></mrow></mrow></math> with <math id="S1.SS1.SSS6.p6.m4" class="ltx_Math" alttext="A[i]" display="inline"><mrow><mi>A</mi><mo>⁢</mo><mrow><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo></mrow></mrow></math>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_bb">3.</th>
<td class="ltx_td ltx_align_left ltx_border_bb">
<span class="ltx_text ltx_font_bold">return</span> <span class="ltx_text ltx_font_smallcaps">Partition<math id="S1.SS1.SSS6.p6.m5" class="ltx_Math" alttext="(A,p,r)" display="inline"><mrow><mo mathvariant="normal" stretchy="false">(</mo><mi>A</mi><mo mathvariant="normal">,</mo><mi>p</mi><mo mathvariant="normal">,</mo><mi>r</mi><mo mathvariant="normal" stretchy="false">)</mo></mrow></math></span>
</td>
</tr>
</tbody>
</table>
</div>
<div id="S1.SS1.SSS6.p7" class="ltx_para ltx_noindent">
<p class="ltx_p">However, there are some drawbacks of this implementation:
this partition algorithm behaves poorly if the input array contains many equal elements.</p>
</div>
<div id="S1.SS1.SSS6.p8" class="ltx_para ltx_noindent">
<p class="ltx_p"><span class="ltx_text ltx_font_bold">Quick sort:</span></p>
</div>
<div id="S1.SS1.SSS6.p9" class="ltx_para ltx_noindent">
<p class="ltx_p">Quick sort divides the array into two parts, and sort each part recursively.
It is very similar to merge sort, but it does not need to combine the two parts.</p>
</div>
<div id="S1.SS1.SSS6.p10" class="ltx_para ltx_noindent">
<p class="ltx_p"><span class="ltx_text ltx_font_bold">Runtime:</span>
Worst case: <math id="S1.SS1.SSS6.p10.m1" class="ltx_Math" alttext="O(n^{2})" display="inline"><mrow><mi>O</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><msup><mi>n</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mrow></mrow></math>, Best case: <math id="S1.SS1.SSS6.p10.m2" class="ltx_Math" alttext="O(n\log n)" display="inline"><mrow><mi>O</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mi>n</mi><mo>⁢</mo><mrow><mi>log</mi><mo>⁡</mo><mi>n</mi></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow></math>, Average case: <math id="S1.SS1.SSS6.p10.m3" class="ltx_Math" alttext="O(n\log n)" display="inline"><mrow><mi>O</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mi>n</mi><mo>⁢</mo><mrow><mi>log</mi><mo>⁡</mo><mi>n</mi></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow></math></p>
</div>
<div id="S1.SS1.SSS6.p11" class="ltx_para ltx_noindent">
<p class="ltx_p"><span class="ltx_text ltx_font_bold">Correctness:</span>
Similar to merge sort.
By induction, the two smaller subarrays are sorted correctly with induction hypothesis, and the partition step partitions the array correctly.</p>
</div>
<div id="S1.SS1.SSS6.p12" class="ltx_para ltx_noindent">
<p class="ltx_p"><span class="ltx_text ltx_font_bold">Inplace:</span>
Yes</p>
</div>
<div id="S1.SS1.SSS6.p13" class="ltx_para ltx_noindent">
<p class="ltx_p"><span class="ltx_text ltx_font_bold">Stable:</span>
No</p>
</div>
<div id="S1.SS1.SSS6.p14" class="ltx_para ltx_align_center">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr class="ltx_tr">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" colspan="2"><span class="ltx_text ltx_font_smallcaps">Quick-Sort<math id="S1.SS1.SSS6.p14.m1" class="ltx_Math" alttext="(A,p,r)" display="inline"><mrow><mo mathvariant="normal" stretchy="false">(</mo><mi>A</mi><mo mathvariant="normal">,</mo><mi>p</mi><mo mathvariant="normal">,</mo><mi>r</mi><mo mathvariant="normal" stretchy="false">)</mo></mrow></math></span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_t">1.</th>
<td class="ltx_td ltx_align_left ltx_border_t">
<span class="ltx_text ltx_font_bold">if</span> <math id="S1.SS1.SSS6.p14.m2" class="ltx_Math" alttext="p&lt;r" display="inline"><mrow><mi>p</mi><mo>&lt;</mo><mi>r</mi></mrow></math>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">2.</th>
<td class="ltx_td ltx_align_left"> <math id="S1.SS1.SSS6.p14.m3" class="ltx_Math" alttext="q=\textsc{Partition}(A,p,r)" display="inline"><mrow><mi>q</mi><mo>=</mo><mrow><mtext class="ltx_font_smallcaps" mathvariant="normal">Partition</mtext><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>A</mi><mo>,</mo><mi>p</mi><mo>,</mo><mi>r</mi><mo stretchy="false">)</mo></mrow></mrow></mrow></math>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">3.</th>
<td class="ltx_td ltx_align_left"> <span class="ltx_text ltx_font_smallcaps">Quick-Sort<math id="S1.SS1.SSS6.p14.m4" class="ltx_Math" alttext="(A,p,q-1)" display="inline"><mrow><mo mathvariant="normal" stretchy="false">(</mo><mi>A</mi><mo mathvariant="normal">,</mo><mi>p</mi><mo mathvariant="normal">,</mo><mrow><mi>q</mi><mo mathvariant="normal">-</mo><mn mathvariant="normal">1</mn></mrow><mo mathvariant="normal" stretchy="false">)</mo></mrow></math></span>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_bb">4.</th>
<td class="ltx_td ltx_align_left ltx_border_bb"> <span class="ltx_text ltx_font_smallcaps">Quick-Sort<math id="S1.SS1.SSS6.p14.m5" class="ltx_Math" alttext="(A,q+1,r)" display="inline"><mrow><mo mathvariant="normal" stretchy="false">(</mo><mi>A</mi><mo mathvariant="normal">,</mo><mrow><mi>q</mi><mo mathvariant="normal">+</mo><mn mathvariant="normal">1</mn></mrow><mo mathvariant="normal">,</mo><mi>r</mi><mo mathvariant="normal" stretchy="false">)</mo></mrow></math></span>
</td>
</tr>
</tbody>
</table>
</div>
<div id="S1.SS1.SSS6.p15" class="ltx_para ltx_noindent">
<p class="ltx_p">The randomized version is omitted here.</p>
</div>
<div id="S1.SS1.SSS6.p16" class="ltx_para ltx_noindent">
<p class="ltx_p"><span class="ltx_text ltx_font_bold">Randomization:</span></p>
</div>
<div id="S1.SS1.SSS6.p17" class="ltx_para ltx_noindent">
<p class="ltx_p">We can estimate the runtime of quick sort by the expected number of comparisons.</p>
</div>
<div id="S1.SS1.SSS6.p18" class="ltx_para ltx_noindent">
<p class="ltx_p">For a partition with fixed ratio, we can prove that the expected number of comparisons is always <math id="S1.SS1.SSS6.p18.m1" class="ltx_Math" alttext="O(n\log n)" display="inline"><mrow><mi>O</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mi>n</mi><mo>⁢</mo><mrow><mi>log</mi><mo>⁡</mo><mi>n</mi></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow></math>.
Suppose the ratio is <math id="S1.SS1.SSS6.p18.m2" class="ltx_Math" alttext="1:9" display="inline"><mrow><mn>1</mn><mo>:</mo><mn>9</mn></mrow></math>, then we can draw a tree for the partition.
We can find at each level, if on both side all nodes exists, the number of comparisons is <math id="S1.SS1.SSS6.p18.m3" class="ltx_Math" alttext="n" display="inline"><mi>n</mi></math>.
And the maximum number of levels is <math id="S1.SS1.SSS6.p18.m4" class="ltx_Math" alttext="\log_{10/9}n" display="inline"><mrow><msub><mi>log</mi><mrow><mn>10</mn><mo>/</mo><mn>9</mn></mrow></msub><mo>⁡</mo><mi>n</mi></mrow></math>.
In total, the number of comparisons is <math id="S1.SS1.SSS6.p18.m5" class="ltx_Math" alttext="O(n\log n)" display="inline"><mrow><mi>O</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mi>n</mi><mo>⁢</mo><mrow><mi>log</mi><mo>⁡</mo><mi>n</mi></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow></math>.</p>
</div>
<div id="S1.SS1.SSS6.p19" class="ltx_para ltx_noindent">
<p class="ltx_p">The expected number of comparisons for randomized quick sort can be calculated as follows:</p>
</div>
<div id="S1.SS1.SSS6.p20" class="ltx_para ltx_noindent">
<p class="ltx_p">Rename the array as <math id="S1.SS1.SSS6.p20.m1" class="ltx_Math" alttext="Z_{1},Z_{2},\dots,Z_{n}" display="inline"><mrow><msub><mi>Z</mi><mn>1</mn></msub><mo>,</mo><msub><mi>Z</mi><mn>2</mn></msub><mo>,</mo><mi mathvariant="normal">…</mi><mo>,</mo><msub><mi>Z</mi><mi>n</mi></msub></mrow></math>, where <math id="S1.SS1.SSS6.p20.m2" class="ltx_Math" alttext="Z_{1}&lt;Z_{2}&lt;\dots&lt;Z_{n}" display="inline"><mrow><msub><mi>Z</mi><mn>1</mn></msub><mo>&lt;</mo><msub><mi>Z</mi><mn>2</mn></msub><mo>&lt;</mo><mi mathvariant="normal">⋯</mi><mo>&lt;</mo><msub><mi>Z</mi><mi>n</mi></msub></mrow></math>.
Then the possibility that <math id="S1.SS1.SSS6.p20.m3" class="ltx_Math" alttext="Z_{i}" display="inline"><msub><mi>Z</mi><mi>i</mi></msub></math> is compared with <math id="S1.SS1.SSS6.p20.m4" class="ltx_Math" alttext="Z_{j}" display="inline"><msub><mi>Z</mi><mi>j</mi></msub></math> is <math id="S1.SS1.SSS6.p20.m5" class="ltx_Math" alttext="\frac{2}{j-i+1}" display="inline"><mfrac><mn>2</mn><mrow><mrow><mi>j</mi><mo>-</mo><mi>i</mi></mrow><mo>+</mo><mn>1</mn></mrow></mfrac></math> (suppose <math id="S1.SS1.SSS6.p20.m6" class="ltx_Math" alttext="i&lt;j" display="inline"><mrow><mi>i</mi><mo>&lt;</mo><mi>j</mi></mrow></math>).</p>
</div>
<div id="S1.SS1.SSS6.p21" class="ltx_para ltx_noindent">
<p class="ltx_p">Hence, the expected number of comparisons is:</p>
<table id="S1.Ex1" class="ltx_equation ltx_eqn_table">

<tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S1.Ex1.m1" class="ltx_Math" alttext="\sum_{i=1}^{n-1}\sum_{j=i+1}^{n}\frac{2}{j-i+1}=\sum_{i=1}^{n-1}\sum_{k=1}^{n-%
i}\frac{2}{k+1}\leq\sum_{i=1}^{n-1}\sum_{k=1}^{n-i}\frac{2}{k}\leq 2n\sum_{k=2%
}^{n}\frac{1}{k}\leq 2n\ln n" display="block"><mrow><mrow><munderover><mo largeop="true" movablelimits="false" symmetric="true">∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi>n</mi><mo>-</mo><mn>1</mn></mrow></munderover><mrow><munderover><mo largeop="true" movablelimits="false" symmetric="true">∑</mo><mrow><mi>j</mi><mo>=</mo><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></mrow><mi>n</mi></munderover><mfrac><mn>2</mn><mrow><mrow><mi>j</mi><mo>-</mo><mi>i</mi></mrow><mo>+</mo><mn>1</mn></mrow></mfrac></mrow></mrow><mo>=</mo><mrow><munderover><mo largeop="true" movablelimits="false" symmetric="true">∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi>n</mi><mo>-</mo><mn>1</mn></mrow></munderover><mrow><munderover><mo largeop="true" movablelimits="false" symmetric="true">∑</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi>n</mi><mo>-</mo><mi>i</mi></mrow></munderover><mfrac><mn>2</mn><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></mfrac></mrow></mrow><mo>≤</mo><mrow><munderover><mo largeop="true" movablelimits="false" symmetric="true">∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi>n</mi><mo>-</mo><mn>1</mn></mrow></munderover><mrow><munderover><mo largeop="true" movablelimits="false" symmetric="true">∑</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi>n</mi><mo>-</mo><mi>i</mi></mrow></munderover><mfrac><mn>2</mn><mi>k</mi></mfrac></mrow></mrow><mo>≤</mo><mrow><mn>2</mn><mo>⁢</mo><mi>n</mi><mo>⁢</mo><mrow><munderover><mo largeop="true" movablelimits="false" symmetric="true">∑</mo><mrow><mi>k</mi><mo>=</mo><mn>2</mn></mrow><mi>n</mi></munderover><mfrac><mn>1</mn><mi>k</mi></mfrac></mrow></mrow><mo>≤</mo><mrow><mn>2</mn><mo>⁢</mo><mi>n</mi><mo>⁢</mo><mrow><mi>ln</mi><mo>⁡</mo><mi>n</mi></mrow></mrow></mrow></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</table>
</div>
</section>
<section id="S1.SS1.SSS7" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">1.1.7 </span>Lower Bound for Sorting Based on Comparison</h4>

<div id="S1.SS1.SSS7.p1" class="ltx_para ltx_noindent">
<p class="ltx_p">We can use decision tree to prove the lower bound for sorting.
</p>
</div>
<div id="S1.SS1.SSS7.p2" class="ltx_para ltx_noindent">
<p class="ltx_p">Let the input size be <math id="S1.SS1.SSS7.p2.m1" class="ltx_Math" alttext="n" display="inline"><mi>n</mi></math>, suppose the input is a permutation of <math id="S1.SS1.SSS7.p2.m2" class="ltx_Math" alttext="1,2,\dots,n" display="inline"><mrow><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mi mathvariant="normal">…</mi><mo>,</mo><mi>n</mi></mrow></math>, there are <math id="S1.SS1.SSS7.p2.m3" class="ltx_Math" alttext="n!" display="inline"><mrow><mi>n</mi><mo>!</mo></mrow></math> possible orders of the input.
Since each input must correspond to a leaf in the decision tree, the number of leaves is <math id="S1.SS1.SSS7.p2.m4" class="ltx_Math" alttext="n!" display="inline"><mrow><mi>n</mi><mo>!</mo></mrow></math>.
Hence, the height of the decision tree is <math id="S1.SS1.SSS7.p2.m5" class="ltx_Math" alttext="\Omega(\log n!)" display="inline"><mrow><mi mathvariant="normal">Ω</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mi>log</mi><mo>⁡</mo><mrow><mi>n</mi><mo>!</mo></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow></math>.</p>
</div>
<div id="S1.SS1.SSS7.p3" class="ltx_para ltx_noindent">
<p class="ltx_p">The lower bound of worst case runtime is the length of the longest path in the decision tree, which is the height of the decision tree.
By Stirling’s approximation, <math id="S1.SS1.SSS7.p3.m1" class="ltx_Math" alttext="\log n!=\Omega(n\log n)" display="inline"><mrow><mrow><mi>log</mi><mo>⁡</mo><mrow><mi>n</mi><mo>!</mo></mrow></mrow><mo>=</mo><mrow><mi mathvariant="normal">Ω</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mi>n</mi><mo>⁢</mo><mrow><mi>log</mi><mo>⁡</mo><mi>n</mi></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow></mrow></math>.</p>
</div>
</section>
</section>
<section id="S1.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">1.2 </span>Sorting Based on Counting</h3>

<section id="S1.SS2.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">1.2.1 </span>Counting Sort</h4>

<div id="S1.SS2.SSS1.p1" class="ltx_para ltx_noindent">
<p class="ltx_p">Counting Sort assumes that each of the <math id="S1.SS2.SSS1.p1.m1" class="ltx_Math" alttext="n" display="inline"><mi>n</mi></math> input elements is an integer in the range <math id="S1.SS2.SSS1.p1.m2" class="ltx_Math" alttext="0" display="inline"><mn>0</mn></math> to <math id="S1.SS2.SSS1.p1.m3" class="ltx_Math" alttext="k" display="inline"><mi>k</mi></math>, for some integer <math id="S1.SS2.SSS1.p1.m4" class="ltx_Math" alttext="k" display="inline"><mi>k</mi></math>.
It works by counting the number of elements of each value.</p>
</div>
<div id="S1.SS2.SSS1.p2" class="ltx_para ltx_noindent">
<p class="ltx_p"><span class="ltx_text ltx_font_bold">Runtime:</span>
<math id="S1.SS2.SSS1.p2.m1" class="ltx_Math" alttext="\Theta(n+k)" display="inline"><mrow><mi mathvariant="normal">Θ</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mi>n</mi><mo>+</mo><mi>k</mi></mrow><mo stretchy="false">)</mo></mrow></mrow></math></p>
</div>
<div id="S1.SS2.SSS1.p3" class="ltx_para ltx_noindent">
<p class="ltx_p"><span class="ltx_text ltx_font_bold">Correctness:</span>
By loop invariant:
At the start of each iteration of the for loop, the last element in <math id="S1.SS2.SSS1.p3.m1" class="ltx_Math" alttext="A" display="inline"><mi>A</mi></math> with value <math id="S1.SS2.SSS1.p3.m2" class="ltx_Math" alttext="i" display="inline"><mi>i</mi></math> that has not yet been copied to <math id="S1.SS2.SSS1.p3.m3" class="ltx_Math" alttext="B" display="inline"><mi>B</mi></math> belongs to <math id="S1.SS2.SSS1.p3.m4" class="ltx_Math" alttext="B[C[i]]" display="inline"><mrow><mi>B</mi><mo>⁢</mo><mrow><mo stretchy="false">[</mo><mrow><mi>C</mi><mo>⁢</mo><mrow><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo></mrow></mrow><mo stretchy="false">]</mo></mrow></mrow></math>.</p>
</div>
<div id="S1.SS2.SSS1.p4" class="ltx_para ltx_noindent">
<p class="ltx_p"><span class="ltx_text ltx_font_bold">Inplace:</span>
No</p>
</div>
<div id="S1.SS2.SSS1.p5" class="ltx_para ltx_noindent">
<p class="ltx_p"><span class="ltx_text ltx_font_bold">Stable:</span>
Yes</p>
</div>
<div id="S1.SS2.SSS1.p6" class="ltx_para ltx_align_center">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr class="ltx_tr">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" colspan="2"><span class="ltx_text ltx_font_smallcaps">Counting-Sort<math id="S1.SS2.SSS1.p6.m1" class="ltx_Math" alttext="(A,B,k)" display="inline"><mrow><mo mathvariant="normal" stretchy="false">(</mo><mi>A</mi><mo mathvariant="normal">,</mo><mi>B</mi><mo mathvariant="normal">,</mo><mi>k</mi><mo mathvariant="normal" stretchy="false">)</mo></mrow></math></span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_t">1.</th>
<td class="ltx_td ltx_align_left ltx_border_t">let <math id="S1.SS2.SSS1.p6.m2" class="ltx_Math" alttext="C[0..k]" display="inline"><mrow><mi>C</mi><mrow><mo stretchy="false">[</mo><mn>0</mn><mo>.</mo><mo>.</mo><mi>k</mi><mo stretchy="false">]</mo></mrow></mrow></math> be a new array</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">2.</th>
<td class="ltx_td ltx_align_left">
<span class="ltx_text ltx_font_bold">for</span> <math id="S1.SS2.SSS1.p6.m3" class="ltx_Math" alttext="i=0" display="inline"><mrow><mi>i</mi><mo>=</mo><mn>0</mn></mrow></math> to <math id="S1.SS2.SSS1.p6.m4" class="ltx_Math" alttext="k" display="inline"><mi>k</mi></math>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">3.</th>
<td class="ltx_td ltx_align_left"> <math id="S1.SS2.SSS1.p6.m5" class="ltx_Math" alttext="C[i]=0" display="inline"><mrow><mrow><mi>C</mi><mo>⁢</mo><mrow><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo></mrow></mrow><mo>=</mo><mn>0</mn></mrow></math>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">4.</th>
<td class="ltx_td ltx_align_left">
<span class="ltx_text ltx_font_bold">for</span> <math id="S1.SS2.SSS1.p6.m6" class="ltx_Math" alttext="j=1" display="inline"><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow></math> to <math id="S1.SS2.SSS1.p6.m7" class="ltx_Math" alttext="A.length" display="inline"><mrow><mi>A</mi><mo>.</mo><mrow><mi>l</mi><mo>⁢</mo><mi>e</mi><mo>⁢</mo><mi>n</mi><mo>⁢</mo><mi>g</mi><mo>⁢</mo><mi>t</mi><mo>⁢</mo><mi>h</mi></mrow></mrow></math>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">5.</th>
<td class="ltx_td ltx_align_left"> <math id="S1.SS2.SSS1.p6.m8" class="ltx_Math" alttext="C[A[j]]=C[A[j]]+1" display="inline"><mrow><mrow><mi>C</mi><mo>⁢</mo><mrow><mo stretchy="false">[</mo><mrow><mi>A</mi><mo>⁢</mo><mrow><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo></mrow></mrow><mo stretchy="false">]</mo></mrow></mrow><mo>=</mo><mrow><mrow><mi>C</mi><mo>⁢</mo><mrow><mo stretchy="false">[</mo><mrow><mi>A</mi><mo>⁢</mo><mrow><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo></mrow></mrow><mo stretchy="false">]</mo></mrow></mrow><mo>+</mo><mn>1</mn></mrow></mrow></math>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">6.</th>
<td class="ltx_td ltx_align_left">
<span class="ltx_text ltx_font_bold">for</span> <math id="S1.SS2.SSS1.p6.m9" class="ltx_Math" alttext="i=1" display="inline"><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow></math> to <math id="S1.SS2.SSS1.p6.m10" class="ltx_Math" alttext="k" display="inline"><mi>k</mi></math>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">7.</th>
<td class="ltx_td ltx_align_left"> <math id="S1.SS2.SSS1.p6.m11" class="ltx_Math" alttext="C[i]=C[i]+C[i-1]" display="inline"><mrow><mrow><mi>C</mi><mo>⁢</mo><mrow><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo></mrow></mrow><mo>=</mo><mrow><mrow><mi>C</mi><mo>⁢</mo><mrow><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo></mrow></mrow><mo>+</mo><mrow><mi>C</mi><mo>⁢</mo><mrow><mo stretchy="false">[</mo><mrow><mi>i</mi><mo>-</mo><mn>1</mn></mrow><mo stretchy="false">]</mo></mrow></mrow></mrow></mrow></math>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">8.</th>
<td class="ltx_td ltx_align_left">
<span class="ltx_text ltx_font_bold">for</span> <math id="S1.SS2.SSS1.p6.m12" class="ltx_Math" alttext="j=A.length" display="inline"><mrow><mrow><mi>j</mi><mo>=</mo><mi>A</mi></mrow><mo>.</mo><mrow><mi>l</mi><mo>⁢</mo><mi>e</mi><mo>⁢</mo><mi>n</mi><mo>⁢</mo><mi>g</mi><mo>⁢</mo><mi>t</mi><mo>⁢</mo><mi>h</mi></mrow></mrow></math> downto <math id="S1.SS2.SSS1.p6.m13" class="ltx_Math" alttext="1" display="inline"><mn>1</mn></math>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">9.</th>
<td class="ltx_td ltx_align_left"> <math id="S1.SS2.SSS1.p6.m14" class="ltx_Math" alttext="B[C[A[j]]]=A[j]" display="inline"><mrow><mrow><mi>B</mi><mo>⁢</mo><mrow><mo stretchy="false">[</mo><mrow><mi>C</mi><mo>⁢</mo><mrow><mo stretchy="false">[</mo><mrow><mi>A</mi><mo>⁢</mo><mrow><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo></mrow></mrow><mo stretchy="false">]</mo></mrow></mrow><mo stretchy="false">]</mo></mrow></mrow><mo>=</mo><mrow><mi>A</mi><mo>⁢</mo><mrow><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo></mrow></mrow></mrow></math>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_bb">10.</th>
<td class="ltx_td ltx_align_left ltx_border_bb"> <math id="S1.SS2.SSS1.p6.m15" class="ltx_Math" alttext="C[A[j]]=C[A[j]]-1" display="inline"><mrow><mrow><mi>C</mi><mo>⁢</mo><mrow><mo stretchy="false">[</mo><mrow><mi>A</mi><mo>⁢</mo><mrow><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo></mrow></mrow><mo stretchy="false">]</mo></mrow></mrow><mo>=</mo><mrow><mrow><mi>C</mi><mo>⁢</mo><mrow><mo stretchy="false">[</mo><mrow><mi>A</mi><mo>⁢</mo><mrow><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo></mrow></mrow><mo stretchy="false">]</mo></mrow></mrow><mo>-</mo><mn>1</mn></mrow></mrow></math>
</td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="S1.SS2.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">1.2.2 </span>Radix Sort</h4>

<div id="S1.SS2.SSS2.p1" class="ltx_para ltx_noindent">
<p class="ltx_p">Radix Sort sorts the elements’ digit by digit.
</p>
</div>
<div id="S1.SS2.SSS2.p2" class="ltx_para ltx_noindent">
<p class="ltx_p"><span class="ltx_text ltx_font_bold">Runtime:</span>
<math id="S1.SS2.SSS2.p2.m1" class="ltx_Math" alttext="\Theta(d(n+k))" display="inline"><mrow><mi mathvariant="normal">Θ</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mi>d</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mi>n</mi><mo>+</mo><mi>k</mi></mrow><mo stretchy="false">)</mo></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow></math>, where <math id="S1.SS2.SSS2.p2.m2" class="ltx_Math" alttext="d" display="inline"><mi>d</mi></math> is the number of digits.</p>
</div>
<div id="S1.SS2.SSS2.p3" class="ltx_para ltx_noindent">
<p class="ltx_p"><span class="ltx_text ltx_font_bold">Correctness:</span>
At each iteration of the for loop, the elements are sorted on the last <math id="S1.SS2.SSS2.p3.m1" class="ltx_Math" alttext="i-1" display="inline"><mrow><mi>i</mi><mo>-</mo><mn>1</mn></mrow></math> digits.</p>
</div>
<div id="S1.SS2.SSS2.p4" class="ltx_para ltx_noindent">
<p class="ltx_p"><span class="ltx_text ltx_font_bold">Inplace:</span>
No</p>
</div>
<div id="S1.SS2.SSS2.p5" class="ltx_para ltx_noindent">
<p class="ltx_p"><span class="ltx_text ltx_font_bold">Stable:</span>
Yes</p>
</div>
<div id="S1.SS2.SSS2.p6" class="ltx_para ltx_align_center">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr class="ltx_tr">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" colspan="2"><span class="ltx_text ltx_font_smallcaps">Radix-Sort<math id="S1.SS2.SSS2.p6.m1" class="ltx_Math" alttext="(A,d)" display="inline"><mrow><mo mathvariant="normal" stretchy="false">(</mo><mi>A</mi><mo mathvariant="normal">,</mo><mi>d</mi><mo mathvariant="normal" stretchy="false">)</mo></mrow></math></span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_t">1.</th>
<td class="ltx_td ltx_align_left ltx_border_t">
<span class="ltx_text ltx_font_bold">for</span> <math id="S1.SS2.SSS2.p6.m2" class="ltx_Math" alttext="i=1" display="inline"><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow></math> to <math id="S1.SS2.SSS2.p6.m3" class="ltx_Math" alttext="d" display="inline"><mi>d</mi></math>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_bb">2.</th>
<td class="ltx_td ltx_align_left ltx_border_bb"> use a stable sort to sort array <math id="S1.SS2.SSS2.p6.m4" class="ltx_Math" alttext="A" display="inline"><mi>A</mi></math> on digit <math id="S1.SS2.SSS2.p6.m5" class="ltx_Math" alttext="i" display="inline"><mi>i</mi></math>
</td>
</tr>
</tbody>
</table>
</div>
<div id="S1.SS2.SSS2.p7" class="ltx_para ltx_noindent">
<p class="ltx_p"><span class="ltx_text ltx_font_bold">Attention:</span> radix sort begins from the least significant digit.
</p>
</div>
<div id="S1.SS2.SSS2.p8" class="ltx_para ltx_noindent">
<p class="ltx_p">When <math id="S1.SS2.SSS2.p8.m1" class="ltx_Math" alttext="d" display="inline"><mi>d</mi></math> is a constant and <math id="S1.SS2.SSS2.p8.m2" class="ltx_Math" alttext="k=O(n)" display="inline"><mrow><mi>k</mi><mo>=</mo><mrow><mi>O</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></mrow></mrow></math>, radix sort runs in <math id="S1.SS2.SSS2.p8.m3" class="ltx_Math" alttext="\Theta(n)" display="inline"><mrow><mi mathvariant="normal">Θ</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></mrow></math>.
In more general cases, we can decide how to choose <math id="S1.SS2.SSS2.p8.m4" class="ltx_Math" alttext="d" display="inline"><mi>d</mi></math> and <math id="S1.SS2.SSS2.p8.m5" class="ltx_Math" alttext="k" display="inline"><mi>k</mi></math> to make the radix sort faster.</p>
</div>
<div id="S1.SS2.SSS2.p9" class="ltx_para ltx_noindent">
<p class="ltx_p">Without loss of generality, we assume the number is in base <math id="S1.SS2.SSS2.p9.m1" class="ltx_Math" alttext="2" display="inline"><mn>2</mn></math>.
The for a <math id="S1.SS2.SSS2.p9.m2" class="ltx_Math" alttext="b" display="inline"><mi>b</mi></math> bit number, we can divide it into <math id="S1.SS2.SSS2.p9.m3" class="ltx_Math" alttext="\lceil b/d\rceil" display="inline"><mrow><mo stretchy="false">⌈</mo><mrow><mi>b</mi><mo>/</mo><mi>d</mi></mrow><mo stretchy="false">⌉</mo></mrow></math> groups, each group has <math id="S1.SS2.SSS2.p9.m4" class="ltx_Math" alttext="d" display="inline"><mi>d</mi></math> bits.
Then we can use counting sort to sort each group.
Hence, the runtime is <math id="S1.SS2.SSS2.p9.m5" class="ltx_Math" alttext="\Theta(\lceil b/d\rceil(n+2^{d}))" display="inline"><mrow><mi mathvariant="normal">Θ</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mrow><mo stretchy="false">⌈</mo><mrow><mi>b</mi><mo>/</mo><mi>d</mi></mrow><mo stretchy="false">⌉</mo></mrow><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mi>n</mi><mo>+</mo><msup><mn>2</mn><mi>d</mi></msup></mrow><mo stretchy="false">)</mo></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow></math>.</p>
</div>
<div id="S1.SS2.SSS2.p10" class="ltx_para ltx_noindent">
<p class="ltx_p">When <math id="S1.SS2.SSS2.p10.m1" class="ltx_Math" alttext="b&lt;\lfloor\log n\rfloor" display="inline"><mrow><mi>b</mi><mo>&lt;</mo><mrow><mo stretchy="false">⌊</mo><mrow><mi>log</mi><mo>⁡</mo><mi>n</mi></mrow><mo stretchy="false">⌋</mo></mrow></mrow></math>, we can choose <math id="S1.SS2.SSS2.p10.m2" class="ltx_Math" alttext="d=b" display="inline"><mrow><mi>d</mi><mo>=</mo><mi>b</mi></mrow></math>.
Then the runtime is <math id="S1.SS2.SSS2.p10.m3" class="ltx_Math" alttext="\Theta(\frac{b}{b}(n+2^{b}))=\Theta(n)" display="inline"><mrow><mrow><mi mathvariant="normal">Θ</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mfrac><mi>b</mi><mi>b</mi></mfrac><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mi>n</mi><mo>+</mo><msup><mn>2</mn><mi>b</mi></msup></mrow><mo stretchy="false">)</mo></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><mi mathvariant="normal">Θ</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></mrow></mrow></math>.</p>
</div>
<div id="S1.SS2.SSS2.p11" class="ltx_para ltx_noindent">
<p class="ltx_p">When <math id="S1.SS2.SSS2.p11.m1" class="ltx_Math" alttext="b\geq\lfloor\log n\rfloor" display="inline"><mrow><mi>b</mi><mo>≥</mo><mrow><mo stretchy="false">⌊</mo><mrow><mi>log</mi><mo>⁡</mo><mi>n</mi></mrow><mo stretchy="false">⌋</mo></mrow></mrow></math>, we can choose <math id="S1.SS2.SSS2.p11.m2" class="ltx_Math" alttext="d=\lfloor\log n\rfloor" display="inline"><mrow><mi>d</mi><mo>=</mo><mrow><mo stretchy="false">⌊</mo><mrow><mi>log</mi><mo>⁡</mo><mi>n</mi></mrow><mo stretchy="false">⌋</mo></mrow></mrow></math>.
Then the runtime is <math id="S1.SS2.SSS2.p11.m3" class="ltx_Math" alttext="\Theta(\frac{b}{\log n}(n+2^{\log n}))=\Theta(\frac{bn}{\log n})" display="inline"><mrow><mrow><mi mathvariant="normal">Θ</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mfrac><mi>b</mi><mrow><mi>log</mi><mo>⁡</mo><mi>n</mi></mrow></mfrac><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mi>n</mi><mo>+</mo><msup><mn>2</mn><mrow><mi>log</mi><mo>⁡</mo><mi>n</mi></mrow></msup></mrow><mo stretchy="false">)</mo></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><mi mathvariant="normal">Θ</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mfrac><mrow><mi>b</mi><mo>⁢</mo><mi>n</mi></mrow><mrow><mi>log</mi><mo>⁡</mo><mi>n</mi></mrow></mfrac><mo stretchy="false">)</mo></mrow></mrow></mrow></math>.</p>
</div>
</section>
</section>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Elementary Data Structures</h2>

<section id="S2.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>Stack</h3>

<div id="S2.SS1.p1" class="ltx_para ltx_noindent">
<p class="ltx_p">In a stack, only the top element can be accessed.
It follows the Last In First Out (LIFO) principle.</p>
</div>
<div id="S2.SS1.p2" class="ltx_para ltx_noindent">
<p class="ltx_p">Its operations are:</p>
<ol id="S2.I1" class="ltx_enumerate">
<li id="S2.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1.</span> 
<div id="S2.I1.i1.p1" class="ltx_para ltx_noindent">
<p class="ltx_p"><span class="ltx_text ltx_font_smallcaps">Push<math id="S2.I1.i1.p1.m1" class="ltx_Math" alttext="(S,x)" display="inline"><mrow><mo mathvariant="normal" stretchy="false">(</mo><mi>S</mi><mo mathvariant="normal">,</mo><mi>x</mi><mo mathvariant="normal" stretchy="false">)</mo></mrow></math></span>: insert <math id="S2.I1.i1.p1.m2" class="ltx_Math" alttext="x" display="inline"><mi>x</mi></math> into <math id="S2.I1.i1.p1.m3" class="ltx_Math" alttext="S" display="inline"><mi>S</mi></math>.</p>
</div>
</li>
<li id="S2.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">2.</span> 
<div id="S2.I1.i2.p1" class="ltx_para ltx_noindent">
<p class="ltx_p"><span class="ltx_text ltx_font_smallcaps">Pop<math id="S2.I1.i2.p1.m1" class="ltx_Math" alttext="(S)" display="inline"><mrow><mo mathvariant="normal" stretchy="false">(</mo><mi>S</mi><mo mathvariant="normal" stretchy="false">)</mo></mrow></math></span>: remove and return the top element of <math id="S2.I1.i2.p1.m2" class="ltx_Math" alttext="S" display="inline"><mi>S</mi></math>.</p>
</div>
</li>
</ol>
</div>
<div id="S2.SS1.p3" class="ltx_para ltx_noindent">
<p class="ltx_p"><span class="ltx_text ltx_font_bold">Attention:</span>
<math id="S2.SS1.p3.m1" class="ltx_Math" alttext="S.top" display="inline"><mrow><mi>S</mi><mo>.</mo><mrow><mi>t</mi><mo>⁢</mo><mi>o</mi><mo>⁢</mo><mi>p</mi></mrow></mrow></math> points at the top element of the stack, not an empty element.
We initialize <math id="S2.SS1.p3.m2" class="ltx_Math" alttext="S.top=0" display="inline"><mrow><mi>S</mi><mo>.</mo><mrow><mrow><mi>t</mi><mo>⁢</mo><mi>o</mi><mo>⁢</mo><mi>p</mi></mrow><mo>=</mo><mn>0</mn></mrow></mrow></math>.</p>
</div>
</section>
<section id="S2.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span>Queue</h3>

<div id="S2.SS2.p1" class="ltx_para ltx_noindent">
<p class="ltx_p">In a queue, elements are inserted at the tail, and removed from the head.
A queue follows the First In First Out (FIFO) principle.</p>
</div>
<div id="S2.SS2.p2" class="ltx_para ltx_noindent">
<p class="ltx_p">Its operations are:</p>
<ol id="S2.I2" class="ltx_enumerate">
<li id="S2.I2.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1.</span> 
<div id="S2.I2.i1.p1" class="ltx_para ltx_noindent">
<p class="ltx_p"><span class="ltx_text ltx_font_smallcaps">Enqueue<math id="S2.I2.i1.p1.m1" class="ltx_Math" alttext="(Q,x)" display="inline"><mrow><mo mathvariant="normal" stretchy="false">(</mo><mi>Q</mi><mo mathvariant="normal">,</mo><mi>x</mi><mo mathvariant="normal" stretchy="false">)</mo></mrow></math></span>: insert <math id="S2.I2.i1.p1.m2" class="ltx_Math" alttext="x" display="inline"><mi>x</mi></math> into <math id="S2.I2.i1.p1.m3" class="ltx_Math" alttext="Q" display="inline"><mi>Q</mi></math>.</p>
</div>
</li>
<li id="S2.I2.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">2.</span> 
<div id="S2.I2.i2.p1" class="ltx_para ltx_noindent">
<p class="ltx_p"><span class="ltx_text ltx_font_smallcaps">Dequeue<math id="S2.I2.i2.p1.m1" class="ltx_Math" alttext="(Q)" display="inline"><mrow><mo mathvariant="normal" stretchy="false">(</mo><mi>Q</mi><mo mathvariant="normal" stretchy="false">)</mo></mrow></math></span>: remove and return the head element of <math id="S2.I2.i2.p1.m2" class="ltx_Math" alttext="Q" display="inline"><mi>Q</mi></math>.</p>
</div>
</li>
</ol>
</div>
<div id="S2.SS2.p3" class="ltx_para ltx_noindent">
<p class="ltx_p"><span class="ltx_text ltx_font_bold">Attention:</span>
<math id="S2.SS2.p3.m1" class="ltx_Math" alttext="Q.head" display="inline"><mrow><mi>Q</mi><mo>.</mo><mrow><mi>h</mi><mo>⁢</mo><mi>e</mi><mo>⁢</mo><mi>a</mi><mo>⁢</mo><mi>d</mi></mrow></mrow></math> points at the head element of the queue, but <math id="S2.SS2.p3.m2" class="ltx_Math" alttext="Q.tail" display="inline"><mrow><mi>Q</mi><mo>.</mo><mrow><mi>t</mi><mo>⁢</mo><mi>a</mi><mo>⁢</mo><mi>i</mi><mo>⁢</mo><mi>l</mi></mrow></mrow></math> points at the empty element after the tail element.
We initialize <math id="S2.SS2.p3.m3" class="ltx_Math" alttext="Q.head=Q.tail=1" display="inline"><mrow><mi>Q</mi><mo>.</mo><mrow><mrow><mi>h</mi><mo>⁢</mo><mi>e</mi><mo>⁢</mo><mi>a</mi><mo>⁢</mo><mi>d</mi></mrow><mo>=</mo><mi>Q</mi></mrow><mo>.</mo><mrow><mrow><mi>t</mi><mo>⁢</mo><mi>a</mi><mo>⁢</mo><mi>i</mi><mo>⁢</mo><mi>l</mi></mrow><mo>=</mo><mn>1</mn></mrow></mrow></math>.
It should be noted that a queue implemented in this way with an array of size <math id="S2.SS2.p3.m4" class="ltx_Math" alttext="n" display="inline"><mi>n</mi></math> can only store <math id="S2.SS2.p3.m5" class="ltx_Math" alttext="n-1" display="inline"><mrow><mi>n</mi><mo>-</mo><mn>1</mn></mrow></math> elements.
Since if it stores <math id="S2.SS2.p3.m6" class="ltx_Math" alttext="n" display="inline"><mi>n</mi></math> elements, then <math id="S2.SS2.p3.m7" class="ltx_Math" alttext="Q.head=Q.tail" display="inline"><mrow><mi>Q</mi><mo>.</mo><mrow><mrow><mi>h</mi><mo>⁢</mo><mi>e</mi><mo>⁢</mo><mi>a</mi><mo>⁢</mo><mi>d</mi></mrow><mo>=</mo><mi>Q</mi></mrow><mo>.</mo><mrow><mi>t</mi><mo>⁢</mo><mi>a</mi><mo>⁢</mo><mi>i</mi><mo>⁢</mo><mi>l</mi></mrow></mrow></math>, which means we cannot distinguish between an empty queue and a full queue.</p>
</div>
</section>
<section id="S2.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.3 </span>Linked List</h3>

<div id="S2.SS3.p1" class="ltx_para ltx_noindent">
<p class="ltx_p">In a linked list, every element contains two pointers: one points at the previous element, and the other points at the next element.
It is also called a doubly linked list.</p>
</div>
<div id="S2.SS3.p2" class="ltx_para ltx_noindent">
<p class="ltx_p">Linked list makes it easy to insert or delete an element.
Here are the pseudocode for insertion and deletion.</p>
</div>
<div id="S2.SS3.p3" class="ltx_para ltx_align_center">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr class="ltx_tr">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" colspan="2"><span class="ltx_text ltx_font_smallcaps">List-Insert<math id="S2.SS3.p3.m1" class="ltx_Math" alttext="(L,x)" display="inline"><mrow><mo mathvariant="normal" stretchy="false">(</mo><mi>L</mi><mo mathvariant="normal">,</mo><mi>x</mi><mo mathvariant="normal" stretchy="false">)</mo></mrow></math></span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_t">1.</th>
<td class="ltx_td ltx_align_left ltx_border_t"><math id="S2.SS3.p3.m2" class="ltx_Math" alttext="x.next=L.head" display="inline"><mrow><mi>x</mi><mo>.</mo><mrow><mrow><mi>n</mi><mo>⁢</mo><mi>e</mi><mo>⁢</mo><mi>x</mi><mo>⁢</mo><mi>t</mi></mrow><mo>=</mo><mi>L</mi></mrow><mo>.</mo><mrow><mi>h</mi><mo>⁢</mo><mi>e</mi><mo>⁢</mo><mi>a</mi><mo>⁢</mo><mi>d</mi></mrow></mrow></math></td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">2.</th>
<td class="ltx_td ltx_align_left">
<span class="ltx_text ltx_font_bold">if</span> <math id="S2.SS3.p3.m3" class="ltx_Math" alttext="L.head\neq NIL" display="inline"><mrow><mi>L</mi><mo>.</mo><mrow><mrow><mi>h</mi><mo>⁢</mo><mi>e</mi><mo>⁢</mo><mi>a</mi><mo>⁢</mo><mi>d</mi></mrow><mo>≠</mo><mrow><mi>N</mi><mo>⁢</mo><mi>I</mi><mo>⁢</mo><mi>L</mi></mrow></mrow></mrow></math>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">3.</th>
<td class="ltx_td ltx_align_left"> <math id="S2.SS3.p3.m4" class="ltx_Math" alttext="L.head.prev=x" display="inline"><mrow><mi>L</mi><mo>.</mo><mrow><mi>h</mi><mo>⁢</mo><mi>e</mi><mo>⁢</mo><mi>a</mi><mo>⁢</mo><mi>d</mi></mrow><mo>.</mo><mrow><mrow><mi>p</mi><mo>⁢</mo><mi>r</mi><mo>⁢</mo><mi>e</mi><mo>⁢</mo><mi>v</mi></mrow><mo>=</mo><mi>x</mi></mrow></mrow></math>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">4.</th>
<td class="ltx_td ltx_align_left"><math id="S2.SS3.p3.m5" class="ltx_Math" alttext="L.head=x" display="inline"><mrow><mi>L</mi><mo>.</mo><mrow><mrow><mi>h</mi><mo>⁢</mo><mi>e</mi><mo>⁢</mo><mi>a</mi><mo>⁢</mo><mi>d</mi></mrow><mo>=</mo><mi>x</mi></mrow></mrow></math></td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_bb">5.</th>
<td class="ltx_td ltx_align_left ltx_border_bb"><math id="S2.SS3.p3.m6" class="ltx_Math" alttext="x.prev=NIL" display="inline"><mrow><mi>x</mi><mo>.</mo><mrow><mrow><mi>p</mi><mo>⁢</mo><mi>r</mi><mo>⁢</mo><mi>e</mi><mo>⁢</mo><mi>v</mi></mrow><mo>=</mo><mrow><mi>N</mi><mo>⁢</mo><mi>I</mi><mo>⁢</mo><mi>L</mi></mrow></mrow></mrow></math></td>
</tr>
</tbody>
</table>
</div>
<div id="S2.SS3.p4" class="ltx_para ltx_align_center">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr class="ltx_tr">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" colspan="2"><span class="ltx_text ltx_font_smallcaps">List-Delete<math id="S2.SS3.p4.m1" class="ltx_Math" alttext="(L,x)" display="inline"><mrow><mo mathvariant="normal" stretchy="false">(</mo><mi>L</mi><mo mathvariant="normal">,</mo><mi>x</mi><mo mathvariant="normal" stretchy="false">)</mo></mrow></math></span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_t">1.</th>
<td class="ltx_td ltx_align_left ltx_border_t">
<span class="ltx_text ltx_font_bold">if</span> <math id="S2.SS3.p4.m2" class="ltx_Math" alttext="x.prev\neq NIL" display="inline"><mrow><mi>x</mi><mo>.</mo><mrow><mrow><mi>p</mi><mo>⁢</mo><mi>r</mi><mo>⁢</mo><mi>e</mi><mo>⁢</mo><mi>v</mi></mrow><mo>≠</mo><mrow><mi>N</mi><mo>⁢</mo><mi>I</mi><mo>⁢</mo><mi>L</mi></mrow></mrow></mrow></math>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">2.</th>
<td class="ltx_td ltx_align_left"> <math id="S2.SS3.p4.m3" class="ltx_Math" alttext="x.prev.next=x.next" display="inline"><mrow><mi>x</mi><mo>.</mo><mrow><mi>p</mi><mo>⁢</mo><mi>r</mi><mo>⁢</mo><mi>e</mi><mo>⁢</mo><mi>v</mi></mrow><mo>.</mo><mrow><mrow><mi>n</mi><mo>⁢</mo><mi>e</mi><mo>⁢</mo><mi>x</mi><mo>⁢</mo><mi>t</mi></mrow><mo>=</mo><mi>x</mi></mrow><mo>.</mo><mrow><mi>n</mi><mo>⁢</mo><mi>e</mi><mo>⁢</mo><mi>x</mi><mo>⁢</mo><mi>t</mi></mrow></mrow></math>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">3.</th>
<td class="ltx_td ltx_align_left">
<span class="ltx_text ltx_font_bold">else</span> <math id="S2.SS3.p4.m4" class="ltx_Math" alttext="L.head=x.next" display="inline"><mrow><mi>L</mi><mo>.</mo><mrow><mrow><mi>h</mi><mo>⁢</mo><mi>e</mi><mo>⁢</mo><mi>a</mi><mo>⁢</mo><mi>d</mi></mrow><mo>=</mo><mi>x</mi></mrow><mo>.</mo><mrow><mi>n</mi><mo>⁢</mo><mi>e</mi><mo>⁢</mo><mi>x</mi><mo>⁢</mo><mi>t</mi></mrow></mrow></math>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">4.</th>
<td class="ltx_td ltx_align_left">
<span class="ltx_text ltx_font_bold">if</span> <math id="S2.SS3.p4.m5" class="ltx_Math" alttext="x.next\neq NIL" display="inline"><mrow><mi>x</mi><mo>.</mo><mrow><mrow><mi>n</mi><mo>⁢</mo><mi>e</mi><mo>⁢</mo><mi>x</mi><mo>⁢</mo><mi>t</mi></mrow><mo>≠</mo><mrow><mi>N</mi><mo>⁢</mo><mi>I</mi><mo>⁢</mo><mi>L</mi></mrow></mrow></mrow></math>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_bb">5.</th>
<td class="ltx_td ltx_align_left ltx_border_bb"> <math id="S2.SS3.p4.m6" class="ltx_Math" alttext="x.next.prev=x.prev" display="inline"><mrow><mi>x</mi><mo>.</mo><mrow><mi>n</mi><mo>⁢</mo><mi>e</mi><mo>⁢</mo><mi>x</mi><mo>⁢</mo><mi>t</mi></mrow><mo>.</mo><mrow><mrow><mi>p</mi><mo>⁢</mo><mi>r</mi><mo>⁢</mo><mi>e</mi><mo>⁢</mo><mi>v</mi></mrow><mo>=</mo><mi>x</mi></mrow><mo>.</mo><mrow><mi>p</mi><mo>⁢</mo><mi>r</mi><mo>⁢</mo><mi>e</mi><mo>⁢</mo><mi>v</mi></mrow></mrow></math>
</td>
</tr>
</tbody>
</table>
</div>
</section>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Binary Search Trees</h2>

<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>General Binary Search Tree</h3>

<div id="S3.SS1.p1" class="ltx_para ltx_noindent">
<p class="ltx_p">A binary search tree is a binary tree in which for each node <math id="S3.SS1.p1.m1" class="ltx_Math" alttext="x" display="inline"><mi>x</mi></math>, the values of all the keys in the left subtree of <math id="S3.SS1.p1.m2" class="ltx_Math" alttext="x" display="inline"><mi>x</mi></math> are smaller than the key of <math id="S3.SS1.p1.m3" class="ltx_Math" alttext="x" display="inline"><mi>x</mi></math>, and the values of all the keys in the right subtree of <math id="S3.SS1.p1.m4" class="ltx_Math" alttext="x" display="inline"><mi>x</mi></math> are larger than the key of <math id="S3.SS1.p1.m5" class="ltx_Math" alttext="x" display="inline"><mi>x</mi></math>.</p>
</div>
<div id="S3.SS1.p2" class="ltx_para ltx_noindent">
<p class="ltx_p">Here are some properties of a binary search tree:</p>
<ul id="S3.I1" class="ltx_itemize">
<li id="S3.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S3.I1.i1.p1" class="ltx_para ltx_noindent">
<p class="ltx_p">The <span class="ltx_text ltx_font_bold">depth</span> of a node <math id="S3.I1.i1.p1.m1" class="ltx_Math" alttext="x" display="inline"><mi>x</mi></math> is the number of edges on the simple path from the root to <math id="S3.I1.i1.p1.m2" class="ltx_Math" alttext="x" display="inline"><mi>x</mi></math>. (Top Down)</p>
</div>
</li>
<li id="S3.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S3.I1.i2.p1" class="ltx_para ltx_noindent">
<p class="ltx_p">A level of a tree is all nodes at the same depth.</p>
</div>
</li>
<li id="S3.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S3.I1.i3.p1" class="ltx_para ltx_noindent">
<p class="ltx_p">The <span class="ltx_text ltx_font_bold">height</span> of a node <math id="S3.I1.i3.p1.m1" class="ltx_Math" alttext="x" display="inline"><mi>x</mi></math> is the number of edges on the longest simple downward path from <math id="S3.I1.i3.p1.m2" class="ltx_Math" alttext="x" display="inline"><mi>x</mi></math> to a leaf. (Bottom Up)</p>
</div>
</li>
<li id="S3.I1.i4" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S3.I1.i4.p1" class="ltx_para ltx_noindent">
<p class="ltx_p">The height of a tree is the height of the root.</p>
</div>
</li>
<li id="S3.I1.i5" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S3.I1.i5.p1" class="ltx_para ltx_noindent">
<p class="ltx_p">A binary search tree is <span class="ltx_text ltx_font_bold">full</span> if every node has either zero or two children.</p>
</div>
</li>
<li id="S3.I1.i6" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S3.I1.i6.p1" class="ltx_para ltx_noindent">
<p class="ltx_p">A binary search tree is <span class="ltx_text ltx_font_bold">complete</span> if it is full and all leaves are at the same level.
</p>
</div>
</li>
</ul>
</div>
<section id="S3.SS1.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.1.1 </span>Successor</h4>

<div id="S3.SS1.SSS1.p1" class="ltx_para ltx_noindent">
<p class="ltx_p">The successor of a node <math id="S3.SS1.SSS1.p1.m1" class="ltx_Math" alttext="x" display="inline"><mi>x</mi></math> is the node with the smallest key greater than <math id="S3.SS1.SSS1.p1.m2" class="ltx_Math" alttext="x.key" display="inline"><mrow><mi>x</mi><mo>.</mo><mrow><mi>k</mi><mo>⁢</mo><mi>e</mi><mo>⁢</mo><mi>y</mi></mrow></mrow></math>.
If a node has a right subtree, then its successor is the leftmost node in its right subtree.
If it does not, then its successor is the lowest ancestor of <math id="S3.SS1.SSS1.p1.m3" class="ltx_Math" alttext="x" display="inline"><mi>x</mi></math> whose left child is also an ancestor of <math id="S3.SS1.SSS1.p1.m4" class="ltx_Math" alttext="x" display="inline"><mi>x</mi></math>.
Or to say, to find the first “right parent” of <math id="S3.SS1.SSS1.p1.m5" class="ltx_Math" alttext="x" display="inline"><mi>x</mi></math>.
Notice how this algorithm produce <math id="S3.SS1.SSS1.p1.m6" class="ltx_Math" alttext="NIL" display="inline"><mrow><mi>N</mi><mo>⁢</mo><mi>I</mi><mo>⁢</mo><mi>L</mi></mrow></math> if <math id="S3.SS1.SSS1.p1.m7" class="ltx_Math" alttext="x" display="inline"><mi>x</mi></math> is the largest node.</p>
</div>
<div id="S3.SS1.SSS1.p2" class="ltx_para ltx_align_center">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr class="ltx_tr">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" colspan="2"><span class="ltx_text ltx_font_smallcaps">Tree-Successor<math id="S3.SS1.SSS1.p2.m1" class="ltx_Math" alttext="(x)" display="inline"><mrow><mo mathvariant="normal" stretchy="false">(</mo><mi>x</mi><mo mathvariant="normal" stretchy="false">)</mo></mrow></math></span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_t">1.</th>
<td class="ltx_td ltx_align_left ltx_border_t">
<span class="ltx_text ltx_font_bold">if</span> <math id="S3.SS1.SSS1.p2.m2" class="ltx_Math" alttext="x.right\neq NIL" display="inline"><mrow><mi>x</mi><mo>.</mo><mrow><mrow><mi>r</mi><mo>⁢</mo><mi>i</mi><mo>⁢</mo><mi>g</mi><mo>⁢</mo><mi>h</mi><mo>⁢</mo><mi>t</mi></mrow><mo>≠</mo><mrow><mi>N</mi><mo>⁢</mo><mi>I</mi><mo>⁢</mo><mi>L</mi></mrow></mrow></mrow></math>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">2.</th>
<td class="ltx_td ltx_align_left"> <span class="ltx_text ltx_font_bold">return</span> <span class="ltx_text ltx_font_smallcaps">Tree-Minimum<math id="S3.SS1.SSS1.p2.m3" class="ltx_Math" alttext="(x.right)" display="inline"><mrow><mo mathvariant="normal" stretchy="false">(</mo><mrow><mi>x</mi><mo mathvariant="normal">.</mo><mrow><mi>r</mi><mo class="ltx_font_smallcaps" mathvariant="normal">⁢</mo><mi>i</mi><mo class="ltx_font_smallcaps" mathvariant="normal">⁢</mo><mi>g</mi><mo class="ltx_font_smallcaps" mathvariant="normal">⁢</mo><mi>h</mi><mo class="ltx_font_smallcaps" mathvariant="normal">⁢</mo><mi>t</mi></mrow></mrow><mo mathvariant="normal" stretchy="false">)</mo></mrow></math></span>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">3.</th>
<td class="ltx_td ltx_align_left"><math id="S3.SS1.SSS1.p2.m4" class="ltx_Math" alttext="y=x.p" display="inline"><mrow><mrow><mi>y</mi><mo>=</mo><mi>x</mi></mrow><mo>.</mo><mi>p</mi></mrow></math></td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">4.</th>
<td class="ltx_td ltx_align_left">
<span class="ltx_text ltx_font_bold">while</span> <math id="S3.SS1.SSS1.p2.m5" class="ltx_Math" alttext="y\neq NIL" display="inline"><mrow><mi>y</mi><mo>≠</mo><mrow><mi>N</mi><mo>⁢</mo><mi>I</mi><mo>⁢</mo><mi>L</mi></mrow></mrow></math> and <math id="S3.SS1.SSS1.p2.m6" class="ltx_Math" alttext="x=y.right" display="inline"><mrow><mrow><mi>x</mi><mo>=</mo><mi>y</mi></mrow><mo>.</mo><mrow><mi>r</mi><mo>⁢</mo><mi>i</mi><mo>⁢</mo><mi>g</mi><mo>⁢</mo><mi>h</mi><mo>⁢</mo><mi>t</mi></mrow></mrow></math>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">5.</th>
<td class="ltx_td ltx_align_left"> <math id="S3.SS1.SSS1.p2.m7" class="ltx_Math" alttext="x=y" display="inline"><mrow><mi>x</mi><mo>=</mo><mi>y</mi></mrow></math>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">6.</th>
<td class="ltx_td ltx_align_left"> <math id="S3.SS1.SSS1.p2.m8" class="ltx_Math" alttext="y=y.p" display="inline"><mrow><mrow><mi>y</mi><mo>=</mo><mi>y</mi></mrow><mo>.</mo><mi>p</mi></mrow></math>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_bb">7.</th>
<td class="ltx_td ltx_align_left ltx_border_bb">
<span class="ltx_text ltx_font_bold">return</span> <math id="S3.SS1.SSS1.p2.m9" class="ltx_Math" alttext="y" display="inline"><mi>y</mi></math>
</td>
</tr>
</tbody>
</table>
</div>
<div id="S3.SS1.SSS1.p3" class="ltx_para ltx_noindent">
<p class="ltx_p">The predecessor can be found similarly.</p>
</div>
</section>
<section id="S3.SS1.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.1.2 </span>Insert</h4>

<div id="S3.SS1.SSS2.p1" class="ltx_para ltx_noindent">
<p class="ltx_p">Insertion is simple, we do binary search to find a position, and then simply append the new node.
Notice that we want to keep record of the parent of current node, so that we can find the new node’s parent.</p>
</div>
<div id="S3.SS1.SSS2.p2" class="ltx_para ltx_align_center">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr class="ltx_tr">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" colspan="2"><span class="ltx_text ltx_font_smallcaps">Tree-Insert<math id="S3.SS1.SSS2.p2.m1" class="ltx_Math" alttext="(T,z)" display="inline"><mrow><mo mathvariant="normal" stretchy="false">(</mo><mi>T</mi><mo mathvariant="normal">,</mo><mi>z</mi><mo mathvariant="normal" stretchy="false">)</mo></mrow></math></span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_t">1.</th>
<td class="ltx_td ltx_align_left ltx_border_t"><math id="S3.SS1.SSS2.p2.m2" class="ltx_Math" alttext="x=T.root" display="inline"><mrow><mrow><mi>x</mi><mo>=</mo><mi>T</mi></mrow><mo>.</mo><mrow><mi>r</mi><mo>⁢</mo><mi>o</mi><mo>⁢</mo><mi>o</mi><mo>⁢</mo><mi>t</mi></mrow></mrow></math></td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">2.</th>
<td class="ltx_td ltx_align_left"><math id="S3.SS1.SSS2.p2.m3" class="ltx_Math" alttext="y=NIL" display="inline"><mrow><mi>y</mi><mo>=</mo><mrow><mi>N</mi><mo>⁢</mo><mi>I</mi><mo>⁢</mo><mi>L</mi></mrow></mrow></math></td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">3.</th>
<td class="ltx_td ltx_align_left">
<span class="ltx_text ltx_font_bold">while</span> <math id="S3.SS1.SSS2.p2.m4" class="ltx_Math" alttext="x\neq NIL" display="inline"><mrow><mi>x</mi><mo>≠</mo><mrow><mi>N</mi><mo>⁢</mo><mi>I</mi><mo>⁢</mo><mi>L</mi></mrow></mrow></math>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">4.</th>
<td class="ltx_td ltx_align_left"> <math id="S3.SS1.SSS2.p2.m5" class="ltx_Math" alttext="y=x" display="inline"><mrow><mi>y</mi><mo>=</mo><mi>x</mi></mrow></math>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">5.</th>
<td class="ltx_td ltx_align_left"> <span class="ltx_text ltx_font_bold">if</span> <math id="S3.SS1.SSS2.p2.m6" class="ltx_Math" alttext="z.key&lt;x.key" display="inline"><mrow><mi>z</mi><mo>.</mo><mrow><mrow><mi>k</mi><mo>⁢</mo><mi>e</mi><mo>⁢</mo><mi>y</mi></mrow><mo>&lt;</mo><mi>x</mi></mrow><mo>.</mo><mrow><mi>k</mi><mo>⁢</mo><mi>e</mi><mo>⁢</mo><mi>y</mi></mrow></mrow></math>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">6.</th>
<td class="ltx_td ltx_align_left">  <math id="S3.SS1.SSS2.p2.m7" class="ltx_Math" alttext="x=x.left" display="inline"><mrow><mrow><mi>x</mi><mo>=</mo><mi>x</mi></mrow><mo>.</mo><mrow><mi>l</mi><mo>⁢</mo><mi>e</mi><mo>⁢</mo><mi>f</mi><mo>⁢</mo><mi>t</mi></mrow></mrow></math>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">7.</th>
<td class="ltx_td ltx_align_left"> <span class="ltx_text ltx_font_bold">else</span> <math id="S3.SS1.SSS2.p2.m8" class="ltx_Math" alttext="x=x.right" display="inline"><mrow><mrow><mi>x</mi><mo>=</mo><mi>x</mi></mrow><mo>.</mo><mrow><mi>r</mi><mo>⁢</mo><mi>i</mi><mo>⁢</mo><mi>g</mi><mo>⁢</mo><mi>h</mi><mo>⁢</mo><mi>t</mi></mrow></mrow></math>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">8.</th>
<td class="ltx_td ltx_align_left"><math id="S3.SS1.SSS2.p2.m9" class="ltx_Math" alttext="z.p=y" display="inline"><mrow><mi>z</mi><mo>.</mo><mrow><mi>p</mi><mo>=</mo><mi>y</mi></mrow></mrow></math></td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">9.</th>
<td class="ltx_td ltx_align_left">
<span class="ltx_text ltx_font_bold">if</span> <math id="S3.SS1.SSS2.p2.m10" class="ltx_Math" alttext="y=NIL" display="inline"><mrow><mi>y</mi><mo>=</mo><mrow><mi>N</mi><mo>⁢</mo><mi>I</mi><mo>⁢</mo><mi>L</mi></mrow></mrow></math>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">10.</th>
<td class="ltx_td ltx_align_left"> <math id="S3.SS1.SSS2.p2.m11" class="ltx_Math" alttext="T.root=z" display="inline"><mrow><mi>T</mi><mo>.</mo><mrow><mrow><mi>r</mi><mo>⁢</mo><mi>o</mi><mo>⁢</mo><mi>o</mi><mo>⁢</mo><mi>t</mi></mrow><mo>=</mo><mi>z</mi></mrow></mrow></math>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">11.</th>
<td class="ltx_td ltx_align_left">
<span class="ltx_text ltx_font_bold">else if</span> <math id="S3.SS1.SSS2.p2.m12" class="ltx_Math" alttext="z.key&lt;y.key" display="inline"><mrow><mi>z</mi><mo>.</mo><mrow><mrow><mi>k</mi><mo>⁢</mo><mi>e</mi><mo>⁢</mo><mi>y</mi></mrow><mo>&lt;</mo><mi>y</mi></mrow><mo>.</mo><mrow><mi>k</mi><mo>⁢</mo><mi>e</mi><mo>⁢</mo><mi>y</mi></mrow></mrow></math>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">12.</th>
<td class="ltx_td ltx_align_left"> <math id="S3.SS1.SSS2.p2.m13" class="ltx_Math" alttext="y.left=z" display="inline"><mrow><mi>y</mi><mo>.</mo><mrow><mrow><mi>l</mi><mo>⁢</mo><mi>e</mi><mo>⁢</mo><mi>f</mi><mo>⁢</mo><mi>t</mi></mrow><mo>=</mo><mi>z</mi></mrow></mrow></math>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_bb">13.</th>
<td class="ltx_td ltx_align_left ltx_border_bb">
<span class="ltx_text ltx_font_bold">else</span> <math id="S3.SS1.SSS2.p2.m14" class="ltx_Math" alttext="y.right=z" display="inline"><mrow><mi>y</mi><mo>.</mo><mrow><mrow><mi>r</mi><mo>⁢</mo><mi>i</mi><mo>⁢</mo><mi>g</mi><mo>⁢</mo><mi>h</mi><mo>⁢</mo><mi>t</mi></mrow><mo>=</mo><mi>z</mi></mrow></mrow></math>
</td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="S3.SS1.SSS3" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.1.3 </span>Delete</h4>

<div id="S3.SS1.SSS3.p1" class="ltx_para ltx_noindent">
<p class="ltx_p">Deletion is more complicated.
We need to consider multiple cases:</p>
<ol id="S3.I2" class="ltx_enumerate">
<li id="S3.I2.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1.</span> 
<div id="S3.I2.i1.p1" class="ltx_para ltx_noindent">
<p class="ltx_p">If <math id="S3.I2.i1.p1.m1" class="ltx_Math" alttext="z" display="inline"><mi>z</mi></math> is a leaf, we can simply remove it.</p>
</div>
</li>
<li id="S3.I2.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">2.</span> 
<div id="S3.I2.i2.p1" class="ltx_para ltx_noindent">
<p class="ltx_p">If <math id="S3.I2.i2.p1.m1" class="ltx_Math" alttext="z" display="inline"><mi>z</mi></math> has only one child, we replace <math id="S3.I2.i2.p1.m2" class="ltx_Math" alttext="z" display="inline"><mi>z</mi></math> with its child.</p>
</div>
</li>
<li id="S3.I2.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">3.</span> 
<div id="S3.I2.i3.p1" class="ltx_para ltx_noindent">
<p class="ltx_p">If <math id="S3.I2.i3.p1.m1" class="ltx_Math" alttext="z" display="inline"><mi>z</mi></math> has two children, we replace <math id="S3.I2.i3.p1.m2" class="ltx_Math" alttext="z" display="inline"><mi>z</mi></math> with its successor.
Why? Since the right subtree is not empty, the successor must be in the right subtree.
The successor cannot have a left child, otherwise the left child will be the successor.
Then we can replace <math id="S3.I2.i3.p1.m3" class="ltx_Math" alttext="z" display="inline"><mi>z</mi></math> with its successor, and then delete the successor (no left child makes it easy to delete).
Since the successor has the smallest key that is larger than <math id="S3.I2.i3.p1.m4" class="ltx_Math" alttext="z.key" display="inline"><mrow><mi>z</mi><mo>.</mo><mrow><mi>k</mi><mo>⁢</mo><mi>e</mi><mo>⁢</mo><mi>y</mi></mrow></mrow></math>, it is larger than all keys in the left subtree of <math id="S3.I2.i3.p1.m5" class="ltx_Math" alttext="z" display="inline"><mi>z</mi></math>, and smaller than all keys in the right subtree of <math id="S3.I2.i3.p1.m6" class="ltx_Math" alttext="z" display="inline"><mi>z</mi></math>.
Then the binary search tree property is maintained.</p>
</div>
</li>
</ol>
</div>
<div id="S3.SS1.SSS3.p2" class="ltx_para ltx_align_center">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr class="ltx_tr">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" colspan="2"><span class="ltx_text ltx_font_smallcaps">Tree-Delete<math id="S3.SS1.SSS3.p2.m1" class="ltx_Math" alttext="(T,z)" display="inline"><mrow><mo mathvariant="normal" stretchy="false">(</mo><mi>T</mi><mo mathvariant="normal">,</mo><mi>z</mi><mo mathvariant="normal" stretchy="false">)</mo></mrow></math></span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_t">1.</th>
<td class="ltx_td ltx_align_left ltx_border_t">
<span class="ltx_text ltx_font_bold">if</span> <math id="S3.SS1.SSS3.p2.m2" class="ltx_Math" alttext="z.left=NIL" display="inline"><mrow><mi>z</mi><mo>.</mo><mrow><mrow><mi>l</mi><mo>⁢</mo><mi>e</mi><mo>⁢</mo><mi>f</mi><mo>⁢</mo><mi>t</mi></mrow><mo>=</mo><mrow><mi>N</mi><mo>⁢</mo><mi>I</mi><mo>⁢</mo><mi>L</mi></mrow></mrow></mrow></math>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">2.</th>
<td class="ltx_td ltx_align_left"> <span class="ltx_text ltx_font_smallcaps">Transplant<math id="S3.SS1.SSS3.p2.m3" class="ltx_Math" alttext="(T,z,z.right)" display="inline"><mrow><mo mathvariant="normal" stretchy="false">(</mo><mrow><mrow><mi>T</mi><mo mathvariant="normal">,</mo><mi>z</mi><mo mathvariant="normal">,</mo><mi>z</mi></mrow><mo mathvariant="normal">.</mo><mrow><mi>r</mi><mo class="ltx_font_smallcaps" mathvariant="normal">⁢</mo><mi>i</mi><mo class="ltx_font_smallcaps" mathvariant="normal">⁢</mo><mi>g</mi><mo class="ltx_font_smallcaps" mathvariant="normal">⁢</mo><mi>h</mi><mo class="ltx_font_smallcaps" mathvariant="normal">⁢</mo><mi>t</mi></mrow></mrow><mo mathvariant="normal" stretchy="false">)</mo></mrow></math></span>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">3.</th>
<td class="ltx_td ltx_align_left">
<span class="ltx_text ltx_font_bold">else if</span> <math id="S3.SS1.SSS3.p2.m4" class="ltx_Math" alttext="z.right=NIL" display="inline"><mrow><mi>z</mi><mo>.</mo><mrow><mrow><mi>r</mi><mo>⁢</mo><mi>i</mi><mo>⁢</mo><mi>g</mi><mo>⁢</mo><mi>h</mi><mo>⁢</mo><mi>t</mi></mrow><mo>=</mo><mrow><mi>N</mi><mo>⁢</mo><mi>I</mi><mo>⁢</mo><mi>L</mi></mrow></mrow></mrow></math>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">4.</th>
<td class="ltx_td ltx_align_left"> <span class="ltx_text ltx_font_smallcaps">Transplant<math id="S3.SS1.SSS3.p2.m5" class="ltx_Math" alttext="(T,z,z.left)" display="inline"><mrow><mo mathvariant="normal" stretchy="false">(</mo><mrow><mrow><mi>T</mi><mo mathvariant="normal">,</mo><mi>z</mi><mo mathvariant="normal">,</mo><mi>z</mi></mrow><mo mathvariant="normal">.</mo><mrow><mi>l</mi><mo class="ltx_font_smallcaps" mathvariant="normal">⁢</mo><mi>e</mi><mo class="ltx_font_smallcaps" mathvariant="normal">⁢</mo><mi>f</mi><mo class="ltx_font_smallcaps" mathvariant="normal">⁢</mo><mi>t</mi></mrow></mrow><mo mathvariant="normal" stretchy="false">)</mo></mrow></math></span>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">5.</th>
<td class="ltx_td ltx_align_left"><span class="ltx_text ltx_font_bold">else</span></td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">6.</th>
<td class="ltx_td ltx_align_left"> <math id="S3.SS1.SSS3.p2.m6" class="ltx_Math" alttext="y=\textsc{Tree-Minimum}(z.right)" display="inline"><mrow><mi>y</mi><mo>=</mo><mtext class="ltx_font_smallcaps" mathvariant="normal">Tree-Minimum</mtext><mrow><mo stretchy="false">(</mo><mi>z</mi><mo>.</mo><mi>r</mi><mi>i</mi><mi>g</mi><mi>h</mi><mi>t</mi><mo stretchy="false">)</mo></mrow></mrow></math>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">7.</th>
<td class="ltx_td ltx_align_left"> <span class="ltx_text ltx_font_bold">if</span> <math id="S3.SS1.SSS3.p2.m7" class="ltx_Math" alttext="y.p\neq z" display="inline"><mrow><mi>y</mi><mo>.</mo><mrow><mi>p</mi><mo>≠</mo><mi>z</mi></mrow></mrow></math>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">8.</th>
<td class="ltx_td ltx_align_left">  <span class="ltx_text ltx_font_smallcaps">Transplant<math id="S3.SS1.SSS3.p2.m8" class="ltx_Math" alttext="(T,y,y.right)" display="inline"><mrow><mo mathvariant="normal" stretchy="false">(</mo><mrow><mrow><mi>T</mi><mo mathvariant="normal">,</mo><mi>y</mi><mo mathvariant="normal">,</mo><mi>y</mi></mrow><mo mathvariant="normal">.</mo><mrow><mi>r</mi><mo class="ltx_font_smallcaps" mathvariant="normal">⁢</mo><mi>i</mi><mo class="ltx_font_smallcaps" mathvariant="normal">⁢</mo><mi>g</mi><mo class="ltx_font_smallcaps" mathvariant="normal">⁢</mo><mi>h</mi><mo class="ltx_font_smallcaps" mathvariant="normal">⁢</mo><mi>t</mi></mrow></mrow><mo mathvariant="normal" stretchy="false">)</mo></mrow></math></span>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">9.</th>
<td class="ltx_td ltx_align_left">  <math id="S3.SS1.SSS3.p2.m9" class="ltx_Math" alttext="y.right=z.right" display="inline"><mrow><mi>y</mi><mo>.</mo><mrow><mrow><mi>r</mi><mo>⁢</mo><mi>i</mi><mo>⁢</mo><mi>g</mi><mo>⁢</mo><mi>h</mi><mo>⁢</mo><mi>t</mi></mrow><mo>=</mo><mi>z</mi></mrow><mo>.</mo><mrow><mi>r</mi><mo>⁢</mo><mi>i</mi><mo>⁢</mo><mi>g</mi><mo>⁢</mo><mi>h</mi><mo>⁢</mo><mi>t</mi></mrow></mrow></math>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">10.</th>
<td class="ltx_td ltx_align_left">  <math id="S3.SS1.SSS3.p2.m10" class="ltx_Math" alttext="y.right.p=y" display="inline"><mrow><mi>y</mi><mo>.</mo><mrow><mi>r</mi><mo>⁢</mo><mi>i</mi><mo>⁢</mo><mi>g</mi><mo>⁢</mo><mi>h</mi><mo>⁢</mo><mi>t</mi></mrow><mo>.</mo><mrow><mi>p</mi><mo>=</mo><mi>y</mi></mrow></mrow></math>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">11.</th>
<td class="ltx_td ltx_align_left"> <span class="ltx_text ltx_font_smallcaps">Transplant<math id="S3.SS1.SSS3.p2.m11" class="ltx_Math" alttext="(T,z,y)" display="inline"><mrow><mo mathvariant="normal" stretchy="false">(</mo><mi>T</mi><mo mathvariant="normal">,</mo><mi>z</mi><mo mathvariant="normal">,</mo><mi>y</mi><mo mathvariant="normal" stretchy="false">)</mo></mrow></math></span>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">12.</th>
<td class="ltx_td ltx_align_left"> <math id="S3.SS1.SSS3.p2.m12" class="ltx_Math" alttext="y.left=z.left" display="inline"><mrow><mi>y</mi><mo>.</mo><mrow><mrow><mi>l</mi><mo>⁢</mo><mi>e</mi><mo>⁢</mo><mi>f</mi><mo>⁢</mo><mi>t</mi></mrow><mo>=</mo><mi>z</mi></mrow><mo>.</mo><mrow><mi>l</mi><mo>⁢</mo><mi>e</mi><mo>⁢</mo><mi>f</mi><mo>⁢</mo><mi>t</mi></mrow></mrow></math>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_bb">13.</th>
<td class="ltx_td ltx_align_left ltx_border_bb"> <math id="S3.SS1.SSS3.p2.m13" class="ltx_Math" alttext="y.left.p=y" display="inline"><mrow><mi>y</mi><mo>.</mo><mrow><mi>l</mi><mo>⁢</mo><mi>e</mi><mo>⁢</mo><mi>f</mi><mo>⁢</mo><mi>t</mi></mrow><mo>.</mo><mrow><mi>p</mi><mo>=</mo><mi>y</mi></mrow></mrow></math>
</td>
</tr>
</tbody>
</table>
</div>
</section>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Tree Walk</h3>

<div id="S3.SS2.p1" class="ltx_para ltx_noindent">
<p class="ltx_p">There are three ways to walk a tree:</p>
<ol id="S3.I3" class="ltx_enumerate">
<li id="S3.I3.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1.</span> 
<div id="S3.I3.i1.p1" class="ltx_para ltx_noindent">
<p class="ltx_p">Preorder: root, left, right.</p>
</div>
</li>
<li id="S3.I3.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">2.</span> 
<div id="S3.I3.i2.p1" class="ltx_para ltx_noindent">
<p class="ltx_p">Inorder: left, root, right.</p>
</div>
</li>
<li id="S3.I3.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">3.</span> 
<div id="S3.I3.i3.p1" class="ltx_para ltx_noindent">
<p class="ltx_p">Postorder: left, right, root.</p>
</div>
</li>
</ol>
</div>
<div id="S3.SS2.p2" class="ltx_para ltx_noindent">
<p class="ltx_p">Since it takes <math id="S3.SS2.p2.m1" class="ltx_Math" alttext="\Theta(1)" display="inline"><mrow><mi mathvariant="normal">Θ</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></mrow></math> time to process each node, the runtime is <math id="S3.SS2.p2.m2" class="ltx_Math" alttext="\Theta(n)" display="inline"><mrow><mi mathvariant="normal">Θ</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></mrow></math>.</p>
</div>
<div id="S3.SS2.p3" class="ltx_para ltx_align_center">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr class="ltx_tr">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" colspan="2"><span class="ltx_text ltx_font_smallcaps">Inorder-Tree-Walk<math id="S3.SS2.p3.m1" class="ltx_Math" alttext="(x)" display="inline"><mrow><mo mathvariant="normal" stretchy="false">(</mo><mi>x</mi><mo mathvariant="normal" stretchy="false">)</mo></mrow></math></span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_t">1.</th>
<td class="ltx_td ltx_align_left ltx_border_t">
<span class="ltx_text ltx_font_bold">if</span> <math id="S3.SS2.p3.m2" class="ltx_Math" alttext="x\neq NIL" display="inline"><mrow><mi>x</mi><mo>≠</mo><mrow><mi>N</mi><mo>⁢</mo><mi>I</mi><mo>⁢</mo><mi>L</mi></mrow></mrow></math>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">2.</th>
<td class="ltx_td ltx_align_left"> <span class="ltx_text ltx_font_smallcaps">Inorder-Tree-Walk<math id="S3.SS2.p3.m3" class="ltx_Math" alttext="(x.left)" display="inline"><mrow><mo mathvariant="normal" stretchy="false">(</mo><mrow><mi>x</mi><mo mathvariant="normal">.</mo><mrow><mi>l</mi><mo class="ltx_font_smallcaps" mathvariant="normal">⁢</mo><mi>e</mi><mo class="ltx_font_smallcaps" mathvariant="normal">⁢</mo><mi>f</mi><mo class="ltx_font_smallcaps" mathvariant="normal">⁢</mo><mi>t</mi></mrow></mrow><mo mathvariant="normal" stretchy="false">)</mo></mrow></math></span>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">3.</th>
<td class="ltx_td ltx_align_left"> print <math id="S3.SS2.p3.m4" class="ltx_Math" alttext="x.key" display="inline"><mrow><mi>x</mi><mo>.</mo><mrow><mi>k</mi><mo>⁢</mo><mi>e</mi><mo>⁢</mo><mi>y</mi></mrow></mrow></math>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_bb">4.</th>
<td class="ltx_td ltx_align_left ltx_border_bb"> <span class="ltx_text ltx_font_smallcaps">Inorder-Tree-Walk<math id="S3.SS2.p3.m5" class="ltx_Math" alttext="(x.right)" display="inline"><mrow><mo mathvariant="normal" stretchy="false">(</mo><mrow><mi>x</mi><mo mathvariant="normal">.</mo><mrow><mi>r</mi><mo class="ltx_font_smallcaps" mathvariant="normal">⁢</mo><mi>i</mi><mo class="ltx_font_smallcaps" mathvariant="normal">⁢</mo><mi>g</mi><mo class="ltx_font_smallcaps" mathvariant="normal">⁢</mo><mi>h</mi><mo class="ltx_font_smallcaps" mathvariant="normal">⁢</mo><mi>t</mi></mrow></mrow><mo mathvariant="normal" stretchy="false">)</mo></mrow></math></span>
</td>
</tr>
</tbody>
</table>
</div>
<div id="S3.SS2.p4" class="ltx_para ltx_align_center">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr class="ltx_tr">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" colspan="2"><span class="ltx_text ltx_font_smallcaps">Preorder-Tree-Walk<math id="S3.SS2.p4.m1" class="ltx_Math" alttext="(x)" display="inline"><mrow><mo mathvariant="normal" stretchy="false">(</mo><mi>x</mi><mo mathvariant="normal" stretchy="false">)</mo></mrow></math></span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_t">1.</th>
<td class="ltx_td ltx_align_left ltx_border_t">
<span class="ltx_text ltx_font_bold">if</span> <math id="S3.SS2.p4.m2" class="ltx_Math" alttext="x\neq NIL" display="inline"><mrow><mi>x</mi><mo>≠</mo><mrow><mi>N</mi><mo>⁢</mo><mi>I</mi><mo>⁢</mo><mi>L</mi></mrow></mrow></math>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">2.</th>
<td class="ltx_td ltx_align_left"> print <math id="S3.SS2.p4.m3" class="ltx_Math" alttext="x.key" display="inline"><mrow><mi>x</mi><mo>.</mo><mrow><mi>k</mi><mo>⁢</mo><mi>e</mi><mo>⁢</mo><mi>y</mi></mrow></mrow></math>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">3.</th>
<td class="ltx_td ltx_align_left"> <span class="ltx_text ltx_font_smallcaps">Preorder-Tree-Walk<math id="S3.SS2.p4.m4" class="ltx_Math" alttext="(x.left)" display="inline"><mrow><mo mathvariant="normal" stretchy="false">(</mo><mrow><mi>x</mi><mo mathvariant="normal">.</mo><mrow><mi>l</mi><mo class="ltx_font_smallcaps" mathvariant="normal">⁢</mo><mi>e</mi><mo class="ltx_font_smallcaps" mathvariant="normal">⁢</mo><mi>f</mi><mo class="ltx_font_smallcaps" mathvariant="normal">⁢</mo><mi>t</mi></mrow></mrow><mo mathvariant="normal" stretchy="false">)</mo></mrow></math></span>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_bb">4.</th>
<td class="ltx_td ltx_align_left ltx_border_bb"> <span class="ltx_text ltx_font_smallcaps">Preorder-Tree-Walk<math id="S3.SS2.p4.m5" class="ltx_Math" alttext="(x.right)" display="inline"><mrow><mo mathvariant="normal" stretchy="false">(</mo><mrow><mi>x</mi><mo mathvariant="normal">.</mo><mrow><mi>r</mi><mo class="ltx_font_smallcaps" mathvariant="normal">⁢</mo><mi>i</mi><mo class="ltx_font_smallcaps" mathvariant="normal">⁢</mo><mi>g</mi><mo class="ltx_font_smallcaps" mathvariant="normal">⁢</mo><mi>h</mi><mo class="ltx_font_smallcaps" mathvariant="normal">⁢</mo><mi>t</mi></mrow></mrow><mo mathvariant="normal" stretchy="false">)</mo></mrow></math></span>
</td>
</tr>
</tbody>
</table>
</div>
<div id="S3.SS2.p5" class="ltx_para ltx_align_center">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr class="ltx_tr">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" colspan="2"><span class="ltx_text ltx_font_smallcaps">Postorder-Tree-Walk<math id="S3.SS2.p5.m1" class="ltx_Math" alttext="(x)" display="inline"><mrow><mo mathvariant="normal" stretchy="false">(</mo><mi>x</mi><mo mathvariant="normal" stretchy="false">)</mo></mrow></math></span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_t">1.</th>
<td class="ltx_td ltx_align_left ltx_border_t">
<span class="ltx_text ltx_font_bold">if</span> <math id="S3.SS2.p5.m2" class="ltx_Math" alttext="x\neq NIL" display="inline"><mrow><mi>x</mi><mo>≠</mo><mrow><mi>N</mi><mo>⁢</mo><mi>I</mi><mo>⁢</mo><mi>L</mi></mrow></mrow></math>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">2.</th>
<td class="ltx_td ltx_align_left"> <span class="ltx_text ltx_font_smallcaps">Postorder-Tree-Walk<math id="S3.SS2.p5.m3" class="ltx_Math" alttext="(x.left)" display="inline"><mrow><mo mathvariant="normal" stretchy="false">(</mo><mrow><mi>x</mi><mo mathvariant="normal">.</mo><mrow><mi>l</mi><mo class="ltx_font_smallcaps" mathvariant="normal">⁢</mo><mi>e</mi><mo class="ltx_font_smallcaps" mathvariant="normal">⁢</mo><mi>f</mi><mo class="ltx_font_smallcaps" mathvariant="normal">⁢</mo><mi>t</mi></mrow></mrow><mo mathvariant="normal" stretchy="false">)</mo></mrow></math></span>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">3.</th>
<td class="ltx_td ltx_align_left"> <span class="ltx_text ltx_font_smallcaps">Postorder-Tree-Walk<math id="S3.SS2.p5.m4" class="ltx_Math" alttext="(x.right)" display="inline"><mrow><mo mathvariant="normal" stretchy="false">(</mo><mrow><mi>x</mi><mo mathvariant="normal">.</mo><mrow><mi>r</mi><mo class="ltx_font_smallcaps" mathvariant="normal">⁢</mo><mi>i</mi><mo class="ltx_font_smallcaps" mathvariant="normal">⁢</mo><mi>g</mi><mo class="ltx_font_smallcaps" mathvariant="normal">⁢</mo><mi>h</mi><mo class="ltx_font_smallcaps" mathvariant="normal">⁢</mo><mi>t</mi></mrow></mrow><mo mathvariant="normal" stretchy="false">)</mo></mrow></math></span>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_bb">4.</th>
<td class="ltx_td ltx_align_left ltx_border_bb"> print <math id="S3.SS2.p5.m5" class="ltx_Math" alttext="x.key" display="inline"><mrow><mi>x</mi><mo>.</mo><mrow><mi>k</mi><mo>⁢</mo><mi>e</mi><mo>⁢</mo><mi>y</mi></mrow></mrow></math>
</td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="S3.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>AVL Trees</h3>

<div id="S3.SS3.p1" class="ltx_para ltx_noindent">
<p class="ltx_p">A binary search tree can be unbalanced and degenerate into a linked list, which makes it inefficient.
An AVL tree is a self-balancing binary search tree.
It requires that the heights of the two child subtrees of any node differ by at most 1.
This can be implemented by adding a balance factor to each node.</p>
</div>
<div id="S3.SS3.p2" class="ltx_para ltx_noindent">
<p class="ltx_p">An AVL tree with <math id="S3.SS3.p2.m1" class="ltx_Math" alttext="n" display="inline"><mi>n</mi></math> nodes has at most height <math id="S3.SS3.p2.m2" class="ltx_Math" alttext="1.44\log n" display="inline"><mrow><mn>1.44</mn><mo>⁢</mo><mrow><mi>log</mi><mo>⁡</mo><mi>n</mi></mrow></mrow></math>, which is pretty close to the optimal height <math id="S3.SS3.p2.m3" class="ltx_Math" alttext="\log n" display="inline"><mrow><mi>log</mi><mo>⁡</mo><mi>n</mi></mrow></math>.
</p>
</div>
<section id="S3.SS3.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.3.1 </span>Minimum Number of Nodes in AVL Tree</h4>

<div id="S3.SS3.SSS1.p1" class="ltx_para ltx_noindent">
<p class="ltx_p">Consider the minimal number of nodes in an AVL tree of height <math id="S3.SS3.SSS1.p1.m1" class="ltx_Math" alttext="h" display="inline"><mi>h</mi></math>.
We have:</p>
<table id="S3.Ex2" class="ltx_equation ltx_eqn_table">

<tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.Ex2.m1" class="ltx_Math" alttext="N(h)=N(h-1)+N(h-2)+1" display="block"><mrow><mrow><mi>N</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>h</mi><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><mrow><mi>N</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mi>h</mi><mo>-</mo><mn>1</mn></mrow><mo stretchy="false">)</mo></mrow></mrow><mo>+</mo><mrow><mi>N</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mi>h</mi><mo>-</mo><mn>2</mn></mrow><mo stretchy="false">)</mo></mrow></mrow><mo>+</mo><mn>1</mn></mrow></mrow></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</table>
<p class="ltx_p">This can be interpreted as: to find the minimal tree of height <math id="S3.SS3.SSS1.p1.m2" class="ltx_Math" alttext="h" display="inline"><mi>h</mi></math>, we split the AVL tree into three parts: the root, the left subtree of height <math id="S3.SS3.SSS1.p1.m3" class="ltx_Math" alttext="h-1" display="inline"><mrow><mi>h</mi><mo>-</mo><mn>1</mn></mrow></math>, and the right subtree of height <math id="S3.SS3.SSS1.p1.m4" class="ltx_Math" alttext="h-2" display="inline"><mrow><mi>h</mi><mo>-</mo><mn>2</mn></mrow></math>.
For the root, it satisfies the AVL property, since the height of the left subtree and the right subtree differ by 1.
For the two subtrees, to make the number of nodes minimal, they must be the minimal AVL trees of height <math id="S3.SS3.SSS1.p1.m5" class="ltx_Math" alttext="h-1" display="inline"><mrow><mi>h</mi><mo>-</mo><mn>1</mn></mrow></math> and <math id="S3.SS3.SSS1.p1.m6" class="ltx_Math" alttext="h-2" display="inline"><mrow><mi>h</mi><mo>-</mo><mn>2</mn></mrow></math>.</p>
</div>
<div id="S3.SS3.SSS1.p2" class="ltx_para ltx_noindent">
<p class="ltx_p">This number is related to the Fibonacci sequence, and we have <math id="S3.SS3.SSS1.p2.m1" class="ltx_Math" alttext="N(h)=F_{h+2}-1" display="inline"><mrow><mrow><mi>N</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>h</mi><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><msub><mi>F</mi><mrow><mi>h</mi><mo>+</mo><mn>2</mn></mrow></msub><mo>-</mo><mn>1</mn></mrow></mrow></math> (assume the Fibonacci sequence starts with <math id="S3.SS3.SSS1.p2.m2" class="ltx_Math" alttext="F_{0}=F_{1}=1" display="inline"><mrow><msub><mi>F</mi><mn>0</mn></msub><mo>=</mo><msub><mi>F</mi><mn>1</mn></msub><mo>=</mo><mn>1</mn></mrow></math>).</p>
</div>
</section>
<section id="S3.SS3.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.3.2 </span>Insertion</h4>

<div id="S3.SS3.SSS2.p1" class="ltx_para ltx_noindent">
<p class="ltx_p"><span class="ltx_text ltx_font_bold">Runtime:</span>
<math id="S3.SS3.SSS2.p1.m1" class="ltx_Math" alttext="O(\log n)" display="inline"><mrow><mi>O</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mi>log</mi><mo>⁡</mo><mi>n</mi></mrow><mo stretchy="false">)</mo></mrow></mrow></math>.</p>
</div>
<div id="S3.SS3.SSS2.p2" class="ltx_para ltx_noindent">
<p class="ltx_p">Firstly, we need to define the balance factor of a node <math id="S3.SS3.SSS2.p2.m1" class="ltx_Math" alttext="x" display="inline"><mi>x</mi></math>:</p>
<table id="S3.Ex3" class="ltx_equation ltx_eqn_table">

<tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.Ex3.m1" class="ltx_Math" alttext="bal(x)=height(x.left)-height(x.right)" display="block"><mrow><mi>b</mi><mi>a</mi><mi>l</mi><mrow><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><mo>=</mo><mi>h</mi><mi>e</mi><mi>i</mi><mi>g</mi><mi>h</mi><mi>t</mi><mrow><mo stretchy="false">(</mo><mi>x</mi><mo>.</mo><mi>l</mi><mi>e</mi><mi>f</mi><mi>t</mi><mo stretchy="false">)</mo></mrow><mo>-</mo><mi>h</mi><mi>e</mi><mi>i</mi><mi>g</mi><mi>h</mi><mi>t</mi><mrow><mo stretchy="false">(</mo><mi>x</mi><mo>.</mo><mi>r</mi><mi>i</mi><mi>g</mi><mi>h</mi><mi>t</mi><mo stretchy="false">)</mo></mrow></mrow></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</table>
</div>
<div id="S3.SS3.SSS2.p3" class="ltx_para ltx_noindent">
<p class="ltx_p">Without loss of generality, we assume the insertion inserts a node into the right subtree.
We use <math id="S3.SS3.SSS2.p3.m1" class="ltx_Math" alttext="v" display="inline"><mi>v</mi></math> to denote the node on the path from the inserted node to the root, and <math id="S3.SS3.SSS2.p3.m2" class="ltx_Math" alttext="x" display="inline"><mi>x</mi></math> to denote the right child of <math id="S3.SS3.SSS2.p3.m3" class="ltx_Math" alttext="v" display="inline"><mi>v</mi></math>.
Here are the cases:</p>
</div>
<div id="S3.SS3.SSS2.p4" class="ltx_para ltx_noindent">
<p class="ltx_p"><span class="ltx_text ltx_font_bold">Case 1:</span>
<math id="S3.SS3.SSS2.p4.m1" class="ltx_Math" alttext="bal(v)=1" display="inline"><mrow><mrow><mi>b</mi><mo>⁢</mo><mi>a</mi><mo>⁢</mo><mi>l</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mn>1</mn></mrow></math>.
After insertion, <math id="S3.SS3.SSS2.p4.m2" class="ltx_Math" alttext="bal(v)=0" display="inline"><mrow><mrow><mi>b</mi><mo>⁢</mo><mi>a</mi><mo>⁢</mo><mi>l</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mn>0</mn></mrow></math>.
The height of <math id="S3.SS3.SSS2.p4.m3" class="ltx_Math" alttext="v" display="inline"><mi>v</mi></math> does not change, so we can stop.</p>
</div>
<div id="S3.SS3.SSS2.p5" class="ltx_para ltx_noindent">
<p class="ltx_p"><span class="ltx_text ltx_font_bold">Case 2:</span>
<math id="S3.SS3.SSS2.p5.m1" class="ltx_Math" alttext="bal(v)=0" display="inline"><mrow><mrow><mi>b</mi><mo>⁢</mo><mi>a</mi><mo>⁢</mo><mi>l</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mn>0</mn></mrow></math>.
After insertion, <math id="S3.SS3.SSS2.p5.m2" class="ltx_Math" alttext="bal(v)=-1" display="inline"><mrow><mrow><mi>b</mi><mo>⁢</mo><mi>a</mi><mo>⁢</mo><mi>l</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><mo>-</mo><mn>1</mn></mrow></mrow></math>.
The height of <math id="S3.SS3.SSS2.p5.m3" class="ltx_Math" alttext="v" display="inline"><mi>v</mi></math> increases by 1, so we need to check the parent of <math id="S3.SS3.SSS2.p5.m4" class="ltx_Math" alttext="v" display="inline"><mi>v</mi></math>, so we run the algorithm recursively.</p>
</div>
<div id="S3.SS3.SSS2.p6" class="ltx_para ltx_noindent">
<p class="ltx_p"><span class="ltx_text ltx_font_bold">Case 3:</span>
<math id="S3.SS3.SSS2.p6.m1" class="ltx_Math" alttext="bal(v)=-1" display="inline"><mrow><mrow><mi>b</mi><mo>⁢</mo><mi>a</mi><mo>⁢</mo><mi>l</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><mo>-</mo><mn>1</mn></mrow></mrow></math>.
After insertion, <math id="S3.SS3.SSS2.p6.m2" class="ltx_Math" alttext="bal(v)=-2" display="inline"><mrow><mrow><mi>b</mi><mo>⁢</mo><mi>a</mi><mo>⁢</mo><mi>l</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><mo>-</mo><mn>2</mn></mrow></mrow></math>.
We need to do a rotation to make <math id="S3.SS3.SSS2.p6.m3" class="ltx_Math" alttext="v" display="inline"><mi>v</mi></math> balanced.</p>
</div>
<div id="S3.SS3.SSS2.p7" class="ltx_para ltx_noindent">
<p class="ltx_p"><span class="ltx_text ltx_font_bold">Subcase 3.1:</span>
The inserted node is in the right subtree of <math id="S3.SS3.SSS2.p7.m1" class="ltx_Math" alttext="x" display="inline"><mi>x</mi></math>.
We do a left rotation on <math id="S3.SS3.SSS2.p7.m2" class="ltx_Math" alttext="v" display="inline"><mi>v</mi></math>.
After the rotation, <math id="S3.SS3.SSS2.p7.m3" class="ltx_Math" alttext="v" display="inline"><mi>v</mi></math> becomes the left child of <math id="S3.SS3.SSS2.p7.m4" class="ltx_Math" alttext="x" display="inline"><mi>x</mi></math>.
We then update the balance factor of <math id="S3.SS3.SSS2.p7.m5" class="ltx_Math" alttext="v" display="inline"><mi>v</mi></math> and <math id="S3.SS3.SSS2.p7.m6" class="ltx_Math" alttext="x" display="inline"><mi>x</mi></math>: <math id="S3.SS3.SSS2.p7.m7" class="ltx_Math" alttext="bal(v)=0" display="inline"><mrow><mrow><mi>b</mi><mo>⁢</mo><mi>a</mi><mo>⁢</mo><mi>l</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mn>0</mn></mrow></math>, <math id="S3.SS3.SSS2.p7.m8" class="ltx_Math" alttext="bal(x)=0" display="inline"><mrow><mrow><mi>b</mi><mo>⁢</mo><mi>a</mi><mo>⁢</mo><mi>l</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mn>0</mn></mrow></math>.
Since the height of <math id="S3.SS3.SSS2.p7.m9" class="ltx_Math" alttext="v" display="inline"><mi>v</mi></math> does not change, we can stop.</p>
</div>
<div id="S3.SS3.SSS2.p8" class="ltx_para ltx_noindent">
<p class="ltx_p"><span class="ltx_text ltx_font_bold">Subcase 3.2:</span>
The inserted node is in the left subtree of <math id="S3.SS3.SSS2.p8.m1" class="ltx_Math" alttext="x" display="inline"><mi>x</mi></math>.
Let <math id="S3.SS3.SSS2.p8.m2" class="ltx_Math" alttext="w" display="inline"><mi>w</mi></math> denote the left child of <math id="S3.SS3.SSS2.p8.m3" class="ltx_Math" alttext="x" display="inline"><mi>x</mi></math>.
We can find <math id="S3.SS3.SSS2.p8.m4" class="ltx_Math" alttext="v" display="inline"><mi>v</mi></math>, <math id="S3.SS3.SSS2.p8.m5" class="ltx_Math" alttext="x" display="inline"><mi>x</mi></math>, and <math id="S3.SS3.SSS2.p8.m6" class="ltx_Math" alttext="w" display="inline"><mi>w</mi></math> form a zig-zag pattern.
We do a right rotation on <math id="S3.SS3.SSS2.p8.m7" class="ltx_Math" alttext="x" display="inline"><mi>x</mi></math>, and then a left rotation on <math id="S3.SS3.SSS2.p8.m8" class="ltx_Math" alttext="v" display="inline"><mi>v</mi></math>.
After the rotation, <math id="S3.SS3.SSS2.p8.m9" class="ltx_Math" alttext="v" display="inline"><mi>v</mi></math> becomes the left child of <math id="S3.SS3.SSS2.p8.m10" class="ltx_Math" alttext="w" display="inline"><mi>w</mi></math>, and <math id="S3.SS3.SSS2.p8.m11" class="ltx_Math" alttext="x" display="inline"><mi>x</mi></math> becomes the right child of <math id="S3.SS3.SSS2.p8.m12" class="ltx_Math" alttext="w" display="inline"><mi>w</mi></math>.
We then update the balance factor of <math id="S3.SS3.SSS2.p8.m13" class="ltx_Math" alttext="v" display="inline"><mi>v</mi></math>, <math id="S3.SS3.SSS2.p8.m14" class="ltx_Math" alttext="x" display="inline"><mi>x</mi></math>, and <math id="S3.SS3.SSS2.p8.m15" class="ltx_Math" alttext="w" display="inline"><mi>w</mi></math>:</p>
<ul id="S3.I4" class="ltx_itemize">
<li id="S3.I4.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S3.I4.i1.p1" class="ltx_para ltx_noindent">
<p class="ltx_p">If <math id="S3.I4.i1.p1.m1" class="ltx_Math" alttext="bal(w)" display="inline"><mrow><mi>b</mi><mo>⁢</mo><mi>a</mi><mo>⁢</mo><mi>l</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>w</mi><mo stretchy="false">)</mo></mrow></mrow></math> was 0, then <math id="S3.I4.i1.p1.m2" class="ltx_Math" alttext="bal(v)=0" display="inline"><mrow><mrow><mi>b</mi><mo>⁢</mo><mi>a</mi><mo>⁢</mo><mi>l</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mn>0</mn></mrow></math>, <math id="S3.I4.i1.p1.m3" class="ltx_Math" alttext="bal(x)=0" display="inline"><mrow><mrow><mi>b</mi><mo>⁢</mo><mi>a</mi><mo>⁢</mo><mi>l</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mn>0</mn></mrow></math>, <math id="S3.I4.i1.p1.m4" class="ltx_Math" alttext="bal(w)=0" display="inline"><mrow><mrow><mi>b</mi><mo>⁢</mo><mi>a</mi><mo>⁢</mo><mi>l</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>w</mi><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mn>0</mn></mrow></math>.</p>
</div>
</li>
<li id="S3.I4.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S3.I4.i2.p1" class="ltx_para ltx_noindent">
<p class="ltx_p">If <math id="S3.I4.i2.p1.m1" class="ltx_Math" alttext="bal(w)" display="inline"><mrow><mi>b</mi><mo>⁢</mo><mi>a</mi><mo>⁢</mo><mi>l</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>w</mi><mo stretchy="false">)</mo></mrow></mrow></math> was 1, then <math id="S3.I4.i2.p1.m2" class="ltx_Math" alttext="bal(v)=0" display="inline"><mrow><mrow><mi>b</mi><mo>⁢</mo><mi>a</mi><mo>⁢</mo><mi>l</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mn>0</mn></mrow></math>, <math id="S3.I4.i2.p1.m3" class="ltx_Math" alttext="bal(x)=-1" display="inline"><mrow><mrow><mi>b</mi><mo>⁢</mo><mi>a</mi><mo>⁢</mo><mi>l</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><mo>-</mo><mn>1</mn></mrow></mrow></math>, <math id="S3.I4.i2.p1.m4" class="ltx_Math" alttext="bal(w)=0" display="inline"><mrow><mrow><mi>b</mi><mo>⁢</mo><mi>a</mi><mo>⁢</mo><mi>l</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>w</mi><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mn>0</mn></mrow></math>.</p>
</div>
</li>
<li id="S3.I4.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S3.I4.i3.p1" class="ltx_para ltx_noindent">
<p class="ltx_p">If <math id="S3.I4.i3.p1.m1" class="ltx_Math" alttext="bal(w)" display="inline"><mrow><mi>b</mi><mo>⁢</mo><mi>a</mi><mo>⁢</mo><mi>l</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>w</mi><mo stretchy="false">)</mo></mrow></mrow></math> was -1, then <math id="S3.I4.i3.p1.m2" class="ltx_Math" alttext="bal(v)=1" display="inline"><mrow><mrow><mi>b</mi><mo>⁢</mo><mi>a</mi><mo>⁢</mo><mi>l</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mn>1</mn></mrow></math>, <math id="S3.I4.i3.p1.m3" class="ltx_Math" alttext="bal(x)=0" display="inline"><mrow><mrow><mi>b</mi><mo>⁢</mo><mi>a</mi><mo>⁢</mo><mi>l</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mn>0</mn></mrow></math>, <math id="S3.I4.i3.p1.m4" class="ltx_Math" alttext="bal(w)=0" display="inline"><mrow><mrow><mi>b</mi><mo>⁢</mo><mi>a</mi><mo>⁢</mo><mi>l</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>w</mi><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mn>0</mn></mrow></math>.</p>
</div>
</li>
</ul>
</div>
</section>
<section id="S3.SS3.SSS3" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.3.3 </span>Deletion</h4>

<div id="S3.SS3.SSS3.p1" class="ltx_para ltx_noindent">
<p class="ltx_p"><span class="ltx_text ltx_font_bold">Runtime:</span>
<math id="S3.SS3.SSS3.p1.m1" class="ltx_Math" alttext="O(\log n)" display="inline"><mrow><mi>O</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mi>log</mi><mo>⁡</mo><mi>n</mi></mrow><mo stretchy="false">)</mo></mrow></mrow></math>.</p>
</div>
<div id="S3.SS3.SSS3.p2" class="ltx_para ltx_noindent">
<p class="ltx_p">Deletion is similar to insertion.</p>
</div>
<div id="S3.SS3.SSS3.p3" class="ltx_para ltx_noindent">
<p class="ltx_p">Without loss of generality, we assume the deletion deletes a node from the left subtree.
We also need to consider three cases:</p>
</div>
<div id="S3.SS3.SSS3.p4" class="ltx_para ltx_noindent">
<p class="ltx_p"><span class="ltx_text ltx_font_bold">Case 1:</span>
<math id="S3.SS3.SSS3.p4.m1" class="ltx_Math" alttext="bal(v)=1" display="inline"><mrow><mrow><mi>b</mi><mo>⁢</mo><mi>a</mi><mo>⁢</mo><mi>l</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mn>1</mn></mrow></math>.
After deletion, <math id="S3.SS3.SSS3.p4.m2" class="ltx_Math" alttext="bal(v)=0" display="inline"><mrow><mrow><mi>b</mi><mo>⁢</mo><mi>a</mi><mo>⁢</mo><mi>l</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mn>0</mn></mrow></math>.
The height of <math id="S3.SS3.SSS3.p4.m3" class="ltx_Math" alttext="v" display="inline"><mi>v</mi></math> decreases by 1, so we need to check the parent of <math id="S3.SS3.SSS3.p4.m4" class="ltx_Math" alttext="v" display="inline"><mi>v</mi></math>, so we run the algorithm recursively.</p>
</div>
<div id="S3.SS3.SSS3.p5" class="ltx_para ltx_noindent">
<p class="ltx_p"><span class="ltx_text ltx_font_bold">Case 2:</span>
<math id="S3.SS3.SSS3.p5.m1" class="ltx_Math" alttext="bal(v)=0" display="inline"><mrow><mrow><mi>b</mi><mo>⁢</mo><mi>a</mi><mo>⁢</mo><mi>l</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mn>0</mn></mrow></math>.
After deletion, <math id="S3.SS3.SSS3.p5.m2" class="ltx_Math" alttext="bal(v)=1" display="inline"><mrow><mrow><mi>b</mi><mo>⁢</mo><mi>a</mi><mo>⁢</mo><mi>l</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mn>1</mn></mrow></math>.
The height of <math id="S3.SS3.SSS3.p5.m3" class="ltx_Math" alttext="v" display="inline"><mi>v</mi></math> does not change, so we can stop.</p>
</div>
<div id="S3.SS3.SSS3.p6" class="ltx_para ltx_noindent">
<p class="ltx_p"><span class="ltx_text ltx_font_bold">Case 3:</span>
<math id="S3.SS3.SSS3.p6.m1" class="ltx_Math" alttext="bal(v)=-1" display="inline"><mrow><mrow><mi>b</mi><mo>⁢</mo><mi>a</mi><mo>⁢</mo><mi>l</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><mo>-</mo><mn>1</mn></mrow></mrow></math>.
After deletion, <math id="S3.SS3.SSS3.p6.m2" class="ltx_Math" alttext="bal(v)=-2" display="inline"><mrow><mrow><mi>b</mi><mo>⁢</mo><mi>a</mi><mo>⁢</mo><mi>l</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><mo>-</mo><mn>2</mn></mrow></mrow></math>.
We need to do a rotation to make <math id="S3.SS3.SSS3.p6.m3" class="ltx_Math" alttext="v" display="inline"><mi>v</mi></math> balanced.</p>
</div>
<div id="S3.SS3.SSS3.p7" class="ltx_para ltx_noindent">
<p class="ltx_p"><span class="ltx_text ltx_font_bold">Subcase 3.1:</span>
<math id="S3.SS3.SSS3.p7.m1" class="ltx_Math" alttext="bal(x)\in\{0,-1\}" display="inline"><mrow><mrow><mi>b</mi><mo>⁢</mo><mi>a</mi><mo>⁢</mo><mi>l</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></mrow><mo>∈</mo><mrow><mo stretchy="false">{</mo><mn>0</mn><mo>,</mo><mrow><mo>-</mo><mn>1</mn></mrow><mo stretchy="false">}</mo></mrow></mrow></math>.
The deleted node is in the left subtree of <math id="S3.SS3.SSS3.p7.m2" class="ltx_Math" alttext="v" display="inline"><mi>v</mi></math>.
We do a left rotation on <math id="S3.SS3.SSS3.p7.m3" class="ltx_Math" alttext="v" display="inline"><mi>v</mi></math>.
After the rotation, <math id="S3.SS3.SSS3.p7.m4" class="ltx_Math" alttext="v" display="inline"><mi>v</mi></math> becomes the left child of <math id="S3.SS3.SSS3.p7.m5" class="ltx_Math" alttext="x" display="inline"><mi>x</mi></math>.
It depends on the balance factor of <math id="S3.SS3.SSS3.p7.m6" class="ltx_Math" alttext="x" display="inline"><mi>x</mi></math> to decide whether we can stop.</p>
</div>
<div id="S3.SS3.SSS3.p8" class="ltx_para ltx_noindent">
<p class="ltx_p"><span class="ltx_text ltx_font_bold">Subcase 3.2:</span>
<math id="S3.SS3.SSS3.p8.m1" class="ltx_Math" alttext="bal(x)=1" display="inline"><mrow><mrow><mi>b</mi><mo>⁢</mo><mi>a</mi><mo>⁢</mo><mi>l</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mn>1</mn></mrow></math>.
The deleted node is in the left subtree of <math id="S3.SS3.SSS3.p8.m2" class="ltx_Math" alttext="v" display="inline"><mi>v</mi></math>.
Let <math id="S3.SS3.SSS3.p8.m3" class="ltx_Math" alttext="w" display="inline"><mi>w</mi></math> denote the left child of <math id="S3.SS3.SSS3.p8.m4" class="ltx_Math" alttext="x" display="inline"><mi>x</mi></math>.
We do a right rotation on <math id="S3.SS3.SSS3.p8.m5" class="ltx_Math" alttext="x" display="inline"><mi>x</mi></math>, and then a left rotation on <math id="S3.SS3.SSS3.p8.m6" class="ltx_Math" alttext="v" display="inline"><mi>v</mi></math>.
After the rotation, <math id="S3.SS3.SSS3.p8.m7" class="ltx_Math" alttext="v" display="inline"><mi>v</mi></math> becomes the left child of <math id="S3.SS3.SSS3.p8.m8" class="ltx_Math" alttext="w" display="inline"><mi>w</mi></math>, and <math id="S3.SS3.SSS3.p8.m9" class="ltx_Math" alttext="x" display="inline"><mi>x</mi></math> becomes the right child of <math id="S3.SS3.SSS3.p8.m10" class="ltx_Math" alttext="w" display="inline"><mi>w</mi></math>.
The height of <math id="S3.SS3.SSS3.p8.m11" class="ltx_Math" alttext="v" display="inline"><mi>v</mi></math> is decreased by 1, so we run the algorithm recursively.</p>
</div>
<div id="S3.SS3.SSS3.p9" class="ltx_para ltx_noindent">
<p class="ltx_p">It should be noted that if the deleted operation involves finding the successor, then we need to update the balance factor from the successor’s parent.</p>
</div>
</section>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Dynamic Programming</h2>

<div id="S4.p1" class="ltx_para ltx_noindent">
<p class="ltx_p">When we want to solve a problem recursively, we may find that some subproblems are solved repeatedly.
For example in the Fibonacci sequence, many numbers are calculated repeatedly.
So instead of solving the subproblems repeatedly, we can store the solutions in a table, and then use the table to solve the problem.</p>
</div>
<div id="S4.p2" class="ltx_para ltx_noindent">
<p class="ltx_p">To implement dynamic programming, we often need the problem to be <span class="ltx_text ltx_font_bold">optimal substructure</span> and <span class="ltx_text ltx_font_bold">overlapping subproblems</span>.</p>
<ul id="S4.I1" class="ltx_itemize">
<li id="S4.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S4.I1.i1.p1" class="ltx_para ltx_noindent">
<p class="ltx_p">Optimal substructure: The solution to the subproblem used within the optimal solution must be optimal.</p>
</div>
</li>
<li id="S4.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S4.I1.i2.p1" class="ltx_para ltx_noindent">
<p class="ltx_p">Overlapping subproblems: the problem can be broken down into subproblems which are reused several times.</p>
</div>
</li>
</ul>
</div>
<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Rod Cutting</h3>

<div id="S4.SS1.p1" class="ltx_para ltx_noindent">
<p class="ltx_p">Given a rod of length <math id="S4.SS1.p1.m1" class="ltx_Math" alttext="n" display="inline"><mi>n</mi></math> and a table of prices <math id="S4.SS1.p1.m2" class="ltx_Math" alttext="p_{i}" display="inline"><msub><mi>p</mi><mi>i</mi></msub></math> for the rod of length <math id="S4.SS1.p1.m3" class="ltx_Math" alttext="i" display="inline"><mi>i</mi></math>, we want to find the maximum total revenue <math id="S4.SS1.p1.m4" class="ltx_Math" alttext="r_{n}" display="inline"><msub><mi>r</mi><mi>n</mi></msub></math> for the rod.
Let <math id="S4.SS1.p1.m5" class="ltx_Math" alttext="r_{i}" display="inline"><msub><mi>r</mi><mi>i</mi></msub></math> denote the maximum total revenue for the rod of length <math id="S4.SS1.p1.m6" class="ltx_Math" alttext="i" display="inline"><mi>i</mi></math>.
Then we have the <span class="ltx_text ltx_font_bold">Bellman equation</span>:</p>
<table id="S4.Ex4" class="ltx_equation ltx_eqn_table">

<tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.Ex4.m1" class="ltx_Math" alttext="r_{n}=\max_{1\leq i\leq n}(p_{i}+r_{n-i})" display="block"><mrow><msub><mi>r</mi><mi>n</mi></msub><mo>=</mo><mrow><munder><mi>max</mi><mrow><mn>1</mn><mo>≤</mo><mi>i</mi><mo>≤</mo><mi>n</mi></mrow></munder><mo>⁡</mo><mrow><mo stretchy="false">(</mo><mrow><msub><mi>p</mi><mi>i</mi></msub><mo>+</mo><msub><mi>r</mi><mrow><mi>n</mi><mo>-</mo><mi>i</mi></mrow></msub></mrow><mo stretchy="false">)</mo></mrow></mrow></mrow></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</table>
</div>
<div id="S4.SS1.p2" class="ltx_para ltx_noindent">
<p class="ltx_p">It should be noted that there is another Bellman equation, but we will not discuss it here:</p>
<table id="S4.Ex5" class="ltx_equation ltx_eqn_table">

<tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.Ex5.m1" class="ltx_Math" alttext="r_{n}=\max(p_{n},r_{1}+r_{n-1},r_{2}+r_{n-2},\dots,r_{n-1}+r_{1})" display="block"><mrow><msub><mi>r</mi><mi>n</mi></msub><mo>=</mo><mrow><mi>max</mi><mo>⁡</mo><mrow><mo stretchy="false">(</mo><msub><mi>p</mi><mi>n</mi></msub><mo>,</mo><mrow><msub><mi>r</mi><mn>1</mn></msub><mo>+</mo><msub><mi>r</mi><mrow><mi>n</mi><mo>-</mo><mn>1</mn></mrow></msub></mrow><mo>,</mo><mrow><msub><mi>r</mi><mn>2</mn></msub><mo>+</mo><msub><mi>r</mi><mrow><mi>n</mi><mo>-</mo><mn>2</mn></mrow></msub></mrow><mo>,</mo><mi mathvariant="normal">…</mi><mo>,</mo><mrow><msub><mi>r</mi><mrow><mi>n</mi><mo>-</mo><mn>1</mn></mrow></msub><mo>+</mo><msub><mi>r</mi><mn>1</mn></msub></mrow><mo stretchy="false">)</mo></mrow></mrow></mrow></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</table>
</div>
<section id="S4.SS1.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.1.1 </span>Different Implementations</h4>

<div id="S4.SS1.SSS1.p1" class="ltx_para ltx_noindent">
<p class="ltx_p"><span class="ltx_text ltx_font_bold">Recursive Implementation</span></p>
</div>
<div id="S4.SS1.SSS1.p2" class="ltx_para ltx_align_center">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr class="ltx_tr">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" colspan="2"><span class="ltx_text ltx_font_smallcaps">Cut-Rod<math id="S4.SS1.SSS1.p2.m1" class="ltx_Math" alttext="(p,n)" display="inline"><mrow><mo mathvariant="normal" stretchy="false">(</mo><mi>p</mi><mo mathvariant="normal">,</mo><mi>n</mi><mo mathvariant="normal" stretchy="false">)</mo></mrow></math></span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_t">1.</th>
<td class="ltx_td ltx_align_left ltx_border_t">
<span class="ltx_text ltx_font_bold">if</span> <math id="S4.SS1.SSS1.p2.m2" class="ltx_Math" alttext="n=0" display="inline"><mrow><mi>n</mi><mo>=</mo><mn>0</mn></mrow></math>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">2.</th>
<td class="ltx_td ltx_align_left"> <span class="ltx_text ltx_font_bold">return</span> <math id="S4.SS1.SSS1.p2.m3" class="ltx_Math" alttext="0" display="inline"><mn>0</mn></math>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">3.</th>
<td class="ltx_td ltx_align_left"><math id="S4.SS1.SSS1.p2.m4" class="ltx_Math" alttext="q=-\infty" display="inline"><mrow><mi>q</mi><mo>=</mo><mrow><mo>-</mo><mi mathvariant="normal">∞</mi></mrow></mrow></math></td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">4.</th>
<td class="ltx_td ltx_align_left">
<span class="ltx_text ltx_font_bold">for</span> <math id="S4.SS1.SSS1.p2.m5" class="ltx_Math" alttext="i=1" display="inline"><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow></math> to <math id="S4.SS1.SSS1.p2.m6" class="ltx_Math" alttext="n" display="inline"><mi>n</mi></math>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">5.</th>
<td class="ltx_td ltx_align_left"> <math id="S4.SS1.SSS1.p2.m7" class="ltx_Math" alttext="q=\max(q,p_{i}+\textsc{Cut-Rod}(p,n-i))" display="inline"><mrow><mi>q</mi><mo>=</mo><mrow><mi>max</mi><mo>⁡</mo><mrow><mo stretchy="false">(</mo><mi>q</mi><mo>,</mo><mrow><msub><mi>p</mi><mi>i</mi></msub><mo>+</mo><mrow><mtext class="ltx_font_smallcaps" mathvariant="normal">Cut-Rod</mtext><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>p</mi><mo>,</mo><mrow><mi>n</mi><mo>-</mo><mi>i</mi></mrow><mo stretchy="false">)</mo></mrow></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow></mrow></math>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_bb">6.</th>
<td class="ltx_td ltx_align_left ltx_border_bb">
<span class="ltx_text ltx_font_bold">return</span> <math id="S4.SS1.SSS1.p2.m8" class="ltx_Math" alttext="q" display="inline"><mi>q</mi></math>
</td>
</tr>
</tbody>
</table>
</div>
<div id="S4.SS1.SSS1.p3" class="ltx_para ltx_noindent">
<p class="ltx_p"><span class="ltx_text ltx_font_bold">Runtime:</span>
Let <math id="S4.SS1.SSS1.p3.m1" class="ltx_Math" alttext="T(n)" display="inline"><mrow><mi>T</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></mrow></math> denote the number of times <span class="ltx_text ltx_font_smallcaps">Cut-Rod</span> is called.
Then we have <math id="S4.SS1.SSS1.p3.m2" class="ltx_Math" alttext="T(n)=1+\sum_{i=1}^{n}T(n-i)" display="inline"><mrow><mrow><mi>T</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><mn>1</mn><mo>+</mo><mrow><msubsup><mo largeop="true" symmetric="true">∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></msubsup><mrow><mi>T</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mi>n</mi><mo>-</mo><mi>i</mi></mrow><mo stretchy="false">)</mo></mrow></mrow></mrow></mrow></mrow></math>.
Solve this recurrence relation, we have <math id="S4.SS1.SSS1.p3.m3" class="ltx_Math" alttext="T(n)=2^{n}" display="inline"><mrow><mrow><mi>T</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><msup><mn>2</mn><mi>n</mi></msup></mrow></math>.</p>
</div>
<div id="S4.SS1.SSS1.p4" class="ltx_para ltx_noindent">
<p class="ltx_p"><span class="ltx_text ltx_font_bold">Bottom Up Implementation</span></p>
</div>
<div id="S4.SS1.SSS1.p5" class="ltx_para ltx_align_center">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr class="ltx_tr">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" colspan="2"><span class="ltx_text ltx_font_smallcaps">Bottom-Up-Cut-Rod<math id="S4.SS1.SSS1.p5.m1" class="ltx_Math" alttext="(p,n)" display="inline"><mrow><mo mathvariant="normal" stretchy="false">(</mo><mi>p</mi><mo mathvariant="normal">,</mo><mi>n</mi><mo mathvariant="normal" stretchy="false">)</mo></mrow></math></span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_t">1.</th>
<td class="ltx_td ltx_align_left ltx_border_t"><math id="S4.SS1.SSS1.p5.m2" class="ltx_Math" alttext="r_{0}=0" display="inline"><mrow><msub><mi>r</mi><mn>0</mn></msub><mo>=</mo><mn>0</mn></mrow></math></td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">2.</th>
<td class="ltx_td ltx_align_left">
<span class="ltx_text ltx_font_bold">for</span> <math id="S4.SS1.SSS1.p5.m3" class="ltx_Math" alttext="j=1" display="inline"><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow></math> to <math id="S4.SS1.SSS1.p5.m4" class="ltx_Math" alttext="n" display="inline"><mi>n</mi></math>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">3.</th>
<td class="ltx_td ltx_align_left"> <math id="S4.SS1.SSS1.p5.m5" class="ltx_Math" alttext="q=-\infty" display="inline"><mrow><mi>q</mi><mo>=</mo><mrow><mo>-</mo><mi mathvariant="normal">∞</mi></mrow></mrow></math>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">4.</th>
<td class="ltx_td ltx_align_left"> <span class="ltx_text ltx_font_bold">for</span> <math id="S4.SS1.SSS1.p5.m6" class="ltx_Math" alttext="i=1" display="inline"><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow></math> to <math id="S4.SS1.SSS1.p5.m7" class="ltx_Math" alttext="j" display="inline"><mi>j</mi></math>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">5.</th>
<td class="ltx_td ltx_align_left">  <math id="S4.SS1.SSS1.p5.m8" class="ltx_Math" alttext="q=\max(q,p[i]+r[j-i])" display="inline"><mrow><mi>q</mi><mo>=</mo><mrow><mi>max</mi><mo>⁡</mo><mrow><mo stretchy="false">(</mo><mi>q</mi><mo>,</mo><mrow><mrow><mi>p</mi><mo>⁢</mo><mrow><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo></mrow></mrow><mo>+</mo><mrow><mi>r</mi><mo>⁢</mo><mrow><mo stretchy="false">[</mo><mrow><mi>j</mi><mo>-</mo><mi>i</mi></mrow><mo stretchy="false">]</mo></mrow></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow></mrow></math>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">6.</th>
<td class="ltx_td ltx_align_left"> <math id="S4.SS1.SSS1.p5.m9" class="ltx_Math" alttext="r[j]=q" display="inline"><mrow><mrow><mi>r</mi><mo>⁢</mo><mrow><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo></mrow></mrow><mo>=</mo><mi>q</mi></mrow></math>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_bb">7.</th>
<td class="ltx_td ltx_align_left ltx_border_bb">
<span class="ltx_text ltx_font_bold">return</span> <math id="S4.SS1.SSS1.p5.m10" class="ltx_Math" alttext="r[n]" display="inline"><mrow><mi>r</mi><mo>⁢</mo><mrow><mo stretchy="false">[</mo><mi>n</mi><mo stretchy="false">]</mo></mrow></mrow></math>
</td>
</tr>
</tbody>
</table>
</div>
<div id="S4.SS1.SSS1.p6" class="ltx_para ltx_noindent">
<p class="ltx_p">In dynamic programming, correctly initializing the table is very important.
In this case, we initialize <math id="S4.SS1.SSS1.p6.m1" class="ltx_Math" alttext="r_{0}=0" display="inline"><mrow><msub><mi>r</mi><mn>0</mn></msub><mo>=</mo><mn>0</mn></mrow></math>.</p>
</div>
<div id="S4.SS1.SSS1.p7" class="ltx_para ltx_noindent">
<p class="ltx_p"><span class="ltx_text ltx_font_bold">Runtime:</span>
<math id="S4.SS1.SSS1.p7.m1" class="ltx_Math" alttext="\Theta(n^{2})" display="inline"><mrow><mi mathvariant="normal">Θ</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><msup><mi>n</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mrow></mrow></math>.</p>
</div>
<div id="S4.SS1.SSS1.p8" class="ltx_para ltx_noindent">
<p class="ltx_p"><span class="ltx_text ltx_font_bold">Top Down Implementation</span></p>
</div>
<div id="S4.SS1.SSS1.p9" class="ltx_para ltx_noindent">
<p class="ltx_p">This is also called <span class="ltx_text ltx_font_bold">memoization</span>, we first check whether the subproblem has been solved, and if so, we return the solution.</p>
</div>
<div id="S4.SS1.SSS1.p10" class="ltx_para ltx_align_center">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr class="ltx_tr">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" colspan="2"><span class="ltx_text ltx_font_smallcaps">Memoized-Cut-Rod<math id="S4.SS1.SSS1.p10.m1" class="ltx_Math" alttext="(p,n)" display="inline"><mrow><mo mathvariant="normal" stretchy="false">(</mo><mi>p</mi><mo mathvariant="normal">,</mo><mi>n</mi><mo mathvariant="normal" stretchy="false">)</mo></mrow></math></span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_t">1.</th>
<td class="ltx_td ltx_align_left ltx_border_t">
<span class="ltx_text ltx_font_bold">if</span> <math id="S4.SS1.SSS1.p10.m2" class="ltx_Math" alttext="r_{n}\geq 0" display="inline"><mrow><msub><mi>r</mi><mi>n</mi></msub><mo>≥</mo><mn>0</mn></mrow></math>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">2.</th>
<td class="ltx_td ltx_align_left"> <span class="ltx_text ltx_font_bold">return</span> <math id="S4.SS1.SSS1.p10.m3" class="ltx_Math" alttext="r_{n}" display="inline"><msub><mi>r</mi><mi>n</mi></msub></math>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">3.</th>
<td class="ltx_td ltx_align_left"><math id="S4.SS1.SSS1.p10.m4" class="ltx_Math" alttext="q=-\infty" display="inline"><mrow><mi>q</mi><mo>=</mo><mrow><mo>-</mo><mi mathvariant="normal">∞</mi></mrow></mrow></math></td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">4.</th>
<td class="ltx_td ltx_align_left">
<span class="ltx_text ltx_font_bold">for</span> <math id="S4.SS1.SSS1.p10.m5" class="ltx_Math" alttext="i=1" display="inline"><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow></math> to <math id="S4.SS1.SSS1.p10.m6" class="ltx_Math" alttext="n" display="inline"><mi>n</mi></math>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">5.</th>
<td class="ltx_td ltx_align_left"> <math id="S4.SS1.SSS1.p10.m7" class="ltx_Math" alttext="q=\max(q,p_{i}+\textsc{Memoized-Cut-Rod}(p,n-i))" display="inline"><mrow><mi>q</mi><mo>=</mo><mrow><mi>max</mi><mo>⁡</mo><mrow><mo stretchy="false">(</mo><mi>q</mi><mo>,</mo><mrow><msub><mi>p</mi><mi>i</mi></msub><mo>+</mo><mrow><mtext class="ltx_font_smallcaps" mathvariant="normal">Memoized-Cut-Rod</mtext><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>p</mi><mo>,</mo><mrow><mi>n</mi><mo>-</mo><mi>i</mi></mrow><mo stretchy="false">)</mo></mrow></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow></mrow></math>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">6.</th>
<td class="ltx_td ltx_align_left"><math id="S4.SS1.SSS1.p10.m8" class="ltx_Math" alttext="r_{n}=q" display="inline"><mrow><msub><mi>r</mi><mi>n</mi></msub><mo>=</mo><mi>q</mi></mrow></math></td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_bb">7.</th>
<td class="ltx_td ltx_align_left ltx_border_bb">
<span class="ltx_text ltx_font_bold">return</span> <math id="S4.SS1.SSS1.p10.m9" class="ltx_Math" alttext="q" display="inline"><mi>q</mi></math>
</td>
</tr>
</tbody>
</table>
</div>
<div id="S4.SS1.SSS1.p11" class="ltx_para ltx_noindent">
<p class="ltx_p"><span class="ltx_text ltx_font_bold">Runtime:</span>
<math id="S4.SS1.SSS1.p11.m1" class="ltx_Math" alttext="\Theta(n^{2})" display="inline"><mrow><mi mathvariant="normal">Θ</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><msup><mi>n</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mrow></mrow></math>.</p>
</div>
<div id="S4.SS1.SSS1.p12" class="ltx_para ltx_noindent">
<p class="ltx_p">It is worth noting that although in this particular case, the bottom up implementation is as fast as the top down implementation, in general, the memoization method is faster than the bottom up method.
This is because the memoization method only solves the subproblems that are needed, while the bottom up method solves all subproblems.</p>
</div>
</section>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Subproblem Graph</h3>

<div id="S4.SS2.p1" class="ltx_para ltx_noindent">
<p class="ltx_p">We can draw a graph to show the subproblems and their dependencies.
For example, in the rod cutting problem, we can draw a graph as follows:</p>
<img src="{{ site.baseurl }}/images/2024-07-27-Data-Structure-and-Algorithm-Analysis-Final-Review-Note-fig1.png" id="S4.SS2.p1.g1" class="ltx_graphics ltx_centering" width="54" height="164" alt="">
</div>
<div id="S4.SS2.p2" class="ltx_para ltx_noindent">
<p class="ltx_p">When we estimate the runtime of a dynamic programming algorithm, it is often linear in the number of vertices and edges in the subproblem graph.</p>
</div>
</section>
<section id="S4.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Reconstruct The Solution</h3>

<div id="S4.SS3.p1" class="ltx_para ltx_noindent">
<p class="ltx_p">In the rod cutting problem, we want to find the optimal solution, not just the optimal revenue.
We can use an auxiliary array <math id="S4.SS3.p1.m1" class="ltx_Math" alttext="s" display="inline"><mi>s</mi></math> to store the optimal size of the first piece to cut off.
Then we can reconstruct the solution by tracing back the array <math id="S4.SS3.p1.m2" class="ltx_Math" alttext="s" display="inline"><mi>s</mi></math>.</p>
</div>
<div id="S4.SS3.p2" class="ltx_para ltx_noindent">
<p class="ltx_p">For the bottom up implementation, we can implement a <span class="ltx_text ltx_font_smallcaps">Extended-Bottom-Up-Cut-Rod</span> to return both the optimal revenue and the auxiliary array <math id="S4.SS3.p2.m1" class="ltx_Math" alttext="s" display="inline"><mi>s</mi></math>.</p>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr class="ltx_tr">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" colspan="2"><span class="ltx_text ltx_font_smallcaps">Extended-Bottom-Up-Cut-Rod<math id="S4.SS3.p2.m2" class="ltx_Math" alttext="(p,n)" display="inline"><mrow><mo mathvariant="normal" stretchy="false">(</mo><mi>p</mi><mo mathvariant="normal">,</mo><mi>n</mi><mo mathvariant="normal" stretchy="false">)</mo></mrow></math></span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_t">1.</th>
<td class="ltx_td ltx_align_left ltx_border_t"><math id="S4.SS3.p2.m3" class="ltx_Math" alttext="r_{0}=0" display="inline"><mrow><msub><mi>r</mi><mn>0</mn></msub><mo>=</mo><mn>0</mn></mrow></math></td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">2.</th>
<td class="ltx_td ltx_align_left">
<span class="ltx_text ltx_font_bold">for</span> <math id="S4.SS3.p2.m4" class="ltx_Math" alttext="j=1" display="inline"><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow></math> to <math id="S4.SS3.p2.m5" class="ltx_Math" alttext="n" display="inline"><mi>n</mi></math>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">3.</th>
<td class="ltx_td ltx_align_left"> <math id="S4.SS3.p2.m6" class="ltx_Math" alttext="q=-\infty" display="inline"><mrow><mi>q</mi><mo>=</mo><mrow><mo>-</mo><mi mathvariant="normal">∞</mi></mrow></mrow></math>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">4.</th>
<td class="ltx_td ltx_align_left"> <span class="ltx_text ltx_font_bold">for</span> <math id="S4.SS3.p2.m7" class="ltx_Math" alttext="i=1" display="inline"><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow></math> to <math id="S4.SS3.p2.m8" class="ltx_Math" alttext="j" display="inline"><mi>j</mi></math>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">5.</th>
<td class="ltx_td ltx_align_left">  <span class="ltx_text ltx_font_bold">if</span> <math id="S4.SS3.p2.m9" class="ltx_Math" alttext="q&lt;p_{i}+r_{j-i}" display="inline"><mrow><mi>q</mi><mo>&lt;</mo><mrow><msub><mi>p</mi><mi>i</mi></msub><mo>+</mo><msub><mi>r</mi><mrow><mi>j</mi><mo>-</mo><mi>i</mi></mrow></msub></mrow></mrow></math>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">6.</th>
<td class="ltx_td ltx_align_left">   <math id="S4.SS3.p2.m10" class="ltx_Math" alttext="q=p_{i}+r_{j-i}" display="inline"><mrow><mi>q</mi><mo>=</mo><mrow><msub><mi>p</mi><mi>i</mi></msub><mo>+</mo><msub><mi>r</mi><mrow><mi>j</mi><mo>-</mo><mi>i</mi></mrow></msub></mrow></mrow></math>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">7.</th>
<td class="ltx_td ltx_align_left">   <math id="S4.SS3.p2.m11" class="ltx_Math" alttext="s_{j}=i" display="inline"><mrow><msub><mi>s</mi><mi>j</mi></msub><mo>=</mo><mi>i</mi></mrow></math>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">8.</th>
<td class="ltx_td ltx_align_left"> <math id="S4.SS3.p2.m12" class="ltx_Math" alttext="r_{j}=q" display="inline"><mrow><msub><mi>r</mi><mi>j</mi></msub><mo>=</mo><mi>q</mi></mrow></math>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_bb">9.</th>
<td class="ltx_td ltx_align_left ltx_border_bb">
<span class="ltx_text ltx_font_bold">return</span> <math id="S4.SS3.p2.m13" class="ltx_Math" alttext="r_{n},s" display="inline"><mrow><msub><mi>r</mi><mi>n</mi></msub><mo>,</mo><mi>s</mi></mrow></math>
</td>
</tr>
</tbody>
</table>
</div>
<div id="S4.SS3.p3" class="ltx_para ltx_noindent">
<p class="ltx_p">Then we can print the solution by:</p>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr class="ltx_tr">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" colspan="2"><span class="ltx_text ltx_font_smallcaps">Print-Cut-Rod-Solution<math id="S4.SS3.p3.m1" class="ltx_Math" alttext="(p,n)" display="inline"><mrow><mo mathvariant="normal" stretchy="false">(</mo><mi>p</mi><mo mathvariant="normal">,</mo><mi>n</mi><mo mathvariant="normal" stretchy="false">)</mo></mrow></math></span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_t">1.</th>
<td class="ltx_td ltx_align_left ltx_border_t"><math id="S4.SS3.p3.m2" class="ltx_Math" alttext="(r,s)=\textsc{Extended-Bottom-Up-Cut-Rod}(p,n)" display="inline"><mrow><mrow><mo stretchy="false">(</mo><mi>r</mi><mo>,</mo><mi>s</mi><mo stretchy="false">)</mo></mrow><mo>=</mo><mrow><mtext class="ltx_font_smallcaps" mathvariant="normal">Extended-Bottom-Up-Cut-Rod</mtext><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>p</mi><mo>,</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></mrow></mrow></math></td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">2.</th>
<td class="ltx_td ltx_align_left">
<span class="ltx_text ltx_font_bold">while</span> <math id="S4.SS3.p3.m3" class="ltx_Math" alttext="n&gt;0" display="inline"><mrow><mi>n</mi><mo>&gt;</mo><mn>0</mn></mrow></math>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">3.</th>
<td class="ltx_td ltx_align_left"> print <math id="S4.SS3.p3.m4" class="ltx_Math" alttext="s[n]" display="inline"><mrow><mi>s</mi><mo>⁢</mo><mrow><mo stretchy="false">[</mo><mi>n</mi><mo stretchy="false">]</mo></mrow></mrow></math>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_bb">4.</th>
<td class="ltx_td ltx_align_left ltx_border_bb"> <math id="S4.SS3.p3.m5" class="ltx_Math" alttext="n=n-s[n]" display="inline"><mrow><mi>n</mi><mo>=</mo><mrow><mi>n</mi><mo>-</mo><mrow><mi>s</mi><mo>⁢</mo><mrow><mo stretchy="false">[</mo><mi>n</mi><mo stretchy="false">]</mo></mrow></mrow></mrow></mrow></math>
</td>
</tr>
</tbody>
</table>
</div>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Greedy Algorithms</h2>

<div id="S5.p1" class="ltx_para ltx_noindent">
<p class="ltx_p">A greedy algorithm always makes the choice that looks best at the moment.
A greedy algorithm always have a corresponding dynamic programming algorithm, but the converse is not true (otherwise we do not need dynamic programming).</p>
</div>
<section id="S5.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.1 </span>Activity Selection</h3>

<div id="S5.SS1.p1" class="ltx_para ltx_noindent">
<p class="ltx_p">We have a set of activities <math id="S5.SS1.p1.m1" class="ltx_Math" alttext="S=\{a_{1},a_{2},\dots,a_{n}\}" display="inline"><mrow><mi>S</mi><mo>=</mo><mrow><mo stretchy="false">{</mo><msub><mi>a</mi><mn>1</mn></msub><mo>,</mo><msub><mi>a</mi><mn>2</mn></msub><mo>,</mo><mi mathvariant="normal">…</mi><mo>,</mo><msub><mi>a</mi><mi>n</mi></msub><mo stretchy="false">}</mo></mrow></mrow></math>, where each activity <math id="S5.SS1.p1.m2" class="ltx_Math" alttext="a_{i}" display="inline"><msub><mi>a</mi><mi>i</mi></msub></math> has a start time <math id="S5.SS1.p1.m3" class="ltx_Math" alttext="s_{i}" display="inline"><msub><mi>s</mi><mi>i</mi></msub></math> and a finish time <math id="S5.SS1.p1.m4" class="ltx_Math" alttext="f_{i}" display="inline"><msub><mi>f</mi><mi>i</mi></msub></math>.
Two activities <math id="S5.SS1.p1.m5" class="ltx_Math" alttext="a_{i}" display="inline"><msub><mi>a</mi><mi>i</mi></msub></math> and <math id="S5.SS1.p1.m6" class="ltx_Math" alttext="a_{j}" display="inline"><msub><mi>a</mi><mi>j</mi></msub></math> are <span class="ltx_text ltx_font_bold">compatible</span> if <math id="S5.SS1.p1.m7" class="ltx_Math" alttext="[s_{i},f_{i})" display="inline"><mrow><mo stretchy="false">[</mo><msub><mi>s</mi><mi>i</mi></msub><mo>,</mo><msub><mi>f</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow></math> and <math id="S5.SS1.p1.m8" class="ltx_Math" alttext="[s_{j},f_{j})" display="inline"><mrow><mo stretchy="false">[</mo><msub><mi>s</mi><mi>j</mi></msub><mo>,</mo><msub><mi>f</mi><mi>j</mi></msub><mo stretchy="false">)</mo></mrow></math> do not overlap.
The goal is to find the maximum-size subset of mutually compatible activities (<span class="ltx_text ltx_font_bold">not the set of activities with the maximum total time</span>).</p>
</div>
<section id="S5.SS1.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">5.1.1 </span>Dynamic Programming</h4>

<div id="S5.SS1.SSS1.p1" class="ltx_para ltx_noindent">
<p class="ltx_p">We can use dynamic programming to solve this problem.
Let <math id="S5.SS1.SSS1.p1.m1" class="ltx_Math" alttext="S_{ij}" display="inline"><msub><mi>S</mi><mrow><mi>i</mi><mo>⁢</mo><mi>j</mi></mrow></msub></math> denote the set of activities that start after <math id="S5.SS1.SSS1.p1.m2" class="ltx_Math" alttext="a_{i}" display="inline"><msub><mi>a</mi><mi>i</mi></msub></math> finishes and finish before <math id="S5.SS1.SSS1.p1.m3" class="ltx_Math" alttext="a_{j}" display="inline"><msub><mi>a</mi><mi>j</mi></msub></math> starts,
and let <math id="S5.SS1.SSS1.p1.m4" class="ltx_Math" alttext="A_{ij}" display="inline"><msub><mi>A</mi><mrow><mi>i</mi><mo>⁢</mo><mi>j</mi></mrow></msub></math> denote the maximum-size subset of mutually compatible activities in <math id="S5.SS1.SSS1.p1.m5" class="ltx_Math" alttext="S_{ij}" display="inline"><msub><mi>S</mi><mrow><mi>i</mi><mo>⁢</mo><mi>j</mi></mrow></msub></math>.</p>
</div>
<div id="S5.SS1.SSS1.p2" class="ltx_para ltx_noindent">
<p class="ltx_p">The activity selection problem has optimal substructure:
Suppose <math id="S5.SS1.SSS1.p2.m1" class="ltx_Math" alttext="a_{k}" display="inline"><msub><mi>a</mi><mi>k</mi></msub></math> is in <math id="S5.SS1.SSS1.p2.m2" class="ltx_Math" alttext="A_{ij}" display="inline"><msub><mi>A</mi><mrow><mi>i</mi><mo>⁢</mo><mi>j</mi></mrow></msub></math>, then <math id="S5.SS1.SSS1.p2.m3" class="ltx_Math" alttext="A_{ij}=A_{ik}\cup\{a_{k}\}\cup A_{kj}" display="inline"><mrow><msub><mi>A</mi><mrow><mi>i</mi><mo>⁢</mo><mi>j</mi></mrow></msub><mo>=</mo><mrow><msub><mi>A</mi><mrow><mi>i</mi><mo>⁢</mo><mi>k</mi></mrow></msub><mo>∪</mo><mrow><mo stretchy="false">{</mo><msub><mi>a</mi><mi>k</mi></msub><mo stretchy="false">}</mo></mrow><mo>∪</mo><msub><mi>A</mi><mrow><mi>k</mi><mo>⁢</mo><mi>j</mi></mrow></msub></mrow></mrow></math>.
Then <math id="S5.SS1.SSS1.p2.m4" class="ltx_Math" alttext="|A_{ij}|=|A_{ik}|+1+|A_{kj}|" display="inline"><mrow><mrow><mo stretchy="false">|</mo><msub><mi>A</mi><mrow><mi>i</mi><mo>⁢</mo><mi>j</mi></mrow></msub><mo stretchy="false">|</mo></mrow><mo>=</mo><mrow><mrow><mo stretchy="false">|</mo><msub><mi>A</mi><mrow><mi>i</mi><mo>⁢</mo><mi>k</mi></mrow></msub><mo stretchy="false">|</mo></mrow><mo>+</mo><mn>1</mn><mo>+</mo><mrow><mo stretchy="false">|</mo><msub><mi>A</mi><mrow><mi>k</mi><mo>⁢</mo><mi>j</mi></mrow></msub><mo stretchy="false">|</mo></mrow></mrow></mrow></math>.
Then we have the Bellman equation:</p>
<table id="S5.Ex6" class="ltx_equation ltx_eqn_table">

<tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S5.Ex6.m1" class="ltx_Math" alttext="c[i,j]=\max_{a_{k}\in S_{ij}}(c[i,k]+c[k,j]+1)" display="block"><mrow><mrow><mi>c</mi><mo>⁢</mo><mrow><mo stretchy="false">[</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy="false">]</mo></mrow></mrow><mo>=</mo><mrow><munder><mi>max</mi><mrow><msub><mi>a</mi><mi>k</mi></msub><mo>∈</mo><msub><mi>S</mi><mrow><mi>i</mi><mo>⁢</mo><mi>j</mi></mrow></msub></mrow></munder><mo>⁡</mo><mrow><mo stretchy="false">(</mo><mrow><mrow><mi>c</mi><mo>⁢</mo><mrow><mo stretchy="false">[</mo><mi>i</mi><mo>,</mo><mi>k</mi><mo stretchy="false">]</mo></mrow></mrow><mo>+</mo><mrow><mi>c</mi><mo>⁢</mo><mrow><mo stretchy="false">[</mo><mi>k</mi><mo>,</mo><mi>j</mi><mo stretchy="false">]</mo></mrow></mrow><mo>+</mo><mn>1</mn></mrow><mo stretchy="false">)</mo></mrow></mrow></mrow></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</table>
</div>
</section>
<section id="S5.SS1.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">5.1.2 </span>Greedy Choice</h4>

<div id="S5.SS1.SSS2.p1" class="ltx_para ltx_noindent">
<p class="ltx_p">We can also use a greedy algorithm to solve this problem.
We first sort the activities by their finish time, and then we choose the first activity.
Then we choose the first activity that is compatible with the first activity, and so on.</p>
</div>
<div id="S5.SS1.SSS2.p2" class="ltx_para ltx_noindent">
<p class="ltx_p">In other words, we always choose the activity that finishes first.</p>
</div>
<div id="S5.SS1.SSS2.p3" class="ltx_para ltx_noindent">
<p class="ltx_p">Loop version:</p>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr class="ltx_tr">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt" colspan="2"><span class="ltx_text ltx_font_smallcaps">Greedy-Activity-Selector<math id="S5.SS1.SSS2.p3.m1" class="ltx_Math" alttext="(s,f)" display="inline"><mrow><mo mathvariant="normal" stretchy="false">(</mo><mi>s</mi><mo mathvariant="normal">,</mo><mi>f</mi><mo mathvariant="normal" stretchy="false">)</mo></mrow></math></span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_t">1.</th>
<td class="ltx_td ltx_align_left ltx_border_t"><math id="S5.SS1.SSS2.p3.m2" class="ltx_Math" alttext="n=s.length" display="inline"><mrow><mrow><mi>n</mi><mo>=</mo><mi>s</mi></mrow><mo>.</mo><mrow><mi>l</mi><mo>⁢</mo><mi>e</mi><mo>⁢</mo><mi>n</mi><mo>⁢</mo><mi>g</mi><mo>⁢</mo><mi>t</mi><mo>⁢</mo><mi>h</mi></mrow></mrow></math></td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">2.</th>
<td class="ltx_td ltx_align_left"><math id="S5.SS1.SSS2.p3.m3" class="ltx_Math" alttext="A=\{a_{1}\}" display="inline"><mrow><mi>A</mi><mo>=</mo><mrow><mo stretchy="false">{</mo><msub><mi>a</mi><mn>1</mn></msub><mo stretchy="false">}</mo></mrow></mrow></math></td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">3.</th>
<td class="ltx_td ltx_align_left"><math id="S5.SS1.SSS2.p3.m4" class="ltx_Math" alttext="k=1" display="inline"><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow></math></td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">4.</th>
<td class="ltx_td ltx_align_left">
<span class="ltx_text ltx_font_bold">for</span> <math id="S5.SS1.SSS2.p3.m5" class="ltx_Math" alttext="m=2" display="inline"><mrow><mi>m</mi><mo>=</mo><mn>2</mn></mrow></math> to <math id="S5.SS1.SSS2.p3.m6" class="ltx_Math" alttext="n" display="inline"><mi>n</mi></math>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">5.</th>
<td class="ltx_td ltx_align_left"> <span class="ltx_text ltx_font_bold">if</span> <math id="S5.SS1.SSS2.p3.m7" class="ltx_Math" alttext="s_{m}\geq f_{k}" display="inline"><mrow><msub><mi>s</mi><mi>m</mi></msub><mo>≥</mo><msub><mi>f</mi><mi>k</mi></msub></mrow></math>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">6.</th>
<td class="ltx_td ltx_align_left">  <math id="S5.SS1.SSS2.p3.m8" class="ltx_Math" alttext="A=A\cup\{a_{m}\}" display="inline"><mrow><mi>A</mi><mo>=</mo><mrow><mi>A</mi><mo>∪</mo><mrow><mo stretchy="false">{</mo><msub><mi>a</mi><mi>m</mi></msub><mo stretchy="false">}</mo></mrow></mrow></mrow></math>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">7.</th>
<td class="ltx_td ltx_align_left">  <math id="S5.SS1.SSS2.p3.m9" class="ltx_Math" alttext="k=m" display="inline"><mrow><mi>k</mi><mo>=</mo><mi>m</mi></mrow></math>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_bb">8.</th>
<td class="ltx_td ltx_align_left ltx_border_bb">
<span class="ltx_text ltx_font_bold">return</span> <math id="S5.SS1.SSS2.p3.m10" class="ltx_Math" alttext="A" display="inline"><mi>A</mi></math>
</td>
</tr>
</tbody>
</table>
</div>
<div id="S5.SS1.SSS2.p4" class="ltx_para ltx_noindent">
<p class="ltx_p">Recursive version:</p>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr class="ltx_tr">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" colspan="2"><span class="ltx_text ltx_font_smallcaps">Recursive-Activity-Selector<math id="S5.SS1.SSS2.p4.m1" class="ltx_Math" alttext="(s,f,k,n)" display="inline"><mrow><mo mathvariant="normal" stretchy="false">(</mo><mi>s</mi><mo mathvariant="normal">,</mo><mi>f</mi><mo mathvariant="normal">,</mo><mi>k</mi><mo mathvariant="normal">,</mo><mi>n</mi><mo mathvariant="normal" stretchy="false">)</mo></mrow></math></span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_t">1.</th>
<td class="ltx_td ltx_align_left ltx_border_t"><math id="S5.SS1.SSS2.p4.m2" class="ltx_Math" alttext="m=k+1" display="inline"><mrow><mi>m</mi><mo>=</mo><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></mrow></math></td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">2.</th>
<td class="ltx_td ltx_align_left">
<span class="ltx_text ltx_font_bold">while</span> <math id="S5.SS1.SSS2.p4.m3" class="ltx_Math" alttext="m\leq n" display="inline"><mrow><mi>m</mi><mo>≤</mo><mi>n</mi></mrow></math> and <math id="S5.SS1.SSS2.p4.m4" class="ltx_Math" alttext="s_{m}&lt;f_{k}" display="inline"><mrow><msub><mi>s</mi><mi>m</mi></msub><mo>&lt;</mo><msub><mi>f</mi><mi>k</mi></msub></mrow></math>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">3.</th>
<td class="ltx_td ltx_align_left"> <math id="S5.SS1.SSS2.p4.m5" class="ltx_Math" alttext="m=m+1" display="inline"><mrow><mi>m</mi><mo>=</mo><mrow><mi>m</mi><mo>+</mo><mn>1</mn></mrow></mrow></math>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">4.</th>
<td class="ltx_td ltx_align_left">
<span class="ltx_text ltx_font_bold">if</span> <math id="S5.SS1.SSS2.p4.m6" class="ltx_Math" alttext="m\leq n" display="inline"><mrow><mi>m</mi><mo>≤</mo><mi>n</mi></mrow></math>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">5.</th>
<td class="ltx_td ltx_align_left"> <span class="ltx_text ltx_font_bold">return</span> <math id="S5.SS1.SSS2.p4.m7" class="ltx_Math" alttext="\{a_{m}\}\cup\textsc{Recursive-Activity-Selector}(s,f,m,n)" display="inline"><mrow><mrow><mo stretchy="false">{</mo><msub><mi>a</mi><mi>m</mi></msub><mo stretchy="false">}</mo></mrow><mo>∪</mo><mrow><mtext class="ltx_font_smallcaps" mathvariant="normal">Recursive-Activity-Selector</mtext><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>s</mi><mo>,</mo><mi>f</mi><mo>,</mo><mi>m</mi><mo>,</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></mrow></mrow></math>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">6.</th>
<td class="ltx_td ltx_align_left"><span class="ltx_text ltx_font_bold">else</span></td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_bb">7.</th>
<td class="ltx_td ltx_align_left ltx_border_bb"> <span class="ltx_text ltx_font_bold">return</span> <math id="S5.SS1.SSS2.p4.m8" class="ltx_Math" alttext="\emptyset" display="inline"><mi mathvariant="normal">∅</mi></math>
</td>
</tr>
</tbody>
</table>
</div>
<div id="S5.SS1.SSS2.p5" class="ltx_para ltx_noindent">
<p class="ltx_p"><span class="ltx_text ltx_font_bold">Runtime:</span>
<math id="S5.SS1.SSS2.p5.m1" class="ltx_Math" alttext="\Theta(n)" display="inline"><mrow><mi mathvariant="normal">Θ</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></mrow></math>.
</p>
</div>
</section>
<section id="S5.SS1.SSS3" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">5.1.3 </span>Proof of Correctness</h4>

<div id="S5.SS1.SSS3.p1" class="ltx_para ltx_noindent">
<p class="ltx_p">We assume that the activities are sorted by their finish time.
Let <math id="S5.SS1.SSS3.p1.m1" class="ltx_Math" alttext="S_{k}" display="inline"><msub><mi>S</mi><mi>k</mi></msub></math> denote the set of activities the starts after <math id="S5.SS1.SSS3.p1.m2" class="ltx_Math" alttext="a_{k}" display="inline"><msub><mi>a</mi><mi>k</mi></msub></math> finishes, and <math id="S5.SS1.SSS3.p1.m3" class="ltx_Math" alttext="A_{k}" display="inline"><msub><mi>A</mi><mi>k</mi></msub></math> denote the maximum-size subset of mutually compatible activities in <math id="S5.SS1.SSS3.p1.m4" class="ltx_Math" alttext="S_{k}" display="inline"><msub><mi>S</mi><mi>k</mi></msub></math>.
We want to prove that if <math id="S5.SS1.SSS3.p1.m5" class="ltx_Math" alttext="a_{m}" display="inline"><msub><mi>a</mi><mi>m</mi></msub></math> is the activity that finishes first in the set <math id="S5.SS1.SSS3.p1.m6" class="ltx_Math" alttext="S_{k}" display="inline"><msub><mi>S</mi><mi>k</mi></msub></math>, then <math id="S5.SS1.SSS3.p1.m7" class="ltx_Math" alttext="a_{k}" display="inline"><msub><mi>a</mi><mi>k</mi></msub></math> is in some <math id="S5.SS1.SSS3.p1.m8" class="ltx_Math" alttext="A_{k}" display="inline"><msub><mi>A</mi><mi>k</mi></msub></math>.</p>
</div>
<div id="S5.SS1.SSS3.p2" class="ltx_para ltx_noindent">
<p class="ltx_p">Let <math id="S5.SS1.SSS3.p2.m1" class="ltx_Math" alttext="a_{j}" display="inline"><msub><mi>a</mi><mi>j</mi></msub></math> denote the activity that finishes first in <math id="S5.SS1.SSS3.p2.m2" class="ltx_Math" alttext="A_{k}" display="inline"><msub><mi>A</mi><mi>k</mi></msub></math>.
If <math id="S5.SS1.SSS3.p2.m3" class="ltx_Math" alttext="a_{j}=a_{m}" display="inline"><mrow><msub><mi>a</mi><mi>j</mi></msub><mo>=</mo><msub><mi>a</mi><mi>m</mi></msub></mrow></math>, then we are done.
If <math id="S5.SS1.SSS3.p2.m4" class="ltx_Math" alttext="a_{j}\neq a_{k}" display="inline"><mrow><msub><mi>a</mi><mi>j</mi></msub><mo>≠</mo><msub><mi>a</mi><mi>k</mi></msub></mrow></math>, we can exchange <math id="S5.SS1.SSS3.p2.m5" class="ltx_Math" alttext="a_{j}" display="inline"><msub><mi>a</mi><mi>j</mi></msub></math> and <math id="S5.SS1.SSS3.p2.m6" class="ltx_Math" alttext="a_{m}" display="inline"><msub><mi>a</mi><mi>m</mi></msub></math> and not cause any conflict.
Since the number of activities in <math id="S5.SS1.SSS3.p2.m7" class="ltx_Math" alttext="A_{k}" display="inline"><msub><mi>A</mi><mi>k</mi></msub></math> does not change, the new set is still a maximum-size subset of mutually compatible activities in <math id="S5.SS1.SSS3.p2.m8" class="ltx_Math" alttext="S_{k}" display="inline"><msub><mi>S</mi><mi>k</mi></msub></math>.</p>
</div>
</section>
</section>
<section id="S5.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.2 </span>General Scheme of Greedy Algorithms</h3>

<div id="S5.SS2.p1" class="ltx_para ltx_noindent">
<ol id="S5.I1" class="ltx_enumerate">
<li id="S5.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1.</span> 
<div id="S5.I1.i1.p1" class="ltx_para ltx_noindent">
<p class="ltx_p">Cast the optimization problem as one in which we make a choice and are left with one subproblem to solve.</p>
</div>
</li>
<li id="S5.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">2.</span> 
<div id="S5.I1.i2.p1" class="ltx_para ltx_noindent">
<p class="ltx_p">Prove that there is always an optimal solution to the original problem that makes the greedy choice, so that the greedy choice is always safe.</p>
</div>
</li>
</ol>
</div>
</section>
<section id="S5.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.3 </span>Coin Changing</h3>

<div id="S5.SS3.p1" class="ltx_para ltx_noindent">
<p class="ltx_p">Given a set of coins <math id="S5.SS3.p1.m1" class="ltx_Math" alttext="S=\{v_{1},v_{2},\dots,v_{n}\}" display="inline"><mrow><mi>S</mi><mo>=</mo><mrow><mo stretchy="false">{</mo><msub><mi>v</mi><mn>1</mn></msub><mo>,</mo><msub><mi>v</mi><mn>2</mn></msub><mo>,</mo><mi mathvariant="normal">…</mi><mo>,</mo><msub><mi>v</mi><mi>n</mi></msub><mo stretchy="false">}</mo></mrow></mrow></math>, where <math id="S5.SS3.p1.m2" class="ltx_Math" alttext="v_{1}&lt;v_{2}&lt;\dots&lt;v_{n}" display="inline"><mrow><msub><mi>v</mi><mn>1</mn></msub><mo>&lt;</mo><msub><mi>v</mi><mn>2</mn></msub><mo>&lt;</mo><mi mathvariant="normal">⋯</mi><mo>&lt;</mo><msub><mi>v</mi><mi>n</mi></msub></mrow></math>, and a value <math id="S5.SS3.p1.m3" class="ltx_Math" alttext="V" display="inline"><mi>V</mi></math>, we want to find the minimum number of coins that sum to <math id="S5.SS3.p1.m4" class="ltx_Math" alttext="V" display="inline"><mi>V</mi></math>.
This problem does not always have a greedy solution.</p>
</div>
<div id="S5.SS3.p2" class="ltx_para ltx_noindent">
<p class="ltx_p">The usual greedy choice is to choose the largest coin that does not exceed the remaining value.
This sometimes fails, for example: <math id="S5.SS3.p2.m1" class="ltx_Math" alttext="S=\{1,3,4\}" display="inline"><mrow><mi>S</mi><mo>=</mo><mrow><mo stretchy="false">{</mo><mn>1</mn><mo>,</mo><mn>3</mn><mo>,</mo><mn>4</mn><mo stretchy="false">}</mo></mrow></mrow></math>, <math id="S5.SS3.p2.m2" class="ltx_Math" alttext="V=6" display="inline"><mrow><mi>V</mi><mo>=</mo><mn>6</mn></mrow></math>.
The greedy algorithm will choose <math id="S5.SS3.p2.m3" class="ltx_Math" alttext="4,1,1" display="inline"><mrow><mn>4</mn><mo>,</mo><mn>1</mn><mo>,</mo><mn>1</mn></mrow></math>, but the optimal solution is <math id="S5.SS3.p2.m4" class="ltx_Math" alttext="3,3" display="inline"><mrow><mn>3</mn><mo>,</mo><mn>3</mn></mrow></math>.</p>
</div>
</section>
<section id="S5.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.4 </span>When Greedy Algorithms Fail</h3>

<div id="S5.SS4.p1" class="ltx_para ltx_noindent">
<p class="ltx_p">There are many cases when greedy algorithms fail.
For example: maze problem, traveling salesman problem, 0-1 knapsack problem, etc.</p>
</div>
<div id="S5.SS4.p2" class="ltx_para ltx_noindent">
<p class="ltx_p">Take 0-1 knapsack problem as an example.
If we have a knapsack with capacity 50 and three items:</p>
<ul id="S5.I2" class="ltx_itemize">
<li id="S5.I2.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S5.I2.i1.p1" class="ltx_para ltx_noindent">
<p class="ltx_p">Item 1: <math id="S5.I2.i1.p1.m1" class="ltx_Math" alttext="v_{1}=60" display="inline"><mrow><msub><mi>v</mi><mn>1</mn></msub><mo>=</mo><mn>60</mn></mrow></math>, <math id="S5.I2.i1.p1.m2" class="ltx_Math" alttext="w_{1}=10" display="inline"><mrow><msub><mi>w</mi><mn>1</mn></msub><mo>=</mo><mn>10</mn></mrow></math></p>
</div>
</li>
<li id="S5.I2.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S5.I2.i2.p1" class="ltx_para ltx_noindent">
<p class="ltx_p">Item 2: <math id="S5.I2.i2.p1.m1" class="ltx_Math" alttext="v_{2}=100" display="inline"><mrow><msub><mi>v</mi><mn>2</mn></msub><mo>=</mo><mn>100</mn></mrow></math>, <math id="S5.I2.i2.p1.m2" class="ltx_Math" alttext="w_{2}=20" display="inline"><mrow><msub><mi>w</mi><mn>2</mn></msub><mo>=</mo><mn>20</mn></mrow></math></p>
</div>
</li>
<li id="S5.I2.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S5.I2.i3.p1" class="ltx_para ltx_noindent">
<p class="ltx_p">Item 3: <math id="S5.I2.i3.p1.m1" class="ltx_Math" alttext="v_{3}=120" display="inline"><mrow><msub><mi>v</mi><mn>3</mn></msub><mo>=</mo><mn>120</mn></mrow></math>, <math id="S5.I2.i3.p1.m2" class="ltx_Math" alttext="w_{3}=30" display="inline"><mrow><msub><mi>w</mi><mn>3</mn></msub><mo>=</mo><mn>30</mn></mrow></math></p>
</div>
</li>
</ul>
</div>
<div id="S5.SS4.p3" class="ltx_para ltx_noindent">
<p class="ltx_p">If the greedy choice is to choose the item with the largest value per unit weight, then we will choose item 1 and 2, and the total value is 160.
However, the optimal solution is to choose item 2 and 3, and the total value is 220.</p>
</div>
<div id="S5.SS4.p4" class="ltx_para ltx_noindent">
<p class="ltx_p">It should be noted that the <span class="ltx_text ltx_font_bold">fractional knapsack problem</span> does have a greedy solution.</p>
</div>
</section>
</section>
<section id="S6" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Graph Algorithms</h2>

<div id="S6.p1" class="ltx_para ltx_noindent">
<p class="ltx_p">We usually use two ways to represent a graph: adjacency list and adjacency matrix.
To choose which representation to use, we need to consider the density of the graph.
A graph is <span class="ltx_text ltx_font_bold">sparse</span> if <math id="S6.p1.m1" class="ltx_Math" alttext="|E|=o(|V|^{2})" display="inline"><mrow><mrow><mo stretchy="false">|</mo><mi>E</mi><mo stretchy="false">|</mo></mrow><mo>=</mo><mrow><mi>o</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><msup><mrow><mo stretchy="false">|</mo><mi>V</mi><mo stretchy="false">|</mo></mrow><mn>2</mn></msup><mo stretchy="false">)</mo></mrow></mrow></mrow></math>, and <span class="ltx_text ltx_font_bold">dense</span> if <math id="S6.p1.m2" class="ltx_Math" alttext="|E|=\Theta(|V|^{2})" display="inline"><mrow><mrow><mo stretchy="false">|</mo><mi>E</mi><mo stretchy="false">|</mo></mrow><mo>=</mo><mrow><mi mathvariant="normal">Θ</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><msup><mrow><mo stretchy="false">|</mo><mi>V</mi><mo stretchy="false">|</mo></mrow><mn>2</mn></msup><mo stretchy="false">)</mo></mrow></mrow></mrow></math>.
For sparse graphs, we use adjacency list, and for dense graphs, we use adjacency matrix.</p>
</div>
<section id="S6.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.1 </span>Breadth First Search</h3>

<div id="S6.SS1.p1" class="ltx_para ltx_noindent">
<p class="ltx_p">In breadth first search, we use a queue to store the vertices.
We extract a vertex from the queue, and then add all its adjacent vertices to the queue.</p>
</div>
<div id="S6.SS1.p2" class="ltx_para ltx_noindent">
<p class="ltx_p">We assign each vertex a color: white, gray, or black.</p>
<ul id="S6.I1" class="ltx_itemize">
<li id="S6.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S6.I1.i1.p1" class="ltx_para ltx_noindent">
<p class="ltx_p">White: undiscovered.</p>
</div>
</li>
<li id="S6.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S6.I1.i2.p1" class="ltx_para ltx_noindent">
<p class="ltx_p">Gray: discovered but not finished.</p>
</div>
</li>
<li id="S6.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S6.I1.i3.p1" class="ltx_para ltx_noindent">
<p class="ltx_p">Black: finished.</p>
</div>
</li>
</ul>
<p class="ltx_p"><span class="ltx_text ltx_font_italic">It is worth noting that the two colors gray and black are not necessary and can be combined into one color.
The difference is purely for the purpose of analysis.</span></p>
</div>
<div id="S6.SS1.p3" class="ltx_para ltx_noindent">
<p class="ltx_p">Each vertex has three attributes: distance, parent, and color.</p>
</div>
<div id="S6.SS1.p4" class="ltx_para ltx_align_center">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr class="ltx_tr">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" colspan="2"><span class="ltx_text ltx_font_smallcaps">BFS<math id="S6.SS1.p4.m1" class="ltx_Math" alttext="(G,s)" display="inline"><mrow><mo mathvariant="normal" stretchy="false">(</mo><mi>G</mi><mo mathvariant="normal">,</mo><mi>s</mi><mo mathvariant="normal" stretchy="false">)</mo></mrow></math></span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_t">1.</th>
<td class="ltx_td ltx_align_left ltx_border_t">
<span class="ltx_text ltx_font_bold">for</span> each vertex <math id="S6.SS1.p4.m2" class="ltx_Math" alttext="u\in G.V-\{s\}" display="inline"><mrow><mrow><mi>u</mi><mo>∈</mo><mi>G</mi></mrow><mo>.</mo><mrow><mi>V</mi><mo>-</mo><mrow><mo stretchy="false">{</mo><mi>s</mi><mo stretchy="false">}</mo></mrow></mrow></mrow></math>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">2.</th>
<td class="ltx_td ltx_align_left"> <math id="S6.SS1.p4.m3" class="ltx_Math" alttext="u.color=WHITE" display="inline"><mrow><mi>u</mi><mo>.</mo><mrow><mrow><mi>c</mi><mo>⁢</mo><mi>o</mi><mo>⁢</mo><mi>l</mi><mo>⁢</mo><mi>o</mi><mo>⁢</mo><mi>r</mi></mrow><mo>=</mo><mrow><mi>W</mi><mo>⁢</mo><mi>H</mi><mo>⁢</mo><mi>I</mi><mo>⁢</mo><mi>T</mi><mo>⁢</mo><mi>E</mi></mrow></mrow></mrow></math>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">3.</th>
<td class="ltx_td ltx_align_left"> <math id="S6.SS1.p4.m4" class="ltx_Math" alttext="u.d=\infty" display="inline"><mrow><mi>u</mi><mo>.</mo><mrow><mi>d</mi><mo>=</mo><mi mathvariant="normal">∞</mi></mrow></mrow></math>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">4.</th>
<td class="ltx_td ltx_align_left"> <math id="S6.SS1.p4.m5" class="ltx_Math" alttext="u.\pi=NIL" display="inline"><mrow><mi>u</mi><mo>.</mo><mrow><mi>π</mi><mo>=</mo><mrow><mi>N</mi><mo>⁢</mo><mi>I</mi><mo>⁢</mo><mi>L</mi></mrow></mrow></mrow></math>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">5.</th>
<td class="ltx_td ltx_align_left"><math id="S6.SS1.p4.m6" class="ltx_Math" alttext="s.color=GRAY" display="inline"><mrow><mi>s</mi><mo>.</mo><mrow><mrow><mi>c</mi><mo>⁢</mo><mi>o</mi><mo>⁢</mo><mi>l</mi><mo>⁢</mo><mi>o</mi><mo>⁢</mo><mi>r</mi></mrow><mo>=</mo><mrow><mi>G</mi><mo>⁢</mo><mi>R</mi><mo>⁢</mo><mi>A</mi><mo>⁢</mo><mi>Y</mi></mrow></mrow></mrow></math></td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">6.</th>
<td class="ltx_td ltx_align_left"><math id="S6.SS1.p4.m7" class="ltx_Math" alttext="s.d=0" display="inline"><mrow><mi>s</mi><mo>.</mo><mrow><mi>d</mi><mo>=</mo><mn>0</mn></mrow></mrow></math></td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">7.</th>
<td class="ltx_td ltx_align_left"><math id="S6.SS1.p4.m8" class="ltx_Math" alttext="s.\pi=NIL" display="inline"><mrow><mi>s</mi><mo>.</mo><mrow><mi>π</mi><mo>=</mo><mrow><mi>N</mi><mo>⁢</mo><mi>I</mi><mo>⁢</mo><mi>L</mi></mrow></mrow></mrow></math></td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">8.</th>
<td class="ltx_td ltx_align_left"><math id="S6.SS1.p4.m9" class="ltx_Math" alttext="Q=\emptyset" display="inline"><mrow><mi>Q</mi><mo>=</mo><mi mathvariant="normal">∅</mi></mrow></math></td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">9.</th>
<td class="ltx_td ltx_align_left"><span class="ltx_text ltx_font_smallcaps">Enqueue<math id="S6.SS1.p4.m10" class="ltx_Math" alttext="(Q,s)" display="inline"><mrow><mo mathvariant="normal" stretchy="false">(</mo><mi>Q</mi><mo mathvariant="normal">,</mo><mi>s</mi><mo mathvariant="normal" stretchy="false">)</mo></mrow></math></span></td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">10.</th>
<td class="ltx_td ltx_align_left">
<span class="ltx_text ltx_font_bold">while</span> <math id="S6.SS1.p4.m11" class="ltx_Math" alttext="Q\neq\emptyset" display="inline"><mrow><mi>Q</mi><mo>≠</mo><mi mathvariant="normal">∅</mi></mrow></math>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">11.</th>
<td class="ltx_td ltx_align_left"> <math id="S6.SS1.p4.m12" class="ltx_Math" alttext="u=\textsc{Dequeue}(Q)" display="inline"><mrow><mi>u</mi><mo>=</mo><mrow><mtext class="ltx_font_smallcaps" mathvariant="normal">Dequeue</mtext><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>Q</mi><mo stretchy="false">)</mo></mrow></mrow></mrow></math>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">12.</th>
<td class="ltx_td ltx_align_left"> <span class="ltx_text ltx_font_bold">for</span> each vertex <math id="S6.SS1.p4.m13" class="ltx_Math" alttext="v\in G.Adj[u]" display="inline"><mrow><mrow><mi>v</mi><mo>∈</mo><mi>G</mi></mrow><mo>.</mo><mrow><mi>A</mi><mo>⁢</mo><mi>d</mi><mo>⁢</mo><mi>j</mi><mo>⁢</mo><mrow><mo stretchy="false">[</mo><mi>u</mi><mo stretchy="false">]</mo></mrow></mrow></mrow></math>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">13.</th>
<td class="ltx_td ltx_align_left">  <span class="ltx_text ltx_font_bold">if</span> <math id="S6.SS1.p4.m14" class="ltx_Math" alttext="v.color==WHITE" display="inline"><mrow><mi>v</mi><mo>.</mo><mi>c</mi><mi>o</mi><mi>l</mi><mi>o</mi><mi>r</mi><mo>=</mo><mo>=</mo><mi>W</mi><mi>H</mi><mi>I</mi><mi>T</mi><mi>E</mi></mrow></math>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">14.</th>
<td class="ltx_td ltx_align_left">   <math id="S6.SS1.p4.m15" class="ltx_Math" alttext="v.color=GRAY" display="inline"><mrow><mi>v</mi><mo>.</mo><mrow><mrow><mi>c</mi><mo>⁢</mo><mi>o</mi><mo>⁢</mo><mi>l</mi><mo>⁢</mo><mi>o</mi><mo>⁢</mo><mi>r</mi></mrow><mo>=</mo><mrow><mi>G</mi><mo>⁢</mo><mi>R</mi><mo>⁢</mo><mi>A</mi><mo>⁢</mo><mi>Y</mi></mrow></mrow></mrow></math>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">15.</th>
<td class="ltx_td ltx_align_left">   <math id="S6.SS1.p4.m16" class="ltx_Math" alttext="v.d=u.d+1" display="inline"><mrow><mi>v</mi><mo>.</mo><mrow><mi>d</mi><mo>=</mo><mi>u</mi></mrow><mo>.</mo><mrow><mi>d</mi><mo>+</mo><mn>1</mn></mrow></mrow></math>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">16.</th>
<td class="ltx_td ltx_align_left">   <math id="S6.SS1.p4.m17" class="ltx_Math" alttext="v.\pi=u" display="inline"><mrow><mi>v</mi><mo>.</mo><mrow><mi>π</mi><mo>=</mo><mi>u</mi></mrow></mrow></math>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">17.</th>
<td class="ltx_td ltx_align_left">   <span class="ltx_text ltx_font_smallcaps">Enqueue<math id="S6.SS1.p4.m18" class="ltx_Math" alttext="(Q,v)" display="inline"><mrow><mo mathvariant="normal" stretchy="false">(</mo><mi>Q</mi><mo mathvariant="normal">,</mo><mi>v</mi><mo mathvariant="normal" stretchy="false">)</mo></mrow></math></span>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_bb">18.</th>
<td class="ltx_td ltx_align_left ltx_border_bb"> <math id="S6.SS1.p4.m19" class="ltx_Math" alttext="u.color=BLACK" display="inline"><mrow><mi>u</mi><mo>.</mo><mrow><mrow><mi>c</mi><mo>⁢</mo><mi>o</mi><mo>⁢</mo><mi>l</mi><mo>⁢</mo><mi>o</mi><mo>⁢</mo><mi>r</mi></mrow><mo>=</mo><mrow><mi>B</mi><mo>⁢</mo><mi>L</mi><mo>⁢</mo><mi>A</mi><mo>⁢</mo><mi>C</mi><mo>⁢</mo><mi>K</mi></mrow></mrow></mrow></math>
</td>
</tr>
</tbody>
</table>
</div>
<div id="S6.SS1.p5" class="ltx_para ltx_noindent">
<p class="ltx_p"><span class="ltx_text ltx_font_bold">Runtime:</span>
<math id="S6.SS1.p5.m1" class="ltx_Math" alttext="O(|V|+|E|)" display="inline"><mrow><mi>O</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mrow><mo stretchy="false">|</mo><mi>V</mi><mo stretchy="false">|</mo></mrow><mo>+</mo><mrow><mo stretchy="false">|</mo><mi>E</mi><mo stretchy="false">|</mo></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow></math>.
This is because each vertex is enqueued and dequeued at most once, which takes <math id="S6.SS1.p5.m2" class="ltx_Math" alttext="O(|V|)" display="inline"><mrow><mi>O</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mo stretchy="false">|</mo><mi>V</mi><mo stretchy="false">|</mo></mrow><mo stretchy="false">)</mo></mrow></mrow></math> time.
Each edge is examined at most twice, which takes <math id="S6.SS1.p5.m3" class="ltx_Math" alttext="O(|E|)" display="inline"><mrow><mi>O</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mo stretchy="false">|</mo><mi>E</mi><mo stretchy="false">|</mo></mrow><mo stretchy="false">)</mo></mrow></mrow></math> time (assume we use adjacency list).
</p>
</div>
<div id="S6.SS1.p6" class="ltx_para ltx_noindent">
<p class="ltx_p"><span class="ltx_text ltx_font_bold">Correctness:</span>
The loop invariant is:
At the start of each iteration of the while loop, the queue <math id="S6.SS1.p6.m1" class="ltx_Math" alttext="Q" display="inline"><mi>Q</mi></math> contains all the vertices that are gray.
However by the loop invariant only, we cannot prove the correctness of the algorithm.</p>
</div>
<div id="S6.SS1.p7" class="ltx_para ltx_noindent">
<p class="ltx_p">We can prove the correctness by using the following facts:</p>
<ul id="S6.I2" class="ltx_itemize">
<li id="S6.I2.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S6.I2.i1.p1" class="ltx_para ltx_noindent">
<p class="ltx_p"><span class="ltx_text ltx_font_italic">Let the length of the shortest path from <math id="S6.I2.i1.p1.m1" class="ltx_Math" alttext="s" display="inline"><mi>s</mi></math> to <math id="S6.I2.i1.p1.m2" class="ltx_Math" alttext="u" display="inline"><mi>u</mi></math> be <math id="S6.I2.i1.p1.m3" class="ltx_Math" alttext="d(s,u)" display="inline"><mrow><mi>d</mi><mo mathvariant="italic">⁢</mo><mrow><mo mathvariant="normal" stretchy="false">(</mo><mi>s</mi><mo mathvariant="normal">,</mo><mi>u</mi><mo mathvariant="normal" stretchy="false">)</mo></mrow></mrow></math>.
Then for a graph <math id="S6.I2.i1.p1.m4" class="ltx_Math" alttext="G=(V,E)" display="inline"><mrow><mi>G</mi><mo mathvariant="normal">=</mo><mrow><mo mathvariant="normal" stretchy="false">(</mo><mi>V</mi><mo mathvariant="normal">,</mo><mi>E</mi><mo mathvariant="normal" stretchy="false">)</mo></mrow></mrow></math>, if an edge <math id="S6.I2.i1.p1.m5" class="ltx_Math" alttext="(u,v)\in E" display="inline"><mrow><mrow><mo mathvariant="normal" stretchy="false">(</mo><mi>u</mi><mo mathvariant="normal">,</mo><mi>v</mi><mo mathvariant="normal" stretchy="false">)</mo></mrow><mo mathvariant="normal">∈</mo><mi>E</mi></mrow></math>, then <math id="S6.I2.i1.p1.m6" class="ltx_Math" alttext="d(s,v)\leq d(s,u)+1" display="inline"><mrow><mrow><mi>d</mi><mo mathvariant="italic">⁢</mo><mrow><mo mathvariant="normal" stretchy="false">(</mo><mi>s</mi><mo mathvariant="normal">,</mo><mi>v</mi><mo mathvariant="normal" stretchy="false">)</mo></mrow></mrow><mo mathvariant="normal">≤</mo><mrow><mrow><mi>d</mi><mo mathvariant="italic">⁢</mo><mrow><mo mathvariant="normal" stretchy="false">(</mo><mi>s</mi><mo mathvariant="normal">,</mo><mi>u</mi><mo mathvariant="normal" stretchy="false">)</mo></mrow></mrow><mo mathvariant="normal">+</mo><mn mathvariant="normal">1</mn></mrow></mrow></math>.</span>
This is true because the shortest path from <math id="S6.I2.i1.p1.m7" class="ltx_Math" alttext="s" display="inline"><mi>s</mi></math> to <math id="S6.I2.i1.p1.m8" class="ltx_Math" alttext="v" display="inline"><mi>v</mi></math> cannot be longer than the shortest path from <math id="S6.I2.i1.p1.m9" class="ltx_Math" alttext="s" display="inline"><mi>s</mi></math> to <math id="S6.I2.i1.p1.m10" class="ltx_Math" alttext="u" display="inline"><mi>u</mi></math> plus the edge <math id="S6.I2.i1.p1.m11" class="ltx_Math" alttext="(u,v)" display="inline"><mrow><mo stretchy="false">(</mo><mi>u</mi><mo>,</mo><mi>v</mi><mo stretchy="false">)</mo></mrow></math>.</p>
</div>
</li>
<li id="S6.I2.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S6.I2.i2.p1" class="ltx_para ltx_noindent">
<p class="ltx_p"><span class="ltx_text ltx_font_italic">When the breadth first search ends, for each vertex <math id="S6.I2.i2.p1.m1" class="ltx_Math" alttext="v\in V" display="inline"><mrow><mi>v</mi><mo mathvariant="normal">∈</mo><mi>V</mi></mrow></math>, <math id="S6.I2.i2.p1.m2" class="ltx_Math" alttext="v.d\geq d(s,v)" display="inline"><mrow><mi>v</mi><mo mathvariant="normal">.</mo><mrow><mi>d</mi><mo mathvariant="normal">≥</mo><mrow><mi>d</mi><mo mathvariant="italic">⁢</mo><mrow><mo mathvariant="normal" stretchy="false">(</mo><mi>s</mi><mo mathvariant="normal">,</mo><mi>v</mi><mo mathvariant="normal" stretchy="false">)</mo></mrow></mrow></mrow></mrow></math>.</span>
This can be proved by induction.
The base case is trivial.
For the inductive step, we can find on line 15 that <math id="S6.I2.i2.p1.m3" class="ltx_Math" alttext="v.d=u.d+1" display="inline"><mrow><mi>v</mi><mo>.</mo><mrow><mi>d</mi><mo>=</mo><mi>u</mi></mrow><mo>.</mo><mrow><mi>d</mi><mo>+</mo><mn>1</mn></mrow></mrow></math>.
Together with the fact that <math id="S6.I2.i2.p1.m4" class="ltx_Math" alttext="u.d\geq d(s,u)" display="inline"><mrow><mi>u</mi><mo>.</mo><mrow><mi>d</mi><mo>≥</mo><mrow><mi>d</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>s</mi><mo>,</mo><mi>u</mi><mo stretchy="false">)</mo></mrow></mrow></mrow></mrow></math>, we have <math id="S6.I2.i2.p1.m5" class="ltx_Math" alttext="v.d=u.d+1\geq d(s,u)+1\geq d(s,v)" display="inline"><mrow><mi>v</mi><mo>.</mo><mrow><mi>d</mi><mo>=</mo><mi>u</mi></mrow><mo>.</mo><mrow><mrow><mi>d</mi><mo>+</mo><mn>1</mn></mrow><mo>≥</mo><mrow><mrow><mi>d</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>s</mi><mo>,</mo><mi>u</mi><mo stretchy="false">)</mo></mrow></mrow><mo>+</mo><mn>1</mn></mrow><mo>≥</mo><mrow><mi>d</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>s</mi><mo>,</mo><mi>v</mi><mo stretchy="false">)</mo></mrow></mrow></mrow></mrow></math>.</p>
</div>
</li>
<li id="S6.I2.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S6.I2.i3.p1" class="ltx_para ltx_noindent">
<p class="ltx_p"><span class="ltx_text ltx_font_italic">Suppose the first vertex in the queue is <math id="S6.I2.i3.p1.m1" class="ltx_Math" alttext="v_{1}" display="inline"><msub><mi>v</mi><mn mathvariant="normal">1</mn></msub></math> and the last vertex in the queue is <math id="S6.I2.i3.p1.m2" class="ltx_Math" alttext="v_{k}" display="inline"><msub><mi>v</mi><mi>k</mi></msub></math>.
Then for each <math id="S6.I2.i3.p1.m3" class="ltx_Math" alttext="i=2,3,\dots,k" display="inline"><mrow><mi>i</mi><mo mathvariant="normal">=</mo><mrow><mn mathvariant="normal">2</mn><mo mathvariant="normal">,</mo><mn mathvariant="normal">3</mn><mo mathvariant="normal">,</mo><mi mathvariant="normal">…</mi><mo mathvariant="normal">,</mo><mi>k</mi></mrow></mrow></math>, <math id="S6.I2.i3.p1.m4" class="ltx_Math" alttext="v_{i}.d\geq v_{i-1}.d" display="inline"><mrow><msub><mi>v</mi><mi>i</mi></msub><mo mathvariant="normal">.</mo><mrow><mi>d</mi><mo mathvariant="normal">≥</mo><msub><mi>v</mi><mrow><mi>i</mi><mo mathvariant="normal">-</mo><mn mathvariant="normal">1</mn></mrow></msub></mrow><mo mathvariant="normal">.</mo><mi>d</mi></mrow></math> and <math id="S6.I2.i3.p1.m5" class="ltx_Math" alttext="v_{k}.d\leq v_{1}.d+1" display="inline"><mrow><msub><mi>v</mi><mi>k</mi></msub><mo mathvariant="normal">.</mo><mrow><mi>d</mi><mo mathvariant="normal">≤</mo><msub><mi>v</mi><mn mathvariant="normal">1</mn></msub></mrow><mo mathvariant="normal">.</mo><mrow><mi>d</mi><mo mathvariant="normal">+</mo><mn mathvariant="normal">1</mn></mrow></mrow></math>.</span>
This can be proved by induction.
The base case is trivial.
When we dequeue <math id="S6.I2.i3.p1.m6" class="ltx_Math" alttext="v_{1}" display="inline"><msub><mi>v</mi><mn>1</mn></msub></math>, by the inductive hypothesis, we have <math id="S6.I2.i3.p1.m7" class="ltx_Math" alttext="v_{2}.d\geq v_{1}.d" display="inline"><mrow><msub><mi>v</mi><mn>2</mn></msub><mo>.</mo><mrow><mi>d</mi><mo>≥</mo><msub><mi>v</mi><mn>1</mn></msub></mrow><mo>.</mo><mi>d</mi></mrow></math>.
Then we can find <math id="S6.I2.i3.p1.m8" class="ltx_Math" alttext="v_{k}.d\leq v_{1}.d+1\leq v_{2}.d+1" display="inline"><mrow><msub><mi>v</mi><mi>k</mi></msub><mo>.</mo><mrow><mi>d</mi><mo>≤</mo><msub><mi>v</mi><mn>1</mn></msub></mrow><mo>.</mo><mrow><mrow><mi>d</mi><mo>+</mo><mn>1</mn></mrow><mo>≤</mo><msub><mi>v</mi><mn>2</mn></msub></mrow><mo>.</mo><mrow><mi>d</mi><mo>+</mo><mn>1</mn></mrow></mrow></math>.
When we enqueue <math id="S6.I2.i3.p1.m9" class="ltx_Math" alttext="v_{k+1}" display="inline"><msub><mi>v</mi><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msub></math>, let the current processing vertex be <math id="S6.I2.i3.p1.m10" class="ltx_Math" alttext="u" display="inline"><mi>u</mi></math>.
By the inductive hypothesis, we have <math id="S6.I2.i3.p1.m11" class="ltx_Math" alttext="v_{k+1}.d=u.d+1\leq v_{1}.d+1" display="inline"><mrow><msub><mi>v</mi><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>.</mo><mrow><mi>d</mi><mo>=</mo><mi>u</mi></mrow><mo>.</mo><mrow><mrow><mi>d</mi><mo>+</mo><mn>1</mn></mrow><mo>≤</mo><msub><mi>v</mi><mn>1</mn></msub></mrow><mo>.</mo><mrow><mi>d</mi><mo>+</mo><mn>1</mn></mrow></mrow></math>.
Also, <math id="S6.I2.i3.p1.m12" class="ltx_Math" alttext="v_{k}\leq u.d+1=v_{k+1}.d" display="inline"><mrow><mrow><msub><mi>v</mi><mi>k</mi></msub><mo>≤</mo><mi>u</mi></mrow><mo>.</mo><mrow><mrow><mi>d</mi><mo>+</mo><mn>1</mn></mrow><mo>=</mo><msub><mi>v</mi><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><mo>.</mo><mi>d</mi></mrow></math>.
</p>
</div>
</li>
<li id="S6.I2.i4" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S6.I2.i4.p1" class="ltx_para ltx_noindent">
<p class="ltx_p"><span class="ltx_text ltx_font_italic">Suppose <math id="S6.I2.i4.p1.m1" class="ltx_Math" alttext="v_{i}" display="inline"><msub><mi>v</mi><mi>i</mi></msub></math> and <math id="S6.I2.i4.p1.m2" class="ltx_Math" alttext="v_{j}" display="inline"><msub><mi>v</mi><mi>j</mi></msub></math> are two vertices in the queue, and <math id="S6.I2.i4.p1.m3" class="ltx_Math" alttext="v_{i}" display="inline"><msub><mi>v</mi><mi>i</mi></msub></math> is enqueued before <math id="S6.I2.i4.p1.m4" class="ltx_Math" alttext="v_{j}" display="inline"><msub><mi>v</mi><mi>j</mi></msub></math>.
Then <math id="S6.I2.i4.p1.m5" class="ltx_Math" alttext="v_{i}.d\leq v_{j}.d" display="inline"><mrow><msub><mi>v</mi><mi>i</mi></msub><mo mathvariant="normal">.</mo><mrow><mi>d</mi><mo mathvariant="normal">≤</mo><msub><mi>v</mi><mi>j</mi></msub></mrow><mo mathvariant="normal">.</mo><mi>d</mi></mrow></math>.</span>
This can be proved by the last fact.</p>
</div>
</li>
<li id="S6.I2.i5" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S6.I2.i5.p1" class="ltx_para ltx_noindent">
<p class="ltx_p"><span class="ltx_text ltx_font_italic">If <math id="S6.I2.i5.p1.m1" class="ltx_Math" alttext="v" display="inline"><mi>v</mi></math> and <math id="S6.I2.i5.p1.m2" class="ltx_Math" alttext="u" display="inline"><mi>u</mi></math> are neighbors, then <math id="S6.I2.i5.p1.m3" class="ltx_Math" alttext="v.d\leq u.d+1" display="inline"><mrow><mi>v</mi><mo mathvariant="normal">.</mo><mrow><mi>d</mi><mo mathvariant="normal">≤</mo><mi>u</mi></mrow><mo mathvariant="normal">.</mo><mrow><mi>d</mi><mo mathvariant="normal">+</mo><mn mathvariant="normal">1</mn></mrow></mrow></math>.</span>
When <math id="S6.I2.i5.p1.m4" class="ltx_Math" alttext="u" display="inline"><mi>u</mi></math> is dequeued:</p>
<ul id="S6.I2.i5.I1" class="ltx_itemize">
<li id="S6.I2.i5.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"><span class="ltx_text ltx_font_bold">–</span></span> 
<div id="S6.I2.i5.I1.i1.p1" class="ltx_para ltx_noindent">
<p class="ltx_p">If <math id="S6.I2.i5.I1.i1.p1.m1" class="ltx_Math" alttext="v" display="inline"><mi>v</mi></math> is white, then <math id="S6.I2.i5.I1.i1.p1.m2" class="ltx_Math" alttext="v" display="inline"><mi>v</mi></math> is enqueued, and <math id="S6.I2.i5.I1.i1.p1.m3" class="ltx_Math" alttext="v.d=u.d+1" display="inline"><mrow><mi>v</mi><mo>.</mo><mrow><mi>d</mi><mo>=</mo><mi>u</mi></mrow><mo>.</mo><mrow><mi>d</mi><mo>+</mo><mn>1</mn></mrow></mrow></math>.</p>
</div>
</li>
<li id="S6.I2.i5.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"><span class="ltx_text ltx_font_bold">–</span></span> 
<div id="S6.I2.i5.I1.i2.p1" class="ltx_para ltx_noindent">
<p class="ltx_p">If <math id="S6.I2.i5.I1.i2.p1.m1" class="ltx_Math" alttext="v" display="inline"><mi>v</mi></math> is gray, then by fact 3, <math id="S6.I2.i5.I1.i2.p1.m2" class="ltx_Math" alttext="v.d\leq u.d+1" display="inline"><mrow><mi>v</mi><mo>.</mo><mrow><mi>d</mi><mo>≤</mo><mi>u</mi></mrow><mo>.</mo><mrow><mi>d</mi><mo>+</mo><mn>1</mn></mrow></mrow></math>.</p>
</div>
</li>
<li id="S6.I2.i5.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"><span class="ltx_text ltx_font_bold">–</span></span> 
<div id="S6.I2.i5.I1.i3.p1" class="ltx_para ltx_noindent">
<p class="ltx_p">If <math id="S6.I2.i5.I1.i3.p1.m1" class="ltx_Math" alttext="v" display="inline"><mi>v</mi></math> is black, then <math id="S6.I2.i5.I1.i3.p1.m2" class="ltx_Math" alttext="v" display="inline"><mi>v</mi></math> is enqueued before <math id="S6.I2.i5.I1.i3.p1.m3" class="ltx_Math" alttext="u" display="inline"><mi>u</mi></math>, and by fact 4, <math id="S6.I2.i5.I1.i3.p1.m4" class="ltx_Math" alttext="v.d\leq u.d" display="inline"><mrow><mi>v</mi><mo>.</mo><mrow><mi>d</mi><mo>≤</mo><mi>u</mi></mrow><mo>.</mo><mi>d</mi></mrow></math>.</p>
</div>
</li>
</ul>
</div>
</li>
<li id="S6.I2.i6" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S6.I2.i6.p1" class="ltx_para ltx_noindent">
<p class="ltx_p"><span class="ltx_text ltx_font_italic">After the breadth first search ends, for each vertex <math id="S6.I2.i6.p1.m1" class="ltx_Math" alttext="v\in V" display="inline"><mrow><mi>v</mi><mo mathvariant="normal">∈</mo><mi>V</mi></mrow></math>, <math id="S6.I2.i6.p1.m2" class="ltx_Math" alttext="v.d" display="inline"><mrow><mi>v</mi><mo mathvariant="normal">.</mo><mi>d</mi></mrow></math> is the shortest path from <math id="S6.I2.i6.p1.m3" class="ltx_Math" alttext="s" display="inline"><mi>s</mi></math> to <math id="S6.I2.i6.p1.m4" class="ltx_Math" alttext="v" display="inline"><mi>v</mi></math>.</span>
This can be proved by contradiction.
Suppose a vertex <math id="S6.I2.i6.p1.m5" class="ltx_Math" alttext="v" display="inline"><mi>v</mi></math> has a shorter path from <math id="S6.I2.i6.p1.m6" class="ltx_Math" alttext="s" display="inline"><mi>s</mi></math> to <math id="S6.I2.i6.p1.m7" class="ltx_Math" alttext="v" display="inline"><mi>v</mi></math>, or to say <math id="S6.I2.i6.p1.m8" class="ltx_Math" alttext="v.d&gt;d(s,v)" display="inline"><mrow><mi>v</mi><mo>.</mo><mrow><mi>d</mi><mo>&gt;</mo><mrow><mi>d</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>s</mi><mo>,</mo><mi>v</mi><mo stretchy="false">)</mo></mrow></mrow></mrow></mrow></math>, and <math id="S6.I2.i6.p1.m9" class="ltx_Math" alttext="v" display="inline"><mi>v</mi></math> has the shortest mismatched path.
Then let vertex <math id="S6.I2.i6.p1.m10" class="ltx_Math" alttext="u" display="inline"><mi>u</mi></math> be the last vertex on the shortest path from <math id="S6.I2.i6.p1.m11" class="ltx_Math" alttext="s" display="inline"><mi>s</mi></math> to <math id="S6.I2.i6.p1.m12" class="ltx_Math" alttext="v" display="inline"><mi>v</mi></math>.
By the choice of <math id="S6.I2.i6.p1.m13" class="ltx_Math" alttext="v" display="inline"><mi>v</mi></math>, we have <math id="S6.I2.i6.p1.m14" class="ltx_Math" alttext="u.d+1=d(s,u)+1=d(s,v)&lt;v.d" display="inline"><mrow><mi>u</mi><mo>.</mo><mrow><mrow><mi>d</mi><mo>+</mo><mn>1</mn></mrow><mo>=</mo><mrow><mrow><mi>d</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>s</mi><mo>,</mo><mi>u</mi><mo stretchy="false">)</mo></mrow></mrow><mo>+</mo><mn>1</mn></mrow><mo>=</mo><mrow><mi>d</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>s</mi><mo>,</mo><mi>v</mi><mo stretchy="false">)</mo></mrow></mrow><mo>&lt;</mo><mi>v</mi></mrow><mo>.</mo><mi>d</mi></mrow></math>.
By fact 5, we have <math id="S6.I2.i6.p1.m15" class="ltx_Math" alttext="v.d\leq u.d+1" display="inline"><mrow><mi>v</mi><mo>.</mo><mrow><mi>d</mi><mo>≤</mo><mi>u</mi></mrow><mo>.</mo><mrow><mi>d</mi><mo>+</mo><mn>1</mn></mrow></mrow></math>, which contradicts the previous inequality.</p>
</div>
</li>
</ul>
</div>
<div id="S6.SS1.p8" class="ltx_para ltx_noindent">
<p class="ltx_p">The shortest path can be found by tracing back the parent pointers.
This means the breadth first search tree is a shortest path tree, and is a single source shortest path algorithm.</p>
</div>
</section>
<section id="S6.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.2 </span>Depth First Search</h3>

<div id="S6.SS2.p1" class="ltx_para ltx_noindent">
<p class="ltx_p">In depth first search, we use a stack to store the vertices.
Each vertex has four attributes: discovery time, finish time, parent, and color.</p>
</div>
<div id="S6.SS2.p2" class="ltx_para ltx_align_center">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr class="ltx_tr">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" colspan="2"><span class="ltx_text ltx_font_smallcaps">DFS<math id="S6.SS2.p2.m1" class="ltx_Math" alttext="(G)" display="inline"><mrow><mo mathvariant="normal" stretchy="false">(</mo><mi>G</mi><mo mathvariant="normal" stretchy="false">)</mo></mrow></math></span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_t">1.</th>
<td class="ltx_td ltx_align_left ltx_border_t">
<span class="ltx_text ltx_font_bold">for</span> each vertex <math id="S6.SS2.p2.m2" class="ltx_Math" alttext="u\in G.V" display="inline"><mrow><mrow><mi>u</mi><mo>∈</mo><mi>G</mi></mrow><mo>.</mo><mi>V</mi></mrow></math>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">2.</th>
<td class="ltx_td ltx_align_left"> <math id="S6.SS2.p2.m3" class="ltx_Math" alttext="u.color=WHITE" display="inline"><mrow><mi>u</mi><mo>.</mo><mrow><mrow><mi>c</mi><mo>⁢</mo><mi>o</mi><mo>⁢</mo><mi>l</mi><mo>⁢</mo><mi>o</mi><mo>⁢</mo><mi>r</mi></mrow><mo>=</mo><mrow><mi>W</mi><mo>⁢</mo><mi>H</mi><mo>⁢</mo><mi>I</mi><mo>⁢</mo><mi>T</mi><mo>⁢</mo><mi>E</mi></mrow></mrow></mrow></math>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">3.</th>
<td class="ltx_td ltx_align_left"> <math id="S6.SS2.p2.m4" class="ltx_Math" alttext="u.\pi=NIL" display="inline"><mrow><mi>u</mi><mo>.</mo><mrow><mi>π</mi><mo>=</mo><mrow><mi>N</mi><mo>⁢</mo><mi>I</mi><mo>⁢</mo><mi>L</mi></mrow></mrow></mrow></math>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">4.</th>
<td class="ltx_td ltx_align_left"><math id="S6.SS2.p2.m5" class="ltx_Math" alttext="time=0" display="inline"><mrow><mrow><mi>t</mi><mo>⁢</mo><mi>i</mi><mo>⁢</mo><mi>m</mi><mo>⁢</mo><mi>e</mi></mrow><mo>=</mo><mn>0</mn></mrow></math></td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">5.</th>
<td class="ltx_td ltx_align_left">
<span class="ltx_text ltx_font_bold">for</span> each vertex <math id="S6.SS2.p2.m6" class="ltx_Math" alttext="u\in G.V" display="inline"><mrow><mrow><mi>u</mi><mo>∈</mo><mi>G</mi></mrow><mo>.</mo><mi>V</mi></mrow></math>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">6.</th>
<td class="ltx_td ltx_align_left"> <span class="ltx_text ltx_font_bold">if</span> <math id="S6.SS2.p2.m7" class="ltx_Math" alttext="u.color==WHITE" display="inline"><mrow><mi>u</mi><mo>.</mo><mi>c</mi><mi>o</mi><mi>l</mi><mi>o</mi><mi>r</mi><mo>=</mo><mo>=</mo><mi>W</mi><mi>H</mi><mi>I</mi><mi>T</mi><mi>E</mi></mrow></math>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_bb">7.</th>
<td class="ltx_td ltx_align_left ltx_border_bb">  <span class="ltx_text ltx_font_smallcaps">DFS-Visit<math id="S6.SS2.p2.m8" class="ltx_Math" alttext="(G,u)" display="inline"><mrow><mo mathvariant="normal" stretchy="false">(</mo><mi>G</mi><mo mathvariant="normal">,</mo><mi>u</mi><mo mathvariant="normal" stretchy="false">)</mo></mrow></math></span>
</td>
</tr>
</tbody>
</table>
</div>
<div id="S6.SS2.p3" class="ltx_para ltx_align_center">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr class="ltx_tr">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" colspan="2"><span class="ltx_text ltx_font_smallcaps">DFS-Visit<math id="S6.SS2.p3.m1" class="ltx_Math" alttext="(G,u)" display="inline"><mrow><mo mathvariant="normal" stretchy="false">(</mo><mi>G</mi><mo mathvariant="normal">,</mo><mi>u</mi><mo mathvariant="normal" stretchy="false">)</mo></mrow></math></span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_t">1.</th>
<td class="ltx_td ltx_align_left ltx_border_t"><math id="S6.SS2.p3.m2" class="ltx_Math" alttext="time=time+1" display="inline"><mrow><mrow><mi>t</mi><mo>⁢</mo><mi>i</mi><mo>⁢</mo><mi>m</mi><mo>⁢</mo><mi>e</mi></mrow><mo>=</mo><mrow><mrow><mi>t</mi><mo>⁢</mo><mi>i</mi><mo>⁢</mo><mi>m</mi><mo>⁢</mo><mi>e</mi></mrow><mo>+</mo><mn>1</mn></mrow></mrow></math></td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">2.</th>
<td class="ltx_td ltx_align_left"><math id="S6.SS2.p3.m3" class="ltx_Math" alttext="u.d=time" display="inline"><mrow><mi>u</mi><mo>.</mo><mrow><mi>d</mi><mo>=</mo><mrow><mi>t</mi><mo>⁢</mo><mi>i</mi><mo>⁢</mo><mi>m</mi><mo>⁢</mo><mi>e</mi></mrow></mrow></mrow></math></td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">3.</th>
<td class="ltx_td ltx_align_left"><math id="S6.SS2.p3.m4" class="ltx_Math" alttext="u.color=GRAY" display="inline"><mrow><mi>u</mi><mo>.</mo><mrow><mrow><mi>c</mi><mo>⁢</mo><mi>o</mi><mo>⁢</mo><mi>l</mi><mo>⁢</mo><mi>o</mi><mo>⁢</mo><mi>r</mi></mrow><mo>=</mo><mrow><mi>G</mi><mo>⁢</mo><mi>R</mi><mo>⁢</mo><mi>A</mi><mo>⁢</mo><mi>Y</mi></mrow></mrow></mrow></math></td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">4.</th>
<td class="ltx_td ltx_align_left">
<span class="ltx_text ltx_font_bold">for</span> each vertex <math id="S6.SS2.p3.m5" class="ltx_Math" alttext="v\in G.Adj[u]" display="inline"><mrow><mrow><mi>v</mi><mo>∈</mo><mi>G</mi></mrow><mo>.</mo><mrow><mi>A</mi><mo>⁢</mo><mi>d</mi><mo>⁢</mo><mi>j</mi><mo>⁢</mo><mrow><mo stretchy="false">[</mo><mi>u</mi><mo stretchy="false">]</mo></mrow></mrow></mrow></math>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">5.</th>
<td class="ltx_td ltx_align_left"> <span class="ltx_text ltx_font_bold">if</span> <math id="S6.SS2.p3.m6" class="ltx_Math" alttext="v.color==WHITE" display="inline"><mrow><mi>v</mi><mo>.</mo><mi>c</mi><mi>o</mi><mi>l</mi><mi>o</mi><mi>r</mi><mo>=</mo><mo>=</mo><mi>W</mi><mi>H</mi><mi>I</mi><mi>T</mi><mi>E</mi></mrow></math>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">6.</th>
<td class="ltx_td ltx_align_left">  <math id="S6.SS2.p3.m7" class="ltx_Math" alttext="v.\pi=u" display="inline"><mrow><mi>v</mi><mo>.</mo><mrow><mi>π</mi><mo>=</mo><mi>u</mi></mrow></mrow></math>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">7.</th>
<td class="ltx_td ltx_align_left">  <span class="ltx_text ltx_font_smallcaps">DFS-Visit<math id="S6.SS2.p3.m8" class="ltx_Math" alttext="(G,v)" display="inline"><mrow><mo mathvariant="normal" stretchy="false">(</mo><mi>G</mi><mo mathvariant="normal">,</mo><mi>v</mi><mo mathvariant="normal" stretchy="false">)</mo></mrow></math></span>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">8.</th>
<td class="ltx_td ltx_align_left"><math id="S6.SS2.p3.m9" class="ltx_Math" alttext="u.color=BLACK" display="inline"><mrow><mi>u</mi><mo>.</mo><mrow><mrow><mi>c</mi><mo>⁢</mo><mi>o</mi><mo>⁢</mo><mi>l</mi><mo>⁢</mo><mi>o</mi><mo>⁢</mo><mi>r</mi></mrow><mo>=</mo><mrow><mi>B</mi><mo>⁢</mo><mi>L</mi><mo>⁢</mo><mi>A</mi><mo>⁢</mo><mi>C</mi><mo>⁢</mo><mi>K</mi></mrow></mrow></mrow></math></td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">9.</th>
<td class="ltx_td ltx_align_left"><math id="S6.SS2.p3.m10" class="ltx_Math" alttext="time=time+1" display="inline"><mrow><mrow><mi>t</mi><mo>⁢</mo><mi>i</mi><mo>⁢</mo><mi>m</mi><mo>⁢</mo><mi>e</mi></mrow><mo>=</mo><mrow><mrow><mi>t</mi><mo>⁢</mo><mi>i</mi><mo>⁢</mo><mi>m</mi><mo>⁢</mo><mi>e</mi></mrow><mo>+</mo><mn>1</mn></mrow></mrow></math></td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_bb">10.</th>
<td class="ltx_td ltx_align_left ltx_border_bb"><math id="S6.SS2.p3.m11" class="ltx_Math" alttext="u.f=time" display="inline"><mrow><mi>u</mi><mo>.</mo><mrow><mi>f</mi><mo>=</mo><mrow><mi>t</mi><mo>⁢</mo><mi>i</mi><mo>⁢</mo><mi>m</mi><mo>⁢</mo><mi>e</mi></mrow></mrow></mrow></math></td>
</tr>
</tbody>
</table>
</div>
<div id="S6.SS2.p4" class="ltx_para ltx_noindent">
<p class="ltx_p"><span class="ltx_text ltx_font_bold">Runtime:</span>
<math id="S6.SS2.p4.m1" class="ltx_Math" alttext="O(V+E)" display="inline"><mrow><mi>O</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mi>V</mi><mo>+</mo><mi>E</mi></mrow><mo stretchy="false">)</mo></mrow></mrow></math>.
Each vertex is discovered and finished exactly once, and each edge is examined exactly twice.</p>
</div>
<section id="S6.SS2.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">6.2.1 </span>Properties of Depth First Search</h4>

<div id="S6.SS2.SSS1.p1" class="ltx_para ltx_noindent">
<ul id="S6.I3" class="ltx_itemize">
<li id="S6.I3.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S6.I3.i1.p1" class="ltx_para ltx_noindent">
<p class="ltx_p"><span class="ltx_text ltx_font_bold">Parenthesis property:</span>
For any two vertices <math id="S6.I3.i1.p1.m1" class="ltx_Math" alttext="u" display="inline"><mi>u</mi></math> and <math id="S6.I3.i1.p1.m2" class="ltx_Math" alttext="v" display="inline"><mi>v</mi></math>, exactly one of the following three conditions holds:</p>
<ul id="S6.I3.i1.I1" class="ltx_itemize">
<li id="S6.I3.i1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"><span class="ltx_text ltx_font_bold">–</span></span> 
<div id="S6.I3.i1.I1.i1.p1" class="ltx_para ltx_noindent">
<p class="ltx_p">The intervals <math id="S6.I3.i1.I1.i1.p1.m1" class="ltx_Math" alttext="[u.d,u.f]" display="inline"><mrow><mo stretchy="false">[</mo><mrow><mi>u</mi><mo>.</mo><mrow><mi>d</mi><mo>,</mo><mi>u</mi></mrow><mo>.</mo><mi>f</mi></mrow><mo stretchy="false">]</mo></mrow></math> and <math id="S6.I3.i1.I1.i1.p1.m2" class="ltx_Math" alttext="[v.d,v.f]" display="inline"><mrow><mo stretchy="false">[</mo><mrow><mi>v</mi><mo>.</mo><mrow><mi>d</mi><mo>,</mo><mi>v</mi></mrow><mo>.</mo><mi>f</mi></mrow><mo stretchy="false">]</mo></mrow></math> are entirely disjoint, and neither <math id="S6.I3.i1.I1.i1.p1.m3" class="ltx_Math" alttext="u" display="inline"><mi>u</mi></math> nor <math id="S6.I3.i1.I1.i1.p1.m4" class="ltx_Math" alttext="v" display="inline"><mi>v</mi></math> is a descendant of the other in the depth first forest.</p>
</div>
</li>
<li id="S6.I3.i1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"><span class="ltx_text ltx_font_bold">–</span></span> 
<div id="S6.I3.i1.I1.i2.p1" class="ltx_para ltx_noindent">
<p class="ltx_p">The interval <math id="S6.I3.i1.I1.i2.p1.m1" class="ltx_Math" alttext="[u.d,u.f]" display="inline"><mrow><mo stretchy="false">[</mo><mrow><mi>u</mi><mo>.</mo><mrow><mi>d</mi><mo>,</mo><mi>u</mi></mrow><mo>.</mo><mi>f</mi></mrow><mo stretchy="false">]</mo></mrow></math> is contained entirely within the interval <math id="S6.I3.i1.I1.i2.p1.m2" class="ltx_Math" alttext="[v.d,v.f]" display="inline"><mrow><mo stretchy="false">[</mo><mrow><mi>v</mi><mo>.</mo><mrow><mi>d</mi><mo>,</mo><mi>v</mi></mrow><mo>.</mo><mi>f</mi></mrow><mo stretchy="false">]</mo></mrow></math>, and <math id="S6.I3.i1.I1.i2.p1.m3" class="ltx_Math" alttext="u" display="inline"><mi>u</mi></math> is a descendant of <math id="S6.I3.i1.I1.i2.p1.m4" class="ltx_Math" alttext="v" display="inline"><mi>v</mi></math> in a depth first tree.</p>
</div>
</li>
<li id="S6.I3.i1.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"><span class="ltx_text ltx_font_bold">–</span></span> 
<div id="S6.I3.i1.I1.i3.p1" class="ltx_para ltx_noindent">
<p class="ltx_p">The interval <math id="S6.I3.i1.I1.i3.p1.m1" class="ltx_Math" alttext="[v.d,v.f]" display="inline"><mrow><mo stretchy="false">[</mo><mrow><mi>v</mi><mo>.</mo><mrow><mi>d</mi><mo>,</mo><mi>v</mi></mrow><mo>.</mo><mi>f</mi></mrow><mo stretchy="false">]</mo></mrow></math> is contained entirely within the interval <math id="S6.I3.i1.I1.i3.p1.m2" class="ltx_Math" alttext="[u.d,u.f]" display="inline"><mrow><mo stretchy="false">[</mo><mrow><mi>u</mi><mo>.</mo><mrow><mi>d</mi><mo>,</mo><mi>u</mi></mrow><mo>.</mo><mi>f</mi></mrow><mo stretchy="false">]</mo></mrow></math>, and <math id="S6.I3.i1.I1.i3.p1.m3" class="ltx_Math" alttext="v" display="inline"><mi>v</mi></math> is a descendant of <math id="S6.I3.i1.I1.i3.p1.m4" class="ltx_Math" alttext="u" display="inline"><mi>u</mi></math> in a depth first tree.
</p>
</div>
</li>
</ul>
</div>
</li>
<li id="S6.I3.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S6.I3.i2.p1" class="ltx_para ltx_noindent">
<p class="ltx_p"><span class="ltx_text ltx_font_bold">White-path theorem:</span>
In a depth first forest of a graph <math id="S6.I3.i2.p1.m1" class="ltx_Math" alttext="G=(V,E)" display="inline"><mrow><mi>G</mi><mo>=</mo><mrow><mo stretchy="false">(</mo><mi>V</mi><mo>,</mo><mi>E</mi><mo stretchy="false">)</mo></mrow></mrow></math>, vertex <math id="S6.I3.i2.p1.m2" class="ltx_Math" alttext="v" display="inline"><mi>v</mi></math> is a descendant of vertex <math id="S6.I3.i2.p1.m3" class="ltx_Math" alttext="u" display="inline"><mi>u</mi></math> if and only if at the time <math id="S6.I3.i2.p1.m4" class="ltx_Math" alttext="u.d" display="inline"><mrow><mi>u</mi><mo>.</mo><mi>d</mi></mrow></math> that the search discovers <math id="S6.I3.i2.p1.m5" class="ltx_Math" alttext="u" display="inline"><mi>u</mi></math>, there is a path from <math id="S6.I3.i2.p1.m6" class="ltx_Math" alttext="u" display="inline"><mi>u</mi></math> to <math id="S6.I3.i2.p1.m7" class="ltx_Math" alttext="v" display="inline"><mi>v</mi></math> consisting entirely of white vertices.</p>
</div>
</li>
</ul>
</div>
<div id="S6.SS2.SSS1.p2" class="ltx_para ltx_noindent">
<p class="ltx_p"><span class="ltx_text ltx_font_bold">Proof:</span></p>
</div>
<div id="S6.SS2.SSS1.p3" class="ltx_para ltx_noindent">
<p class="ltx_p">“<math id="S6.SS2.SSS1.p3.m1" class="ltx_Math" alttext="\Rightarrow" display="inline"><mo>⇒</mo></math>”:
If <math id="S6.SS2.SSS1.p3.m2" class="ltx_Math" alttext="v" display="inline"><mi>v</mi></math> is a descendant of <math id="S6.SS2.SSS1.p3.m3" class="ltx_Math" alttext="u" display="inline"><mi>u</mi></math>, then <math id="S6.SS2.SSS1.p3.m4" class="ltx_Math" alttext="v" display="inline"><mi>v</mi></math> is discovered after <math id="S6.SS2.SSS1.p3.m5" class="ltx_Math" alttext="u" display="inline"><mi>u</mi></math>, which means <math id="S6.SS2.SSS1.p3.m6" class="ltx_Math" alttext="v" display="inline"><mi>v</mi></math> is white when <math id="S6.SS2.SSS1.p3.m7" class="ltx_Math" alttext="u" display="inline"><mi>u</mi></math> is discovered.
And this is true for all vertices on the path from <math id="S6.SS2.SSS1.p3.m8" class="ltx_Math" alttext="u" display="inline"><mi>u</mi></math> to <math id="S6.SS2.SSS1.p3.m9" class="ltx_Math" alttext="v" display="inline"><mi>v</mi></math>, since they are all descendants of <math id="S6.SS2.SSS1.p3.m10" class="ltx_Math" alttext="u" display="inline"><mi>u</mi></math>.</p>
</div>
<div id="S6.SS2.SSS1.p4" class="ltx_para ltx_noindent">
<p class="ltx_p">“<math id="S6.SS2.SSS1.p4.m1" class="ltx_Math" alttext="\Leftarrow" display="inline"><mo>⇐</mo></math>”:
Proof by contradiction.
Let <math id="S6.SS2.SSS1.p4.m2" class="ltx_Math" alttext="v" display="inline"><mi>v</mi></math> be the first vertex on the white path but is not a descendant of <math id="S6.SS2.SSS1.p4.m3" class="ltx_Math" alttext="u" display="inline"><mi>u</mi></math>.
Let <math id="S6.SS2.SSS1.p4.m4" class="ltx_Math" alttext="w" display="inline"><mi>w</mi></math> be the predecessor of <math id="S6.SS2.SSS1.p4.m5" class="ltx_Math" alttext="v" display="inline"><mi>v</mi></math> on the white path.
By the choice of <math id="S6.SS2.SSS1.p4.m6" class="ltx_Math" alttext="w" display="inline"><mi>w</mi></math>, we knoe that <math id="S6.SS2.SSS1.p4.m7" class="ltx_Math" alttext="w" display="inline"><mi>w</mi></math> is a descendant of <math id="S6.SS2.SSS1.p4.m8" class="ltx_Math" alttext="u" display="inline"><mi>u</mi></math>, hence <math id="S6.SS2.SSS1.p4.m9" class="ltx_Math" alttext="u.d\leq w.f\leq u.f" display="inline"><mrow><mi>u</mi><mo>.</mo><mrow><mi>d</mi><mo>≤</mo><mi>w</mi></mrow><mo>.</mo><mrow><mi>f</mi><mo>≤</mo><mi>u</mi></mrow><mo>.</mo><mi>f</mi></mrow></math>. (<math id="S6.SS2.SSS1.p4.m10" class="ltx_Math" alttext="w" display="inline"><mi>w</mi></math> and <math id="S6.SS2.SSS1.p4.m11" class="ltx_Math" alttext="u" display="inline"><mi>u</mi></math> can be the same vertex.)
Since there is a path from <math id="S6.SS2.SSS1.p4.m12" class="ltx_Math" alttext="w" display="inline"><mi>w</mi></math> to <math id="S6.SS2.SSS1.p4.m13" class="ltx_Math" alttext="v" display="inline"><mi>v</mi></math>, <math id="S6.SS2.SSS1.p4.m14" class="ltx_Math" alttext="v" display="inline"><mi>v</mi></math> will be discovered before <math id="S6.SS2.SSS1.p4.m15" class="ltx_Math" alttext="w" display="inline"><mi>w</mi></math> finishes, hence <math id="S6.SS2.SSS1.p4.m16" class="ltx_Math" alttext="v.d&lt;w.f" display="inline"><mrow><mi>v</mi><mo>.</mo><mrow><mi>d</mi><mo>&lt;</mo><mi>w</mi></mrow><mo>.</mo><mi>f</mi></mrow></math>.
In all, we have <math id="S6.SS2.SSS1.p4.m17" class="ltx_Math" alttext="u.d&lt;v.d&lt;w.f\leq u.f" display="inline"><mrow><mi>u</mi><mo>.</mo><mrow><mi>d</mi><mo>&lt;</mo><mi>v</mi></mrow><mo>.</mo><mrow><mi>d</mi><mo>&lt;</mo><mi>w</mi></mrow><mo>.</mo><mrow><mi>f</mi><mo>≤</mo><mi>u</mi></mrow><mo>.</mo><mi>f</mi></mrow></math>, then <math id="S6.SS2.SSS1.p4.m18" class="ltx_Math" alttext="v" display="inline"><mi>v</mi></math> must be a descendant of <math id="S6.SS2.SSS1.p4.m19" class="ltx_Math" alttext="u" display="inline"><mi>u</mi></math>.</p>
</div>
</section>
<section id="S6.SS2.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">6.2.2 </span>Classification of Edges</h4>

<div id="S6.SS2.SSS2.p1" class="ltx_para ltx_noindent">
<p class="ltx_p">There are four types of edges in a depth first forest:</p>
<ul id="S6.I4" class="ltx_itemize">
<li id="S6.I4.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S6.I4.i1.p1" class="ltx_para ltx_noindent">
<p class="ltx_p"><span class="ltx_text ltx_font_bold">Tree edges:</span>
Edges in the depth first forest.
An edge <math id="S6.I4.i1.p1.m1" class="ltx_Math" alttext="(u,v)" display="inline"><mrow><mo stretchy="false">(</mo><mi>u</mi><mo>,</mo><mi>v</mi><mo stretchy="false">)</mo></mrow></math> is a tree edge if <math id="S6.I4.i1.p1.m2" class="ltx_Math" alttext="v" display="inline"><mi>v</mi></math> was first discovered by exploring edge <math id="S6.I4.i1.p1.m3" class="ltx_Math" alttext="(u,v)" display="inline"><mrow><mo stretchy="false">(</mo><mi>u</mi><mo>,</mo><mi>v</mi><mo stretchy="false">)</mo></mrow></math>, or to say <math id="S6.I4.i1.p1.m4" class="ltx_Math" alttext="v" display="inline"><mi>v</mi></math>’s color is white when edge <math id="S6.I4.i1.p1.m5" class="ltx_Math" alttext="(u,v)" display="inline"><mrow><mo stretchy="false">(</mo><mi>u</mi><mo>,</mo><mi>v</mi><mo stretchy="false">)</mo></mrow></math> is examined.</p>
</div>
</li>
<li id="S6.I4.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S6.I4.i2.p1" class="ltx_para ltx_noindent">
<p class="ltx_p"><span class="ltx_text ltx_font_bold">Back edges:</span>
Edges that connect a vertex to an ancestor in a depth first tree.
An edge <math id="S6.I4.i2.p1.m1" class="ltx_Math" alttext="(u,v)" display="inline"><mrow><mo stretchy="false">(</mo><mi>u</mi><mo>,</mo><mi>v</mi><mo stretchy="false">)</mo></mrow></math> is a back edge if at the time <math id="S6.I4.i2.p1.m2" class="ltx_Math" alttext="(u,v)" display="inline"><mrow><mo stretchy="false">(</mo><mi>u</mi><mo>,</mo><mi>v</mi><mo stretchy="false">)</mo></mrow></math> is examined, <math id="S6.I4.i2.p1.m3" class="ltx_Math" alttext="v" display="inline"><mi>v</mi></math> is colored gray.</p>
</div>
</li>
<li id="S6.I4.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S6.I4.i3.p1" class="ltx_para ltx_noindent">
<p class="ltx_p"><span class="ltx_text ltx_font_bold">Forward edges:</span>
Edges that connect a vertex to a descendant in a depth first tree.
An edge <math id="S6.I4.i3.p1.m1" class="ltx_Math" alttext="(u,v)" display="inline"><mrow><mo stretchy="false">(</mo><mi>u</mi><mo>,</mo><mi>v</mi><mo stretchy="false">)</mo></mrow></math> is a forward edge if at the time <math id="S6.I4.i3.p1.m2" class="ltx_Math" alttext="(u,v)" display="inline"><mrow><mo stretchy="false">(</mo><mi>u</mi><mo>,</mo><mi>v</mi><mo stretchy="false">)</mo></mrow></math> is examined, <math id="S6.I4.i3.p1.m3" class="ltx_Math" alttext="v" display="inline"><mi>v</mi></math> is colored black and was discovered later than <math id="S6.I4.i3.p1.m4" class="ltx_Math" alttext="u" display="inline"><mi>u</mi></math>.</p>
</div>
</li>
<li id="S6.I4.i4" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S6.I4.i4.p1" class="ltx_para ltx_noindent">
<p class="ltx_p"><span class="ltx_text ltx_font_bold">Cross edges:</span>
Edges that connect two vertices in different depth first trees.
An edge <math id="S6.I4.i4.p1.m1" class="ltx_Math" alttext="(u,v)" display="inline"><mrow><mo stretchy="false">(</mo><mi>u</mi><mo>,</mo><mi>v</mi><mo stretchy="false">)</mo></mrow></math> is a cross edge if at the time <math id="S6.I4.i4.p1.m2" class="ltx_Math" alttext="(u,v)" display="inline"><mrow><mo stretchy="false">(</mo><mi>u</mi><mo>,</mo><mi>v</mi><mo stretchy="false">)</mo></mrow></math> is examined, <math id="S6.I4.i4.p1.m3" class="ltx_Math" alttext="v" display="inline"><mi>v</mi></math> is colored black and was discovered earlier than <math id="S6.I4.i4.p1.m4" class="ltx_Math" alttext="u" display="inline"><mi>u</mi></math>.</p>
</div>
</li>
</ul>
</div>
<div id="S6.SS2.SSS2.p2" class="ltx_para ltx_noindent">
<p class="ltx_p">In an undirected graph, there are only tree edges and back edges.
This is because there is no way to find a vertex that is colored black.</p>
</div>
<div id="S6.SS2.SSS2.p3" class="ltx_para ltx_noindent">
<p class="ltx_p">Let <math id="S6.SS2.SSS2.p3.m1" class="ltx_Math" alttext="(u,v)" display="inline"><mrow><mo stretchy="false">(</mo><mi>u</mi><mo>,</mo><mi>v</mi><mo stretchy="false">)</mo></mrow></math> be an arbitrary edge of an undirected graph <math id="S6.SS2.SSS2.p3.m2" class="ltx_Math" alttext="G=(V,E)" display="inline"><mrow><mi>G</mi><mo>=</mo><mrow><mo stretchy="false">(</mo><mi>V</mi><mo>,</mo><mi>E</mi><mo stretchy="false">)</mo></mrow></mrow></math>.
Without loss of generality, assume that <math id="S6.SS2.SSS2.p3.m3" class="ltx_Math" alttext="u.d&lt;v.d" display="inline"><mrow><mi>u</mi><mo>.</mo><mrow><mi>d</mi><mo>&lt;</mo><mi>v</mi></mrow><mo>.</mo><mi>d</mi></mrow></math>.
Hence, the search must discover <math id="S6.SS2.SSS2.p3.m4" class="ltx_Math" alttext="v" display="inline"><mi>v</mi></math> before it finishes exploring <math id="S6.SS2.SSS2.p3.m5" class="ltx_Math" alttext="u" display="inline"><mi>u</mi></math>.
If the first time that <math id="S6.SS2.SSS2.p3.m6" class="ltx_Math" alttext="(u,v)" display="inline"><mrow><mo stretchy="false">(</mo><mi>u</mi><mo>,</mo><mi>v</mi><mo stretchy="false">)</mo></mrow></math> is examined is from <math id="S6.SS2.SSS2.p3.m7" class="ltx_Math" alttext="u" display="inline"><mi>u</mi></math>, then it is a tree edge.
Otherwise, <math id="S6.SS2.SSS2.p3.m8" class="ltx_Math" alttext="(u,v)" display="inline"><mrow><mo stretchy="false">(</mo><mi>u</mi><mo>,</mo><mi>v</mi><mo stretchy="false">)</mo></mrow></math> is a back edge, since <math id="S6.SS2.SSS2.p3.m9" class="ltx_Math" alttext="u" display="inline"><mi>u</mi></math> is still gray when <math id="S6.SS2.SSS2.p3.m10" class="ltx_Math" alttext="(u,v)" display="inline"><mrow><mo stretchy="false">(</mo><mi>u</mi><mo>,</mo><mi>v</mi><mo stretchy="false">)</mo></mrow></math> is examined.</p>
</div>
</section>
<section id="S6.SS2.SSS3" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">6.2.3 </span>DFS and Cycle</h4>

<div id="S6.SS2.SSS3.p1" class="ltx_para ltx_noindent">
<p class="ltx_p">A directed graph is acyclic if and only if a depth first search of the graph yields no back edges.</p>
</div>
<div id="S6.SS2.SSS3.p2" class="ltx_para ltx_noindent">
<p class="ltx_p"><span class="ltx_text ltx_font_bold">Proof:</span></p>
</div>
<div id="S6.SS2.SSS3.p3" class="ltx_para ltx_noindent">
<p class="ltx_p">“<math id="S6.SS2.SSS3.p3.m1" class="ltx_Math" alttext="\Leftarrow" display="inline"><mo>⇐</mo></math>”:
If there is a back edge <math id="S6.SS2.SSS3.p3.m2" class="ltx_Math" alttext="(u,v)" display="inline"><mrow><mo stretchy="false">(</mo><mi>u</mi><mo>,</mo><mi>v</mi><mo stretchy="false">)</mo></mrow></math>, then we can find a loop that consists of a path from <math id="S6.SS2.SSS3.p3.m3" class="ltx_Math" alttext="u" display="inline"><mi>u</mi></math> to <math id="S6.SS2.SSS3.p3.m4" class="ltx_Math" alttext="v" display="inline"><mi>v</mi></math> on the depth first tree, and the edge <math id="S6.SS2.SSS3.p3.m5" class="ltx_Math" alttext="(u,v)" display="inline"><mrow><mo stretchy="false">(</mo><mi>u</mi><mo>,</mo><mi>v</mi><mo stretchy="false">)</mo></mrow></math>.</p>
</div>
<div id="S6.SS2.SSS3.p4" class="ltx_para ltx_noindent">
<p class="ltx_p">“<math id="S6.SS2.SSS3.p4.m1" class="ltx_Math" alttext="\Rightarrow" display="inline"><mo>⇒</mo></math>”:
If there is a loop, then there is a back edge.
Assume the cycle is <math id="S6.SS2.SSS3.p4.m2" class="ltx_Math" alttext="v_{1},v_{2},\dots,v_{k},v_{1}" display="inline"><mrow><msub><mi>v</mi><mn>1</mn></msub><mo>,</mo><msub><mi>v</mi><mn>2</mn></msub><mo>,</mo><mi mathvariant="normal">…</mi><mo>,</mo><msub><mi>v</mi><mi>k</mi></msub><mo>,</mo><msub><mi>v</mi><mn>1</mn></msub></mrow></math>.
Without loss of generality, assume the first discovered vertex is <math id="S6.SS2.SSS3.p4.m3" class="ltx_Math" alttext="v_{1}" display="inline"><msub><mi>v</mi><mn>1</mn></msub></math>.
Then at time <math id="S6.SS2.SSS3.p4.m4" class="ltx_Math" alttext="v_{1}.d" display="inline"><mrow><msub><mi>v</mi><mn>1</mn></msub><mo>.</mo><mi>d</mi></mrow></math>, all other vertices are colored white.
By the white-path theorem, <math id="S6.SS2.SSS3.p4.m5" class="ltx_Math" alttext="v_{k}" display="inline"><msub><mi>v</mi><mi>k</mi></msub></math> is a descendant of <math id="S6.SS2.SSS3.p4.m6" class="ltx_Math" alttext="v_{1}" display="inline"><msub><mi>v</mi><mn>1</mn></msub></math>.
Therefore, <math id="S6.SS2.SSS3.p4.m7" class="ltx_Math" alttext="(v_{1},v_{k})" display="inline"><mrow><mo stretchy="false">(</mo><msub><mi>v</mi><mn>1</mn></msub><mo>,</mo><msub><mi>v</mi><mi>k</mi></msub><mo stretchy="false">)</mo></mrow></math> is a back edge.</p>
</div>
</section>
<section id="S6.SS2.SSS4" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">6.2.4 </span>Topological Sort</h4>

<div id="S6.SS2.SSS4.p1" class="ltx_para ltx_noindent">
<p class="ltx_p">A topological sort of a directed acyclic graph <math id="S6.SS2.SSS4.p1.m1" class="ltx_Math" alttext="G=(V,E)" display="inline"><mrow><mi>G</mi><mo>=</mo><mrow><mo stretchy="false">(</mo><mi>V</mi><mo>,</mo><mi>E</mi><mo stretchy="false">)</mo></mrow></mrow></math> is a linear ordering of all its vertices such that if <math id="S6.SS2.SSS4.p1.m2" class="ltx_Math" alttext="G" display="inline"><mi>G</mi></math> contains an edge <math id="S6.SS2.SSS4.p1.m3" class="ltx_Math" alttext="(u,v)" display="inline"><mrow><mo stretchy="false">(</mo><mi>u</mi><mo>,</mo><mi>v</mi><mo stretchy="false">)</mo></mrow></math>, then <math id="S6.SS2.SSS4.p1.m4" class="ltx_Math" alttext="u" display="inline"><mi>u</mi></math> appears before <math id="S6.SS2.SSS4.p1.m5" class="ltx_Math" alttext="v" display="inline"><mi>v</mi></math> in the ordering.
A topological sort can be implemented by depth first search.</p>
</div>
<div id="S6.SS2.SSS4.p2" class="ltx_para ltx_align_center">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr class="ltx_tr">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" colspan="2"><span class="ltx_text ltx_font_smallcaps">Topological-Sort<math id="S6.SS2.SSS4.p2.m1" class="ltx_Math" alttext="(G)" display="inline"><mrow><mo mathvariant="normal" stretchy="false">(</mo><mi>G</mi><mo mathvariant="normal" stretchy="false">)</mo></mrow></math></span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_t">1.</th>
<td class="ltx_td ltx_align_left ltx_border_t">
<span class="ltx_text ltx_font_bold">call</span> <span class="ltx_text ltx_font_smallcaps">DFS<math id="S6.SS2.SSS4.p2.m2" class="ltx_Math" alttext="(G)" display="inline"><mrow><mo mathvariant="normal" stretchy="false">(</mo><mi>G</mi><mo mathvariant="normal" stretchy="false">)</mo></mrow></math></span> to compute finishing times <math id="S6.SS2.SSS4.p2.m3" class="ltx_Math" alttext="v.f" display="inline"><mrow><mi>v</mi><mo>.</mo><mi>f</mi></mrow></math> for each vertex <math id="S6.SS2.SSS4.p2.m4" class="ltx_Math" alttext="v" display="inline"><mi>v</mi></math>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">2.</th>
<td class="ltx_td ltx_align_left"><span class="ltx_text ltx_font_bold">as each vertex is finished, insert it onto the front of a linked list</span></td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_bb">3.</th>
<td class="ltx_td ltx_align_left ltx_border_bb">
<span class="ltx_text ltx_font_bold">return</span> the linked list of vertices</td>
</tr>
</tbody>
</table>
</div>
<div id="S6.SS2.SSS4.p3" class="ltx_para ltx_noindent">
<p class="ltx_p"><span class="ltx_text ltx_font_bold">Runtime:</span>
<math id="S6.SS2.SSS4.p3.m1" class="ltx_Math" alttext="O(|V|+|E|)" display="inline"><mrow><mi>O</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mrow><mo stretchy="false">|</mo><mi>V</mi><mo stretchy="false">|</mo></mrow><mo>+</mo><mrow><mo stretchy="false">|</mo><mi>E</mi><mo stretchy="false">|</mo></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow></math>.</p>
</div>
<div id="S6.SS2.SSS4.p4" class="ltx_para ltx_noindent">
<p class="ltx_p"><span class="ltx_text ltx_font_bold">Correctness:</span>
For any edge <math id="S6.SS2.SSS4.p4.m1" class="ltx_Math" alttext="(u,v)" display="inline"><mrow><mo stretchy="false">(</mo><mi>u</mi><mo>,</mo><mi>v</mi><mo stretchy="false">)</mo></mrow></math>, we need to prove that <math id="S6.SS2.SSS4.p4.m2" class="ltx_Math" alttext="u.f&gt;v.f" display="inline"><mrow><mi>u</mi><mo>.</mo><mrow><mi>f</mi><mo>&gt;</mo><mi>v</mi></mrow><mo>.</mo><mi>f</mi></mrow></math>.
Without loss of generality, assume <math id="S6.SS2.SSS4.p4.m3" class="ltx_Math" alttext="u" display="inline"><mi>u</mi></math> is discovered before <math id="S6.SS2.SSS4.p4.m4" class="ltx_Math" alttext="v" display="inline"><mi>v</mi></math>.
Since in an acyclic graph there is no back edge, <math id="S6.SS2.SSS4.p4.m5" class="ltx_Math" alttext="v" display="inline"><mi>v</mi></math> must be white or black.
If <math id="S6.SS2.SSS4.p4.m6" class="ltx_Math" alttext="v" display="inline"><mi>v</mi></math> is white, then <math id="S6.SS2.SSS4.p4.m7" class="ltx_Math" alttext="v" display="inline"><mi>v</mi></math> is a descendant of <math id="S6.SS2.SSS4.p4.m8" class="ltx_Math" alttext="u" display="inline"><mi>u</mi></math>, and <math id="S6.SS2.SSS4.p4.m9" class="ltx_Math" alttext="u.f&gt;v.f" display="inline"><mrow><mi>u</mi><mo>.</mo><mrow><mi>f</mi><mo>&gt;</mo><mi>v</mi></mrow><mo>.</mo><mi>f</mi></mrow></math>.
If <math id="S6.SS2.SSS4.p4.m10" class="ltx_Math" alttext="v" display="inline"><mi>v</mi></math> is black, then <math id="S6.SS2.SSS4.p4.m11" class="ltx_Math" alttext="v.f" display="inline"><mrow><mi>v</mi><mo>.</mo><mi>f</mi></mrow></math> is already set and <math id="S6.SS2.SSS4.p4.m12" class="ltx_Math" alttext="u.f&gt;v.f" display="inline"><mrow><mi>u</mi><mo>.</mo><mrow><mi>f</mi><mo>&gt;</mo><mi>v</mi></mrow><mo>.</mo><mi>f</mi></mrow></math>.</p>
</div>
</section>
<section id="S6.SS2.SSS5" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">6.2.5 </span>Strongly Connected Components</h4>

<div id="S6.SS2.SSS5.p1" class="ltx_para ltx_noindent">
<p class="ltx_p">A directed graph is <span class="ltx_text ltx_font_bold">strongly connected</span> if there is a path from each vertex to every other vertex.
Let <math id="S6.SS2.SSS5.p1.m1" class="ltx_Math" alttext="G=(V,E)" display="inline"><mrow><mi>G</mi><mo>=</mo><mrow><mo stretchy="false">(</mo><mi>V</mi><mo>,</mo><mi>E</mi><mo stretchy="false">)</mo></mrow></mrow></math> be a directed graph, and let <math id="S6.SS2.SSS5.p1.m2" class="ltx_Math" alttext="G^{T}=(V,E^{T})" display="inline"><mrow><msup><mi>G</mi><mi>T</mi></msup><mo>=</mo><mrow><mo stretchy="false">(</mo><mi>V</mi><mo>,</mo><msup><mi>E</mi><mi>T</mi></msup><mo stretchy="false">)</mo></mrow></mrow></math> be the transpose of <math id="S6.SS2.SSS5.p1.m3" class="ltx_Math" alttext="G" display="inline"><mi>G</mi></math>, which is the graph formed by reversing all edges in <math id="S6.SS2.SSS5.p1.m4" class="ltx_Math" alttext="G" display="inline"><mi>G</mi></math>.
Note that <math id="S6.SS2.SSS5.p1.m5" class="ltx_Math" alttext="G" display="inline"><mi>G</mi></math> and <math id="S6.SS2.SSS5.p1.m6" class="ltx_Math" alttext="G^{T}" display="inline"><msup><mi>G</mi><mi>T</mi></msup></math> have the same strongly connected components.</p>
</div>
<div id="S6.SS2.SSS5.p2" class="ltx_para ltx_align_center">
<div class="ltx_inline-block ltx_transformed_outer" style="width:433.6pt;height:119.1pt;vertical-align:-10.3pt;"><span class="ltx_transformed_inner" style="transform:translate(-14.0pt,3.5pt) scale(0.939195617537524,0.939195617537524) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr class="ltx_tr">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" colspan="2"><span class="ltx_text ltx_font_smallcaps">Strongly-Connected-Components<math id="S6.SS2.SSS5.p2.m1" class="ltx_Math" alttext="(G)" display="inline"><mrow><mo mathvariant="normal" stretchy="false">(</mo><mi>G</mi><mo mathvariant="normal" stretchy="false">)</mo></mrow></math></span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_t">1.</th>
<td class="ltx_td ltx_align_left ltx_border_t">
<span class="ltx_text ltx_font_bold">call</span> <span class="ltx_text ltx_font_smallcaps">DFS<math id="S6.SS2.SSS5.p2.m2" class="ltx_Math" alttext="(G)" display="inline"><mrow><mo mathvariant="normal" stretchy="false">(</mo><mi>G</mi><mo mathvariant="normal" stretchy="false">)</mo></mrow></math></span> to compute finishing times <math id="S6.SS2.SSS5.p2.m3" class="ltx_Math" alttext="u.f" display="inline"><mrow><mi>u</mi><mo>.</mo><mi>f</mi></mrow></math> for each vertex <math id="S6.SS2.SSS5.p2.m4" class="ltx_Math" alttext="u" display="inline"><mi>u</mi></math>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">2.</th>
<td class="ltx_td ltx_align_left">
<span class="ltx_text ltx_font_bold">compute</span> <math id="S6.SS2.SSS5.p2.m5" class="ltx_Math" alttext="G^{T}" display="inline"><msup><mi>G</mi><mi>T</mi></msup></math>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">3.</th>
<td class="ltx_td ltx_align_left">
<span class="ltx_text ltx_font_bold">call</span> <span class="ltx_text ltx_font_smallcaps">DFS<math id="S6.SS2.SSS5.p2.m6" class="ltx_Math" alttext="(G^{T})" display="inline"><mrow><mo mathvariant="normal" stretchy="false">(</mo><msup><mi>G</mi><mi>T</mi></msup><mo mathvariant="normal" stretchy="false">)</mo></mrow></math></span>, but in the main loop of <span class="ltx_text ltx_font_smallcaps">DFS</span>, consider the vertices in order of decreasing <math id="S6.SS2.SSS5.p2.m7" class="ltx_Math" alttext="u.f" display="inline"><mrow><mi>u</mi><mo>.</mo><mi>f</mi></mrow></math>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_bb">4.</th>
<td class="ltx_td ltx_align_left ltx_border_bb">
<span class="ltx_text ltx_font_bold">output</span> the vertices of each tree in the depth first forest formed in line 3 as a separate strongly connected component</td>
</tr>
</tbody>
</table>
</span></div>
</div>
<div id="S6.SS2.SSS5.p3" class="ltx_para ltx_noindent">
<p class="ltx_p"><span class="ltx_text ltx_font_bold">Runtime:</span>
<math id="S6.SS2.SSS5.p3.m1" class="ltx_Math" alttext="O(|V|+|E|)" display="inline"><mrow><mi>O</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mrow><mo stretchy="false">|</mo><mi>V</mi><mo stretchy="false">|</mo></mrow><mo>+</mo><mrow><mo stretchy="false">|</mo><mi>E</mi><mo stretchy="false">|</mo></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow></math></p>
</div>
<div id="S6.SS2.SSS5.p4" class="ltx_para ltx_noindent">
<p class="ltx_p"><span class="ltx_text ltx_font_bold">Correctness:</span>
Proof by induction.
An SCC must be in its own tree in the depth first forest.
And we know the SCC containing the root of a depth first tree can be correctly output.
Then we make induction on the number of SCC in the graph.
If there is only one SCC, then the algorithm is correct (it will contain the root of the depth first tree).
Then, if we want to output the SCCs of a graph with <math id="S6.SS2.SSS5.p4.m1" class="ltx_Math" alttext="k" display="inline"><mi>k</mi></math> SCCs, we can exclude the SCC containing the root of one depth first tree, and output the SCCs of the remaining graph, which has <math id="S6.SS2.SSS5.p4.m2" class="ltx_Math" alttext="k-1" display="inline"><mrow><mi>k</mi><mo>-</mo><mn>1</mn></mrow></math> SCCs.</p>
</div>
</section>
</section>
<section id="S6.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.3 </span>Minimum Spanning Tree</h3>

<div id="S6.SS3.p1" class="ltx_para ltx_noindent">
<p class="ltx_p">A <span class="ltx_text ltx_font_bold">spanning tree</span> of a graph <math id="S6.SS3.p1.m1" class="ltx_Math" alttext="G=(V,E)" display="inline"><mrow><mi>G</mi><mo>=</mo><mrow><mo stretchy="false">(</mo><mi>V</mi><mo>,</mo><mi>E</mi><mo stretchy="false">)</mo></mrow></mrow></math> is a tree that is a subgraph of <math id="S6.SS3.p1.m2" class="ltx_Math" alttext="G" display="inline"><mi>G</mi></math> and contains all vertices of <math id="S6.SS3.p1.m3" class="ltx_Math" alttext="G" display="inline"><mi>G</mi></math>.
A <span class="ltx_text ltx_font_bold">minimum spanning tree</span> of a weighted, connected, undirected graph <math id="S6.SS3.p1.m4" class="ltx_Math" alttext="G=(V,E)" display="inline"><mrow><mi>G</mi><mo>=</mo><mrow><mo stretchy="false">(</mo><mi>V</mi><mo>,</mo><mi>E</mi><mo stretchy="false">)</mo></mrow></mrow></math> is a spanning tree of <math id="S6.SS3.p1.m5" class="ltx_Math" alttext="G" display="inline"><mi>G</mi></math> that has minimum weight.</p>
</div>
<section id="S6.SS3.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">6.3.1 </span>Generic MST Algorithm</h4>

<div id="S6.SS3.SSS1.p1" class="ltx_para ltx_align_center">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr class="ltx_tr">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" colspan="2"><span class="ltx_text ltx_font_smallcaps">Generic-MST<math id="S6.SS3.SSS1.p1.m1" class="ltx_Math" alttext="(G,w)" display="inline"><mrow><mo mathvariant="normal" stretchy="false">(</mo><mi>G</mi><mo mathvariant="normal">,</mo><mi>w</mi><mo mathvariant="normal" stretchy="false">)</mo></mrow></math></span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_t">1.</th>
<td class="ltx_td ltx_align_left ltx_border_t"><math id="S6.SS3.SSS1.p1.m2" class="ltx_Math" alttext="A=\emptyset" display="inline"><mrow><mi>A</mi><mo>=</mo><mi mathvariant="normal">∅</mi></mrow></math></td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">2.</th>
<td class="ltx_td ltx_align_left">
<span class="ltx_text ltx_font_bold">while</span> <math id="S6.SS3.SSS1.p1.m3" class="ltx_Math" alttext="A" display="inline"><mi>A</mi></math> does not form a spanning tree</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">3.</th>
<td class="ltx_td ltx_align_left"> find an edge <math id="S6.SS3.SSS1.p1.m4" class="ltx_Math" alttext="(u,v)" display="inline"><mrow><mo stretchy="false">(</mo><mi>u</mi><mo>,</mo><mi>v</mi><mo stretchy="false">)</mo></mrow></math> that is safe for <math id="S6.SS3.SSS1.p1.m5" class="ltx_Math" alttext="A" display="inline"><mi>A</mi></math>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">4.</th>
<td class="ltx_td ltx_align_left"> <math id="S6.SS3.SSS1.p1.m6" class="ltx_Math" alttext="A=A\cup\{(u,v)\}" display="inline"><mrow><mi>A</mi><mo>=</mo><mrow><mi>A</mi><mo>∪</mo><mrow><mo stretchy="false">{</mo><mrow><mo stretchy="false">(</mo><mi>u</mi><mo>,</mo><mi>v</mi><mo stretchy="false">)</mo></mrow><mo stretchy="false">}</mo></mrow></mrow></mrow></math>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_bb">5.</th>
<td class="ltx_td ltx_align_left ltx_border_bb">
<span class="ltx_text ltx_font_bold">return</span> <math id="S6.SS3.SSS1.p1.m7" class="ltx_Math" alttext="A" display="inline"><mi>A</mi></math>
</td>
</tr>
</tbody>
</table>
</div>
<div id="S6.SS3.SSS1.p2" class="ltx_para ltx_noindent">
<p class="ltx_p"><span class="ltx_text ltx_font_bold">Correctness:</span>
By loop invariant:
<math id="S6.SS3.SSS1.p2.m1" class="ltx_Math" alttext="A" display="inline"><mi>A</mi></math> is a subset of some MST.</p>
</div>
</section>
<section id="S6.SS3.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">6.3.2 </span>Cuts</h4>

<div id="S6.SS3.SSS2.p1" class="ltx_para ltx_noindent">
<p class="ltx_p">A <span class="ltx_text ltx_font_bold">cut</span> <math id="S6.SS3.SSS2.p1.m1" class="ltx_Math" alttext="(S,V-S)" display="inline"><mrow><mo stretchy="false">(</mo><mi>S</mi><mo>,</mo><mrow><mi>V</mi><mo>-</mo><mi>S</mi></mrow><mo stretchy="false">)</mo></mrow></math> of an undirected graph <math id="S6.SS3.SSS2.p1.m2" class="ltx_Math" alttext="G=(V,E)" display="inline"><mrow><mi>G</mi><mo>=</mo><mrow><mo stretchy="false">(</mo><mi>V</mi><mo>,</mo><mi>E</mi><mo stretchy="false">)</mo></mrow></mrow></math> is a partition of <math id="S6.SS3.SSS2.p1.m3" class="ltx_Math" alttext="V" display="inline"><mi>V</mi></math>.
An edge <math id="S6.SS3.SSS2.p1.m4" class="ltx_Math" alttext="(u,v)" display="inline"><mrow><mo stretchy="false">(</mo><mi>u</mi><mo>,</mo><mi>v</mi><mo stretchy="false">)</mo></mrow></math> <span class="ltx_text ltx_font_bold">crosses</span> the cut <math id="S6.SS3.SSS2.p1.m5" class="ltx_Math" alttext="(S,V-S)" display="inline"><mrow><mo stretchy="false">(</mo><mi>S</mi><mo>,</mo><mrow><mi>V</mi><mo>-</mo><mi>S</mi></mrow><mo stretchy="false">)</mo></mrow></math> if one of its endpoints is in <math id="S6.SS3.SSS2.p1.m6" class="ltx_Math" alttext="S" display="inline"><mi>S</mi></math> and the other is in <math id="S6.SS3.SSS2.p1.m7" class="ltx_Math" alttext="V-S" display="inline"><mrow><mi>V</mi><mo>-</mo><mi>S</mi></mrow></math>.
A cut <span class="ltx_text ltx_font_bold">respects</span> a set <math id="S6.SS3.SSS2.p1.m8" class="ltx_Math" alttext="A" display="inline"><mi>A</mi></math> of edges if no edge in <math id="S6.SS3.SSS2.p1.m9" class="ltx_Math" alttext="A" display="inline"><mi>A</mi></math> crosses the cut.
An edge is a <span class="ltx_text ltx_font_bold">light edge</span> crossing a cut if its weight is the minimum of any edge crossing the cut.</p>
</div>
<div id="S6.SS3.SSS2.p2" class="ltx_para ltx_noindent">
<p class="ltx_p">We can prove that if a cut respects a set <math id="S6.SS3.SSS2.p2.m1" class="ltx_Math" alttext="A" display="inline"><mi>A</mi></math> of edges, then the light edge crossing the cut is safe for <math id="S6.SS3.SSS2.p2.m2" class="ltx_Math" alttext="A" display="inline"><mi>A</mi></math>.
Suppose <math id="S6.SS3.SSS2.p2.m3" class="ltx_Math" alttext="(S,V-S)" display="inline"><mrow><mo stretchy="false">(</mo><mi>S</mi><mo>,</mo><mrow><mi>V</mi><mo>-</mo><mi>S</mi></mrow><mo stretchy="false">)</mo></mrow></math> is a cut of <math id="S6.SS3.SSS2.p2.m4" class="ltx_Math" alttext="G" display="inline"><mi>G</mi></math> that respects <math id="S6.SS3.SSS2.p2.m5" class="ltx_Math" alttext="A" display="inline"><mi>A</mi></math>, and let <math id="S6.SS3.SSS2.p2.m6" class="ltx_Math" alttext="(u,v)" display="inline"><mrow><mo stretchy="false">(</mo><mi>u</mi><mo>,</mo><mi>v</mi><mo stretchy="false">)</mo></mrow></math> be a light edge crossing the cut.
Let <math id="S6.SS3.SSS2.p2.m7" class="ltx_Math" alttext="T" display="inline"><mi>T</mi></math> be a minimum spanning tree that contains <math id="S6.SS3.SSS2.p2.m8" class="ltx_Math" alttext="A" display="inline"><mi>A</mi></math>.
If <math id="S6.SS3.SSS2.p2.m9" class="ltx_Math" alttext="(u,v)\in T" display="inline"><mrow><mrow><mo stretchy="false">(</mo><mi>u</mi><mo>,</mo><mi>v</mi><mo stretchy="false">)</mo></mrow><mo>∈</mo><mi>T</mi></mrow></math>, then obviously <math id="S6.SS3.SSS2.p2.m10" class="ltx_Math" alttext="(u,v)" display="inline"><mrow><mo stretchy="false">(</mo><mi>u</mi><mo>,</mo><mi>v</mi><mo stretchy="false">)</mo></mrow></math> is safe for <math id="S6.SS3.SSS2.p2.m11" class="ltx_Math" alttext="A" display="inline"><mi>A</mi></math>.
Otherwise, <math id="S6.SS3.SSS2.p2.m12" class="ltx_Math" alttext="T" display="inline"><mi>T</mi></math> contains a path from <math id="S6.SS3.SSS2.p2.m13" class="ltx_Math" alttext="u" display="inline"><mi>u</mi></math> to <math id="S6.SS3.SSS2.p2.m14" class="ltx_Math" alttext="v" display="inline"><mi>v</mi></math> but does not contain <math id="S6.SS3.SSS2.p2.m15" class="ltx_Math" alttext="(u,v)" display="inline"><mrow><mo stretchy="false">(</mo><mi>u</mi><mo>,</mo><mi>v</mi><mo stretchy="false">)</mo></mrow></math>.
The path from <math id="S6.SS3.SSS2.p2.m16" class="ltx_Math" alttext="u" display="inline"><mi>u</mi></math> to <math id="S6.SS3.SSS2.p2.m17" class="ltx_Math" alttext="v" display="inline"><mi>v</mi></math> with <math id="S6.SS3.SSS2.p2.m18" class="ltx_Math" alttext="(u,v)" display="inline"><mrow><mo stretchy="false">(</mo><mi>u</mi><mo>,</mo><mi>v</mi><mo stretchy="false">)</mo></mrow></math> added forms a cycle.
Since the cut crosses the cycle, there must be another edge <math id="S6.SS3.SSS2.p2.m19" class="ltx_Math" alttext="(x,y)" display="inline"><mrow><mo stretchy="false">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow></math> in the cycle that crosses the cut.
Since <math id="S6.SS3.SSS2.p2.m20" class="ltx_Math" alttext="(u,v)" display="inline"><mrow><mo stretchy="false">(</mo><mi>u</mi><mo>,</mo><mi>v</mi><mo stretchy="false">)</mo></mrow></math> is a light edge, we have <math id="S6.SS3.SSS2.p2.m21" class="ltx_Math" alttext="w(u,v)\leq w(x,y)" display="inline"><mrow><mrow><mi>w</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>u</mi><mo>,</mo><mi>v</mi><mo stretchy="false">)</mo></mrow></mrow><mo>≤</mo><mrow><mi>w</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow></mrow></mrow></math>.
Then we can replace <math id="S6.SS3.SSS2.p2.m22" class="ltx_Math" alttext="(x,y)" display="inline"><mrow><mo stretchy="false">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow></math> with <math id="S6.SS3.SSS2.p2.m23" class="ltx_Math" alttext="(u,v)" display="inline"><mrow><mo stretchy="false">(</mo><mi>u</mi><mo>,</mo><mi>v</mi><mo stretchy="false">)</mo></mrow></math> in <math id="S6.SS3.SSS2.p2.m24" class="ltx_Math" alttext="T" display="inline"><mi>T</mi></math> to get another spanning tree <math id="S6.SS3.SSS2.p2.m25" class="ltx_Math" alttext="T^{\prime}" display="inline"><msup><mi>T</mi><mo>′</mo></msup></math>.
Noting that <math id="S6.SS3.SSS2.p2.m26" class="ltx_Math" alttext="(x,y)" display="inline"><mrow><mo stretchy="false">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow></math> is not in <math id="S6.SS3.SSS2.p2.m27" class="ltx_Math" alttext="A" display="inline"><mi>A</mi></math>, since the cut respects <math id="S6.SS3.SSS2.p2.m28" class="ltx_Math" alttext="A" display="inline"><mi>A</mi></math>.
Hence, <math id="S6.SS3.SSS2.p2.m29" class="ltx_Math" alttext="T^{\prime}" display="inline"><msup><mi>T</mi><mo>′</mo></msup></math> contains <math id="S6.SS3.SSS2.p2.m30" class="ltx_Math" alttext="A" display="inline"><mi>A</mi></math>.
Therefore, <math id="S6.SS3.SSS2.p2.m31" class="ltx_Math" alttext="(u,v)" display="inline"><mrow><mo stretchy="false">(</mo><mi>u</mi><mo>,</mo><mi>v</mi><mo stretchy="false">)</mo></mrow></math> is safe for <math id="S6.SS3.SSS2.p2.m32" class="ltx_Math" alttext="A" display="inline"><mi>A</mi></math>.</p>
</div>
</section>
<section id="S6.SS3.SSS3" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">6.3.3 </span>Kruskal’s Algorithm</h4>

<div id="S6.SS3.SSS3.p1" class="ltx_para ltx_noindent">
<p class="ltx_p">Kruskal’s algorithm sorts all the edges in nondecreasing order by weight, and then adds the edges that connect two different components in the current forest.</p>
</div>
<div id="S6.SS3.SSS3.p2" class="ltx_para ltx_align_center">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr class="ltx_tr">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" colspan="2"><span class="ltx_text ltx_font_smallcaps">Kruskal<math id="S6.SS3.SSS3.p2.m1" class="ltx_Math" alttext="(G,w)" display="inline"><mrow><mo mathvariant="normal" stretchy="false">(</mo><mi>G</mi><mo mathvariant="normal">,</mo><mi>w</mi><mo mathvariant="normal" stretchy="false">)</mo></mrow></math></span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_t">1.</th>
<td class="ltx_td ltx_align_left ltx_border_t"><math id="S6.SS3.SSS3.p2.m2" class="ltx_Math" alttext="A=\emptyset" display="inline"><mrow><mi>A</mi><mo>=</mo><mi mathvariant="normal">∅</mi></mrow></math></td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">2.</th>
<td class="ltx_td ltx_align_left">
<span class="ltx_text ltx_font_bold">for</span> each vertex <math id="S6.SS3.SSS3.p2.m3" class="ltx_Math" alttext="v\in G.V" display="inline"><mrow><mrow><mi>v</mi><mo>∈</mo><mi>G</mi></mrow><mo>.</mo><mi>V</mi></mrow></math>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">3.</th>
<td class="ltx_td ltx_align_left"> <span class="ltx_text ltx_font_smallcaps">Make-Set<math id="S6.SS3.SSS3.p2.m4" class="ltx_Math" alttext="(v)" display="inline"><mrow><mo mathvariant="normal" stretchy="false">(</mo><mi>v</mi><mo mathvariant="normal" stretchy="false">)</mo></mrow></math></span>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">4.</th>
<td class="ltx_td ltx_align_left">sort the edges of <math id="S6.SS3.SSS3.p2.m5" class="ltx_Math" alttext="G.E" display="inline"><mrow><mi>G</mi><mo>.</mo><mi>E</mi></mrow></math> into nondecreasing order by weight <math id="S6.SS3.SSS3.p2.m6" class="ltx_Math" alttext="w" display="inline"><mi>w</mi></math>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">5.</th>
<td class="ltx_td ltx_align_left">
<span class="ltx_text ltx_font_bold">for</span> each edge <math id="S6.SS3.SSS3.p2.m7" class="ltx_Math" alttext="(u,v)\in G.E" display="inline"><mrow><mrow><mrow><mo stretchy="false">(</mo><mi>u</mi><mo>,</mo><mi>v</mi><mo stretchy="false">)</mo></mrow><mo>∈</mo><mi>G</mi></mrow><mo>.</mo><mi>E</mi></mrow></math>, taken in nondecreasing order by weight</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">6.</th>
<td class="ltx_td ltx_align_left"> <span class="ltx_text ltx_font_bold">if</span> <span class="ltx_text ltx_font_smallcaps">Find-Set<math id="S6.SS3.SSS3.p2.m8" class="ltx_Math" alttext="(u)\neq" display="inline"><mrow><mrow><mo mathvariant="normal" stretchy="false">(</mo><mi>u</mi><mo mathvariant="normal" stretchy="false">)</mo></mrow><mo mathvariant="normal">≠</mo><mi></mi></mrow></math></span> <span class="ltx_text ltx_font_smallcaps">Find-Set<math id="S6.SS3.SSS3.p2.m9" class="ltx_Math" alttext="(v)" display="inline"><mrow><mo mathvariant="normal" stretchy="false">(</mo><mi>v</mi><mo mathvariant="normal" stretchy="false">)</mo></mrow></math></span>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">7.</th>
<td class="ltx_td ltx_align_left">  <math id="S6.SS3.SSS3.p2.m10" class="ltx_Math" alttext="A=A\cup\{(u,v)\}" display="inline"><mrow><mi>A</mi><mo>=</mo><mrow><mi>A</mi><mo>∪</mo><mrow><mo stretchy="false">{</mo><mrow><mo stretchy="false">(</mo><mi>u</mi><mo>,</mo><mi>v</mi><mo stretchy="false">)</mo></mrow><mo stretchy="false">}</mo></mrow></mrow></mrow></math>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">8.</th>
<td class="ltx_td ltx_align_left">  <span class="ltx_text ltx_font_smallcaps">Union<math id="S6.SS3.SSS3.p2.m11" class="ltx_Math" alttext="(u,v)" display="inline"><mrow><mo mathvariant="normal" stretchy="false">(</mo><mi>u</mi><mo mathvariant="normal">,</mo><mi>v</mi><mo mathvariant="normal" stretchy="false">)</mo></mrow></math></span>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_bb">9.</th>
<td class="ltx_td ltx_align_left ltx_border_bb">
<span class="ltx_text ltx_font_bold">return</span> <math id="S6.SS3.SSS3.p2.m12" class="ltx_Math" alttext="A" display="inline"><mi>A</mi></math>
</td>
</tr>
</tbody>
</table>
</div>
<div id="S6.SS3.SSS3.p3" class="ltx_para ltx_noindent">
<p class="ltx_p"><span class="ltx_text ltx_font_bold">Runtime:</span>
<math id="S6.SS3.SSS3.p3.m1" class="ltx_Math" alttext="O(|E|\log|V|)" display="inline"><mrow><mi>O</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mrow><mo stretchy="false">|</mo><mi>E</mi><mo stretchy="false">|</mo></mrow><mo>⁢</mo><mrow><mi>log</mi><mo>⁡</mo><mrow><mo stretchy="false">|</mo><mi>V</mi><mo stretchy="false">|</mo></mrow></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow></math>
The major cost is sorting the edges, which takes <math id="S6.SS3.SSS3.p3.m2" class="ltx_Math" alttext="O(|E|\log|E|)=O(|E|\log|V|)" display="inline"><mrow><mrow><mi>O</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mrow><mo stretchy="false">|</mo><mi>E</mi><mo stretchy="false">|</mo></mrow><mo>⁢</mo><mrow><mi>log</mi><mo>⁡</mo><mrow><mo stretchy="false">|</mo><mi>E</mi><mo stretchy="false">|</mo></mrow></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><mi>O</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mrow><mo stretchy="false">|</mo><mi>E</mi><mo stretchy="false">|</mo></mrow><mo>⁢</mo><mrow><mi>log</mi><mo>⁡</mo><mrow><mo stretchy="false">|</mo><mi>V</mi><mo stretchy="false">|</mo></mrow></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow></mrow></math> time.</p>
</div>
</section>
<section id="S6.SS3.SSS4" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">6.3.4 </span>Prim’s Algorithm</h4>

<div id="S6.SS3.SSS4.p1" class="ltx_para ltx_noindent">
<p class="ltx_p">Prim’s algorithm grows a single tree by adding edges to the tree one by one.
We use a min-priority queue <math id="S6.SS3.SSS4.p1.m1" class="ltx_Math" alttext="Q" display="inline"><mi>Q</mi></math> to store the vertices.</p>
</div>
<div id="S6.SS3.SSS4.p2" class="ltx_para ltx_align_center">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr class="ltx_tr">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" colspan="2"><span class="ltx_text ltx_font_smallcaps">Prim<math id="S6.SS3.SSS4.p2.m1" class="ltx_Math" alttext="(G,w,r)" display="inline"><mrow><mo mathvariant="normal" stretchy="false">(</mo><mi>G</mi><mo mathvariant="normal">,</mo><mi>w</mi><mo mathvariant="normal">,</mo><mi>r</mi><mo mathvariant="normal" stretchy="false">)</mo></mrow></math></span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_t">1.</th>
<td class="ltx_td ltx_align_left ltx_border_t">
<span class="ltx_text ltx_font_bold">for</span> each <math id="S6.SS3.SSS4.p2.m2" class="ltx_Math" alttext="u\in G.V" display="inline"><mrow><mrow><mi>u</mi><mo>∈</mo><mi>G</mi></mrow><mo>.</mo><mi>V</mi></mrow></math>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">2.</th>
<td class="ltx_td ltx_align_left"> <math id="S6.SS3.SSS4.p2.m3" class="ltx_Math" alttext="u.key=\infty" display="inline"><mrow><mi>u</mi><mo>.</mo><mrow><mrow><mi>k</mi><mo>⁢</mo><mi>e</mi><mo>⁢</mo><mi>y</mi></mrow><mo>=</mo><mi mathvariant="normal">∞</mi></mrow></mrow></math>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">3.</th>
<td class="ltx_td ltx_align_left"> <math id="S6.SS3.SSS4.p2.m4" class="ltx_Math" alttext="u.\pi=NIL" display="inline"><mrow><mi>u</mi><mo>.</mo><mrow><mi>π</mi><mo>=</mo><mrow><mi>N</mi><mo>⁢</mo><mi>I</mi><mo>⁢</mo><mi>L</mi></mrow></mrow></mrow></math>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">4.</th>
<td class="ltx_td ltx_align_left"><math id="S6.SS3.SSS4.p2.m5" class="ltx_Math" alttext="r.key=0" display="inline"><mrow><mi>r</mi><mo>.</mo><mrow><mrow><mi>k</mi><mo>⁢</mo><mi>e</mi><mo>⁢</mo><mi>y</mi></mrow><mo>=</mo><mn>0</mn></mrow></mrow></math></td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">5.</th>
<td class="ltx_td ltx_align_left"><math id="S6.SS3.SSS4.p2.m6" class="ltx_Math" alttext="Q=G.V" display="inline"><mrow><mrow><mi>Q</mi><mo>=</mo><mi>G</mi></mrow><mo>.</mo><mi>V</mi></mrow></math></td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">6.</th>
<td class="ltx_td ltx_align_left">
<span class="ltx_text ltx_font_bold">while</span> <math id="S6.SS3.SSS4.p2.m7" class="ltx_Math" alttext="Q\neq\emptyset" display="inline"><mrow><mi>Q</mi><mo>≠</mo><mi mathvariant="normal">∅</mi></mrow></math>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">7.</th>
<td class="ltx_td ltx_align_left"> <math id="S6.SS3.SSS4.p2.m8" class="ltx_Math" alttext="u=\textsc{Extract-Min}(Q)" display="inline"><mrow><mi>u</mi><mo>=</mo><mrow><mtext class="ltx_font_smallcaps" mathvariant="normal">Extract-Min</mtext><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>Q</mi><mo stretchy="false">)</mo></mrow></mrow></mrow></math>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">8.</th>
<td class="ltx_td ltx_align_left"> <span class="ltx_text ltx_font_bold">for</span> each <math id="S6.SS3.SSS4.p2.m9" class="ltx_Math" alttext="v\in G.Adj[u]" display="inline"><mrow><mrow><mi>v</mi><mo>∈</mo><mi>G</mi></mrow><mo>.</mo><mrow><mi>A</mi><mo>⁢</mo><mi>d</mi><mo>⁢</mo><mi>j</mi><mo>⁢</mo><mrow><mo stretchy="false">[</mo><mi>u</mi><mo stretchy="false">]</mo></mrow></mrow></mrow></math>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">9.</th>
<td class="ltx_td ltx_align_left">  <span class="ltx_text ltx_font_bold">if</span> <math id="S6.SS3.SSS4.p2.m10" class="ltx_Math" alttext="v\in Q" display="inline"><mrow><mi>v</mi><mo>∈</mo><mi>Q</mi></mrow></math> and <math id="S6.SS3.SSS4.p2.m11" class="ltx_Math" alttext="w(u,v)&lt;v.key" display="inline"><mrow><mrow><mrow><mi>w</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>u</mi><mo>,</mo><mi>v</mi><mo stretchy="false">)</mo></mrow></mrow><mo>&lt;</mo><mi>v</mi></mrow><mo>.</mo><mrow><mi>k</mi><mo>⁢</mo><mi>e</mi><mo>⁢</mo><mi>y</mi></mrow></mrow></math>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">10.</th>
<td class="ltx_td ltx_align_left">   <math id="S6.SS3.SSS4.p2.m12" class="ltx_Math" alttext="v.\pi=u" display="inline"><mrow><mi>v</mi><mo>.</mo><mrow><mi>π</mi><mo>=</mo><mi>u</mi></mrow></mrow></math>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_bb">11.</th>
<td class="ltx_td ltx_align_left ltx_border_bb">   <span class="ltx_text ltx_font_smallcaps">Decrease-Key<math id="S6.SS3.SSS4.p2.m13" class="ltx_Math" alttext="(Q,v,w(u,v))" display="inline"><mrow><mo mathvariant="normal" stretchy="false">(</mo><mi>Q</mi><mo mathvariant="normal">,</mo><mi>v</mi><mo mathvariant="normal">,</mo><mrow><mi>w</mi><mo class="ltx_font_smallcaps" mathvariant="normal">⁢</mo><mrow><mo mathvariant="normal" stretchy="false">(</mo><mi>u</mi><mo mathvariant="normal">,</mo><mi>v</mi><mo mathvariant="normal" stretchy="false">)</mo></mrow></mrow><mo mathvariant="normal" stretchy="false">)</mo></mrow></math></span>
</td>
</tr>
</tbody>
</table>
</div>
<div id="S6.SS3.SSS4.p3" class="ltx_para ltx_noindent">
<p class="ltx_p"><span class="ltx_text ltx_font_bold">Runtime:</span>
<math id="S6.SS3.SSS4.p3.m1" class="ltx_Math" alttext="O(|E|\log|V|)" display="inline"><mrow><mi>O</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mrow><mo stretchy="false">|</mo><mi>E</mi><mo stretchy="false">|</mo></mrow><mo>⁢</mo><mrow><mi>log</mi><mo>⁡</mo><mrow><mo stretchy="false">|</mo><mi>V</mi><mo stretchy="false">|</mo></mrow></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow></math>
Dominated by the <span class="ltx_text ltx_font_smallcaps">Decrease-Key</span> operations, which takes <math id="S6.SS3.SSS4.p3.m2" class="ltx_Math" alttext="O(|E|\log|V|)" display="inline"><mrow><mi>O</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mrow><mo stretchy="false">|</mo><mi>E</mi><mo stretchy="false">|</mo></mrow><mo>⁢</mo><mrow><mi>log</mi><mo>⁡</mo><mrow><mo stretchy="false">|</mo><mi>V</mi><mo stretchy="false">|</mo></mrow></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow></math> time.</p>
</div>
</section>
</section>
<section id="S6.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.4 </span>Single Source Shortest Path</h3>

<section id="S6.SS4.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">6.4.1 </span>Dijkstra’s Algorithm</h4>

<div id="S6.SS4.SSS1.p1" class="ltx_para ltx_noindent">
<p class="ltx_p">We can use Dijkstra’s algorithm to find the shortest path from a single source to all other vertices.
The idea is very similar to Prim’s algorithm.</p>
</div>
<div id="S6.SS4.SSS1.p2" class="ltx_para ltx_align_center">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr class="ltx_tr">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" colspan="2"><span class="ltx_text ltx_font_smallcaps">Dijkstra<math id="S6.SS4.SSS1.p2.m1" class="ltx_Math" alttext="(G,w,s)" display="inline"><mrow><mo mathvariant="normal" stretchy="false">(</mo><mi>G</mi><mo mathvariant="normal">,</mo><mi>w</mi><mo mathvariant="normal">,</mo><mi>s</mi><mo mathvariant="normal" stretchy="false">)</mo></mrow></math></span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_t">1.</th>
<td class="ltx_td ltx_align_left ltx_border_t"><math id="S6.SS4.SSS1.p2.m2" class="ltx_Math" alttext="S=\emptyset" display="inline"><mrow><mi>S</mi><mo>=</mo><mi mathvariant="normal">∅</mi></mrow></math></td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">2.</th>
<td class="ltx_td ltx_align_left"><math id="S6.SS4.SSS1.p2.m3" class="ltx_Math" alttext="Q=G.V" display="inline"><mrow><mrow><mi>Q</mi><mo>=</mo><mi>G</mi></mrow><mo>.</mo><mi>V</mi></mrow></math></td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">3.</th>
<td class="ltx_td ltx_align_left"><span class="ltx_text ltx_font_smallcaps">Build-Min-Heap<math id="S6.SS4.SSS1.p2.m4" class="ltx_Math" alttext="(Q)" display="inline"><mrow><mo mathvariant="normal" stretchy="false">(</mo><mi>Q</mi><mo mathvariant="normal" stretchy="false">)</mo></mrow></math></span></td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">4.</th>
<td class="ltx_td ltx_align_left">
<span class="ltx_text ltx_font_bold">while</span> <math id="S6.SS4.SSS1.p2.m5" class="ltx_Math" alttext="Q\neq\emptyset" display="inline"><mrow><mi>Q</mi><mo>≠</mo><mi mathvariant="normal">∅</mi></mrow></math>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">5.</th>
<td class="ltx_td ltx_align_left"> <math id="S6.SS4.SSS1.p2.m6" class="ltx_Math" alttext="u=\textsc{Extract-Min}(Q)" display="inline"><mrow><mi>u</mi><mo>=</mo><mrow><mtext class="ltx_font_smallcaps" mathvariant="normal">Extract-Min</mtext><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>Q</mi><mo stretchy="false">)</mo></mrow></mrow></mrow></math>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">6.</th>
<td class="ltx_td ltx_align_left"> <math id="S6.SS4.SSS1.p2.m7" class="ltx_Math" alttext="S=S\cup\{u\}" display="inline"><mrow><mi>S</mi><mo>=</mo><mrow><mi>S</mi><mo>∪</mo><mrow><mo stretchy="false">{</mo><mi>u</mi><mo stretchy="false">}</mo></mrow></mrow></mrow></math>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">7.</th>
<td class="ltx_td ltx_align_left"> <span class="ltx_text ltx_font_bold">for</span> each <math id="S6.SS4.SSS1.p2.m8" class="ltx_Math" alttext="v\in G.Adj[u]" display="inline"><mrow><mrow><mi>v</mi><mo>∈</mo><mi>G</mi></mrow><mo>.</mo><mrow><mi>A</mi><mo>⁢</mo><mi>d</mi><mo>⁢</mo><mi>j</mi><mo>⁢</mo><mrow><mo stretchy="false">[</mo><mi>u</mi><mo stretchy="false">]</mo></mrow></mrow></mrow></math>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">8.</th>
<td class="ltx_td ltx_align_left">  <span class="ltx_text ltx_font_bold">if</span> <math id="S6.SS4.SSS1.p2.m9" class="ltx_Math" alttext="v.d&gt;u.d+w(u,v)" display="inline"><mrow><mi>v</mi><mo>.</mo><mrow><mi>d</mi><mo>&gt;</mo><mi>u</mi></mrow><mo>.</mo><mrow><mi>d</mi><mo>+</mo><mrow><mi>w</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>u</mi><mo>,</mo><mi>v</mi><mo stretchy="false">)</mo></mrow></mrow></mrow></mrow></math>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row">10.</th>
<td class="ltx_td ltx_align_left">   <math id="S6.SS4.SSS1.p2.m10" class="ltx_Math" alttext="v.\pi=u" display="inline"><mrow><mi>v</mi><mo>.</mo><mrow><mi>π</mi><mo>=</mo><mi>u</mi></mrow></mrow></math>
</td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_bb">11.</th>
<td class="ltx_td ltx_align_left ltx_border_bb">   <span class="ltx_text ltx_font_smallcaps">Decrease-Key<math id="S6.SS4.SSS1.p2.m11" class="ltx_Math" alttext="(Q,v,u.d+w(u,v))" display="inline"><mrow><mo mathvariant="normal" stretchy="false">(</mo><mrow><mrow><mi>Q</mi><mo mathvariant="normal">,</mo><mi>v</mi><mo mathvariant="normal">,</mo><mi>u</mi></mrow><mo mathvariant="normal">.</mo><mrow><mi>d</mi><mo mathvariant="normal">+</mo><mrow><mi>w</mi><mo class="ltx_font_smallcaps" mathvariant="normal">⁢</mo><mrow><mo mathvariant="normal" stretchy="false">(</mo><mi>u</mi><mo mathvariant="normal">,</mo><mi>v</mi><mo mathvariant="normal" stretchy="false">)</mo></mrow></mrow></mrow></mrow><mo mathvariant="normal" stretchy="false">)</mo></mrow></math></span>
</td>
</tr>
</tbody>
</table>
</div>
<div id="S6.SS4.SSS1.p3" class="ltx_para ltx_noindent">
<p class="ltx_p"><span class="ltx_text ltx_font_bold">Runtime:</span>
<math id="S6.SS4.SSS1.p3.m1" class="ltx_Math" alttext="O(|E|\log|V|)" display="inline"><mrow><mi>O</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mrow><mo stretchy="false">|</mo><mi>E</mi><mo stretchy="false">|</mo></mrow><mo>⁢</mo><mrow><mi>log</mi><mo>⁡</mo><mrow><mo stretchy="false">|</mo><mi>V</mi><mo stretchy="false">|</mo></mrow></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow></math>.
The <span class="ltx_text ltx_font_smallcaps">Build-Min-Heap</span> takes <math id="S6.SS4.SSS1.p3.m2" class="ltx_Math" alttext="O(|V|)" display="inline"><mrow><mi>O</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mo stretchy="false">|</mo><mi>V</mi><mo stretchy="false">|</mo></mrow><mo stretchy="false">)</mo></mrow></mrow></math> time.
All calls for <span class="ltx_text ltx_font_smallcaps">Extract-Min</span> takes <math id="S6.SS4.SSS1.p3.m3" class="ltx_Math" alttext="O(|V|\log|V|)" display="inline"><mrow><mi>O</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mrow><mo stretchy="false">|</mo><mi>V</mi><mo stretchy="false">|</mo></mrow><mo>⁢</mo><mrow><mi>log</mi><mo>⁡</mo><mrow><mo stretchy="false">|</mo><mi>V</mi><mo stretchy="false">|</mo></mrow></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow></math> time.
All calls for <span class="ltx_text ltx_font_smallcaps">Decrease-Key</span> takes <math id="S6.SS4.SSS1.p3.m4" class="ltx_Math" alttext="O(|E|\log|V|)" display="inline"><mrow><mi>O</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mrow><mo stretchy="false">|</mo><mi>E</mi><mo stretchy="false">|</mo></mrow><mo>⁢</mo><mrow><mi>log</mi><mo>⁡</mo><mrow><mo stretchy="false">|</mo><mi>V</mi><mo stretchy="false">|</mo></mrow></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow></math> time.</p>
</div>
<div id="S6.SS4.SSS1.p4" class="ltx_para ltx_noindent">
<p class="ltx_p"><span class="ltx_text ltx_font_bold">Correctness:</span>
Prove by loop invariant:
Before each iteration of the while loop, for each vertex <math id="S6.SS4.SSS1.p4.m1" class="ltx_Math" alttext="v\in S" display="inline"><mrow><mi>v</mi><mo>∈</mo><mi>S</mi></mrow></math>, <math id="S6.SS4.SSS1.p4.m2" class="ltx_Math" alttext="v.d" display="inline"><mrow><mi>v</mi><mo>.</mo><mi>d</mi></mrow></math> is the weight of the shortest path from <math id="S6.SS4.SSS1.p4.m3" class="ltx_Math" alttext="s" display="inline"><mi>s</mi></math> to <math id="S6.SS4.SSS1.p4.m4" class="ltx_Math" alttext="v" display="inline"><mi>v</mi></math>.
We can proof the maintenance of the loop invariant by contradiction:
If <math id="S6.SS4.SSS1.p4.m5" class="ltx_Math" alttext="u" display="inline"><mi>u</mi></math> is the first vertex that does not satisfy <math id="S6.SS4.SSS1.p4.m6" class="ltx_Math" alttext="u.d=d(s,u)" display="inline"><mrow><mi>u</mi><mo>.</mo><mrow><mi>d</mi><mo>=</mo><mrow><mi>d</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>s</mi><mo>,</mo><mi>u</mi><mo stretchy="false">)</mo></mrow></mrow></mrow></mrow></math> when it is added to <math id="S6.SS4.SSS1.p4.m7" class="ltx_Math" alttext="S" display="inline"><mi>S</mi></math>, then we can find a shortest path from <math id="S6.SS4.SSS1.p4.m8" class="ltx_Math" alttext="s" display="inline"><mi>s</mi></math> to <math id="S6.SS4.SSS1.p4.m9" class="ltx_Math" alttext="u" display="inline"><mi>u</mi></math>.
Let <math id="S6.SS4.SSS1.p4.m10" class="ltx_Math" alttext="x" display="inline"><mi>x</mi></math> be the last vertex in <math id="S6.SS4.SSS1.p4.m11" class="ltx_Math" alttext="S" display="inline"><mi>S</mi></math> on the shortest path and <math id="S6.SS4.SSS1.p4.m12" class="ltx_Math" alttext="y" display="inline"><mi>y</mi></math> be the first vertex in <math id="S6.SS4.SSS1.p4.m13" class="ltx_Math" alttext="V-S" display="inline"><mrow><mi>V</mi><mo>-</mo><mi>S</mi></mrow></math> on the shortest path.
Notice that <math id="S6.SS4.SSS1.p4.m14" class="ltx_Math" alttext="x" display="inline"><mi>x</mi></math> might be <math id="S6.SS4.SSS1.p4.m15" class="ltx_Math" alttext="s" display="inline"><mi>s</mi></math> and <math id="S6.SS4.SSS1.p4.m16" class="ltx_Math" alttext="y" display="inline"><mi>y</mi></math> might be <math id="S6.SS4.SSS1.p4.m17" class="ltx_Math" alttext="u" display="inline"><mi>u</mi></math>.
By the choice of <math id="S6.SS4.SSS1.p4.m18" class="ltx_Math" alttext="u" display="inline"><mi>u</mi></math>, we have <math id="S6.SS4.SSS1.p4.m19" class="ltx_Math" alttext="x.d=d(s,x)" display="inline"><mrow><mi>x</mi><mo>.</mo><mrow><mi>d</mi><mo>=</mo><mrow><mi>d</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>s</mi><mo>,</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></mrow></mrow></mrow></math> and <math id="S6.SS4.SSS1.p4.m20" class="ltx_Math" alttext="y.d=d(s,y)" display="inline"><mrow><mi>y</mi><mo>.</mo><mrow><mi>d</mi><mo>=</mo><mrow><mi>d</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>s</mi><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow></mrow></mrow></mrow></math>.
Then we have <math id="S6.SS4.SSS1.p4.m21" class="ltx_Math" alttext="y.d=d(s,y)\leq d(s,u)\leq u.d" display="inline"><mrow><mi>y</mi><mo>.</mo><mrow><mi>d</mi><mo>=</mo><mrow><mi>d</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>s</mi><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow></mrow><mo>≤</mo><mrow><mi>d</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>s</mi><mo>,</mo><mi>u</mi><mo stretchy="false">)</mo></mrow></mrow><mo>≤</mo><mi>u</mi></mrow><mo>.</mo><mi>d</mi></mrow></math>.
However, since the queue choose <math id="S6.SS4.SSS1.p4.m22" class="ltx_Math" alttext="u" display="inline"><mi>u</mi></math> to be the next vertex, we have <math id="S6.SS4.SSS1.p4.m23" class="ltx_Math" alttext="u.d\leq y.d" display="inline"><mrow><mi>u</mi><mo>.</mo><mrow><mi>d</mi><mo>≤</mo><mi>y</mi></mrow><mo>.</mo><mi>d</mi></mrow></math>.
This means all the inequalities are equalities, and we get <math id="S6.SS4.SSS1.p4.m24" class="ltx_Math" alttext="d(s,u)=d.u" display="inline"><mrow><mrow><mrow><mi>d</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>s</mi><mo>,</mo><mi>u</mi><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mi>d</mi></mrow><mo>.</mo><mi>u</mi></mrow></math>.</p>
</div>
</section>
</section>
</section>
<section id="S7" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">7 </span>Related Concepts</h2>

<section id="S7.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">7.1 </span>Asymptotic Notation</h3>

<section id="S7.SS1.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">7.1.1 </span>Definition of <math id="S7.SS1.SSS1.m1" class="ltx_Math" alttext="\Theta" display="inline"><mi mathvariant="normal">Θ</mi></math>
</h4>

<div id="S7.SS1.SSS1.p1" class="ltx_para ltx_noindent">
<p class="ltx_p">A function <math id="S7.SS1.SSS1.p1.m1" class="ltx_Math" alttext="f(n)" display="inline"><mrow><mi>f</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></mrow></math> belongs to <math id="S7.SS1.SSS1.p1.m2" class="ltx_Math" alttext="\Theta(g(n))" display="inline"><mrow><mi mathvariant="normal">Θ</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mi>g</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow></math> if there exist constants <math id="S7.SS1.SSS1.p1.m3" class="ltx_Math" alttext="0&lt;c_{1}\leq c_{2}" display="inline"><mrow><mn>0</mn><mo>&lt;</mo><msub><mi>c</mi><mn>1</mn></msub><mo>≤</mo><msub><mi>c</mi><mn>2</mn></msub></mrow></math> and <math id="S7.SS1.SSS1.p1.m4" class="ltx_Math" alttext="n_{0}" display="inline"><msub><mi>n</mi><mn>0</mn></msub></math> such that <math id="S7.SS1.SSS1.p1.m5" class="ltx_Math" alttext="0&lt;c_{1}g(n)\leq f(n)\leq c_{2}g(n)" display="inline"><mrow><mn>0</mn><mo>&lt;</mo><mrow><msub><mi>c</mi><mn>1</mn></msub><mo>⁢</mo><mi>g</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></mrow><mo>≤</mo><mrow><mi>f</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></mrow><mo>≤</mo><mrow><msub><mi>c</mi><mn>2</mn></msub><mo>⁢</mo><mi>g</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></mrow></mrow></math> for all <math id="S7.SS1.SSS1.p1.m6" class="ltx_Math" alttext="n\geq n_{0}" display="inline"><mrow><mi>n</mi><mo>≥</mo><msub><mi>n</mi><mn>0</mn></msub></mrow></math>.</p>
</div>
<div id="S7.SS1.SSS1.p2" class="ltx_para ltx_noindent">
<p class="ltx_p">An easy way to proof: divide both side by <math id="S7.SS1.SSS1.p2.m1" class="ltx_Math" alttext="g(n)" display="inline"><mrow><mi>g</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></mrow></math>.
For example to proof <math id="S7.SS1.SSS1.p2.m2" class="ltx_Math" alttext="0\leq c_{1}n^{2}\leq n^{2}+2n+3\leq c_{2}n^{2}" display="inline"><mrow><mn>0</mn><mo>≤</mo><mrow><msub><mi>c</mi><mn>1</mn></msub><mo>⁢</mo><msup><mi>n</mi><mn>2</mn></msup></mrow><mo>≤</mo><mrow><msup><mi>n</mi><mn>2</mn></msup><mo>+</mo><mrow><mn>2</mn><mo>⁢</mo><mi>n</mi></mrow><mo>+</mo><mn>3</mn></mrow><mo>≤</mo><mrow><msub><mi>c</mi><mn>2</mn></msub><mo>⁢</mo><msup><mi>n</mi><mn>2</mn></msup></mrow></mrow></math> for all <math id="S7.SS1.SSS1.p2.m3" class="ltx_Math" alttext="n\geq 1" display="inline"><mrow><mi>n</mi><mo>≥</mo><mn>1</mn></mrow></math>.</p>
<table id="S7.Ex7" class="ltx_equation ltx_eqn_table">

<tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S7.Ex7.m1" class="ltx_Math" alttext="0\leq c_{1}n^{2}\leq n^{2}+2n+3\leq c_{2}n^{2}\rightarrow 0\leq c_{1}\leq 1+%
\frac{2}{n}+\frac{3}{n^{2}}\leq c_{2}" display="block"><mrow><mn>0</mn><mo>≤</mo><mrow><msub><mi>c</mi><mn>1</mn></msub><mo>⁢</mo><msup><mi>n</mi><mn>2</mn></msup></mrow><mo>≤</mo><mrow><msup><mi>n</mi><mn>2</mn></msup><mo>+</mo><mrow><mn>2</mn><mo>⁢</mo><mi>n</mi></mrow><mo>+</mo><mn>3</mn></mrow><mo>≤</mo><mrow><msub><mi>c</mi><mn>2</mn></msub><mo>⁢</mo><msup><mi>n</mi><mn>2</mn></msup></mrow><mo>→</mo><mn>0</mn><mo>≤</mo><msub><mi>c</mi><mn>1</mn></msub><mo>≤</mo><mrow><mn>1</mn><mo>+</mo><mfrac><mn>2</mn><mi>n</mi></mfrac><mo>+</mo><mfrac><mn>3</mn><msup><mi>n</mi><mn>2</mn></msup></mfrac></mrow><mo>≤</mo><msub><mi>c</mi><mn>2</mn></msub></mrow></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</table>
</div>
<div id="S7.SS1.SSS1.p3" class="ltx_para ltx_noindent">
<p class="ltx_p">Similar to <math id="S7.SS1.SSS1.p3.m1" class="ltx_Math" alttext="O" display="inline"><mi>O</mi></math> and <math id="S7.SS1.SSS1.p3.m2" class="ltx_Math" alttext="\Omega" display="inline"><mi mathvariant="normal">Ω</mi></math>.
A function <math id="S7.SS1.SSS1.p3.m3" class="ltx_Math" alttext="f(n)" display="inline"><mrow><mi>f</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></mrow></math> belongs to <math id="S7.SS1.SSS1.p3.m4" class="ltx_Math" alttext="O(g(n))" display="inline"><mrow><mi>O</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mi>g</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow></math> if there exist constants <math id="S7.SS1.SSS1.p3.m5" class="ltx_Math" alttext="0\leq c" display="inline"><mrow><mn>0</mn><mo>≤</mo><mi>c</mi></mrow></math> and <math id="S7.SS1.SSS1.p3.m6" class="ltx_Math" alttext="n_{0}" display="inline"><msub><mi>n</mi><mn>0</mn></msub></math> such that <math id="S7.SS1.SSS1.p3.m7" class="ltx_Math" alttext="0\leq f(n)\leq cg(n)" display="inline"><mrow><mn>0</mn><mo>≤</mo><mrow><mi>f</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></mrow><mo>≤</mo><mrow><mi>c</mi><mo>⁢</mo><mi>g</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></mrow></mrow></math> for all <math id="S7.SS1.SSS1.p3.m8" class="ltx_Math" alttext="n\geq n_{0}" display="inline"><mrow><mi>n</mi><mo>≥</mo><msub><mi>n</mi><mn>0</mn></msub></mrow></math>.
A function <math id="S7.SS1.SSS1.p3.m9" class="ltx_Math" alttext="f(n)" display="inline"><mrow><mi>f</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></mrow></math> belongs to <math id="S7.SS1.SSS1.p3.m10" class="ltx_Math" alttext="\Omega(g(n))" display="inline"><mrow><mi mathvariant="normal">Ω</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mi>g</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow></math> if there exist constants <math id="S7.SS1.SSS1.p3.m11" class="ltx_Math" alttext="0\leq c" display="inline"><mrow><mn>0</mn><mo>≤</mo><mi>c</mi></mrow></math> and <math id="S7.SS1.SSS1.p3.m12" class="ltx_Math" alttext="n_{0}" display="inline"><msub><mi>n</mi><mn>0</mn></msub></math> such that <math id="S7.SS1.SSS1.p3.m13" class="ltx_Math" alttext="0\leq cg(n)\leq f(n)" display="inline"><mrow><mn>0</mn><mo>≤</mo><mrow><mi>c</mi><mo>⁢</mo><mi>g</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></mrow><mo>≤</mo><mrow><mi>f</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></mrow></mrow></math> for all <math id="S7.SS1.SSS1.p3.m14" class="ltx_Math" alttext="n\geq n_{0}" display="inline"><mrow><mi>n</mi><mo>≥</mo><msub><mi>n</mi><mn>0</mn></msub></mrow></math>.</p>
</div>
<div id="S7.SS1.SSS1.p4" class="ltx_para ltx_noindent">
<p class="ltx_p">In general, big <math id="S7.SS1.SSS1.p4.m1" class="ltx_Math" alttext="\Theta" display="inline"><mi mathvariant="normal">Θ</mi></math> is used to describe the tight bound of a function, big <math id="S7.SS1.SSS1.p4.m2" class="ltx_Math" alttext="O" display="inline"><mi>O</mi></math> is used to describe the upper bound of a function, and big <math id="S7.SS1.SSS1.p4.m3" class="ltx_Math" alttext="\Omega" display="inline"><mi mathvariant="normal">Ω</mi></math> is used to describe the lower bound of a function.</p>
</div>
</section>
<section id="S7.SS1.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">7.1.2 </span>Little <math id="S7.SS1.SSS2.m1" class="ltx_Math" alttext="o" display="inline"><mi>o</mi></math> and Little <math id="S7.SS1.SSS2.m2" class="ltx_Math" alttext="\omega" display="inline"><mi>ω</mi></math>
</h4>

<div id="S7.SS1.SSS2.p1" class="ltx_para ltx_noindent">
<p class="ltx_p">A function <math id="S7.SS1.SSS2.p1.m1" class="ltx_Math" alttext="f(n)" display="inline"><mrow><mi>f</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></mrow></math> belongs to <math id="S7.SS1.SSS2.p1.m2" class="ltx_Math" alttext="o(g(n))" display="inline"><mrow><mi>o</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mi>g</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow></math> if <math id="S7.SS1.SSS2.p1.m3" class="ltx_Math" alttext="\lim_{n\to\infty}\frac{f(n)}{g(n)}=0" display="inline"><mrow><mrow><msub><mo>lim</mo><mrow><mi>n</mi><mo>→</mo><mi mathvariant="normal">∞</mi></mrow></msub><mo>⁡</mo><mfrac><mrow><mi>f</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></mrow><mrow><mi>g</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></mrow></mfrac></mrow><mo>=</mo><mn>0</mn></mrow></math>.
A function <math id="S7.SS1.SSS2.p1.m4" class="ltx_Math" alttext="f(n)" display="inline"><mrow><mi>f</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></mrow></math> belongs to <math id="S7.SS1.SSS2.p1.m5" class="ltx_Math" alttext="\omega(g(n))" display="inline"><mrow><mi>ω</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mi>g</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow></math> if <math id="S7.SS1.SSS2.p1.m6" class="ltx_Math" alttext="\lim_{n\to\infty}\frac{f(n)}{g(n)}=\infty" display="inline"><mrow><mrow><msub><mo>lim</mo><mrow><mi>n</mi><mo>→</mo><mi mathvariant="normal">∞</mi></mrow></msub><mo>⁡</mo><mfrac><mrow><mi>f</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></mrow><mrow><mi>g</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></mrow></mfrac></mrow><mo>=</mo><mi mathvariant="normal">∞</mi></mrow></math>, or equivalently, <math id="S7.SS1.SSS2.p1.m7" class="ltx_Math" alttext="g(n)" display="inline"><mrow><mi>g</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></mrow></math> belongs to <math id="S7.SS1.SSS2.p1.m8" class="ltx_Math" alttext="o(f(n))" display="inline"><mrow><mi>o</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mi>f</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow></math>.</p>
</div>
</section>
<section id="S7.SS1.SSS3" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">7.1.3 </span>Important Inequalities</h4>

<div id="S7.SS1.SSS3.p1" class="ltx_para ltx_noindent">
<p class="ltx_p">Every polynomial of <math id="S7.SS1.SSS3.p1.m1" class="ltx_Math" alttext="\log n" display="inline"><mrow><mi>log</mi><mo>⁡</mo><mi>n</mi></mrow></math> grows slower than every polynomial of <math id="S7.SS1.SSS3.p1.m2" class="ltx_Math" alttext="n" display="inline"><mi>n</mi></math>.
That is: <math id="S7.SS1.SSS3.p1.m3" class="ltx_Math" alttext="(\log n)^{100}=o(n^{0.01})" display="inline"><mrow><msup><mrow><mo stretchy="false">(</mo><mrow><mi>log</mi><mo>⁡</mo><mi>n</mi></mrow><mo stretchy="false">)</mo></mrow><mn>100</mn></msup><mo>=</mo><mrow><mi>o</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><msup><mi>n</mi><mn>0.01</mn></msup><mo stretchy="false">)</mo></mrow></mrow></mrow></math>.</p>
</div>
<div id="S7.SS1.SSS3.p2" class="ltx_para ltx_noindent">
<p class="ltx_p">Every polynomial of <math id="S7.SS1.SSS3.p2.m1" class="ltx_Math" alttext="n" display="inline"><mi>n</mi></math> grows slower than every exponential <math id="S7.SS1.SSS3.p2.m2" class="ltx_Math" alttext="2^{n^{c}}" display="inline"><msup><mn>2</mn><msup><mi>n</mi><mi>c</mi></msup></msup></math>.
That is: <math id="S7.SS1.SSS3.p2.m3" class="ltx_Math" alttext="n^{100}=o(2^{n^{0.01}})" display="inline"><mrow><msup><mi>n</mi><mn>100</mn></msup><mo>=</mo><mrow><mi>o</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><msup><mn>2</mn><msup><mi>n</mi><mn>0.01</mn></msup></msup><mo stretchy="false">)</mo></mrow></mrow></mrow></math>.</p>
</div>
</section>
<section id="S7.SS1.SSS4" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">7.1.4 </span>Rule of Sum and Rule of Product</h4>

<div id="S7.SS1.SSS4.p1" class="ltx_para ltx_noindent">
<p class="ltx_p">Rule of Sum: <math id="S7.SS1.SSS4.p1.m1" class="ltx_Math" alttext="f(n)+g(n)=\Theta(\max(f(n),g(n)))" display="inline"><mrow><mrow><mrow><mi>f</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></mrow><mo>+</mo><mrow><mi>g</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></mrow></mrow><mo>=</mo><mrow><mi mathvariant="normal">Θ</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mi>max</mi><mo>⁡</mo><mrow><mo stretchy="false">(</mo><mrow><mi>f</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></mrow><mo>,</mo><mrow><mi>g</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow></mrow></math>.</p>
</div>
<div id="S7.SS1.SSS4.p2" class="ltx_para ltx_noindent">
<p class="ltx_p">Rule of Product: <math id="S7.SS1.SSS4.p2.m1" class="ltx_Math" alttext="f(n)\cdot g(n)=\Theta(f(n)\cdot g(n))" display="inline"><mrow><mrow><mrow><mrow><mi>f</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></mrow><mo>⋅</mo><mi>g</mi></mrow><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><mi mathvariant="normal">Θ</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mrow><mrow><mi>f</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></mrow><mo>⋅</mo><mi>g</mi></mrow><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow></mrow></math>.</p>
</div>
</section>
</section>
<section id="S7.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">7.2 </span>RAM Model</h3>

<div id="S7.SS2.p1" class="ltx_para ltx_noindent">
<p class="ltx_p">The RAM model assumes that each elementary operation takes the same amount of time.</p>
</div>
</section>
<section id="S7.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">7.3 </span>Common Cost Model</h3>

<div id="S7.SS3.p1" class="ltx_para ltx_noindent">
<p class="ltx_p">Assume the runtime of an algorithm is the number of elementary operations it performs.</p>
</div>
</section>
<section id="S7.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">7.4 </span>In place</h3>

<div id="S7.SS4.p1" class="ltx_para ltx_noindent">
<p class="ltx_p">A sorting algorithm is said to be in place if it requires <math id="S7.SS4.p1.m1" class="ltx_Math" alttext="O(1)" display="inline"><mrow><mi>O</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></mrow></math> additional space.
Hence, merge sort is not in place, since it requires <math id="S7.SS4.p1.m2" class="ltx_Math" alttext="\Omega(n)" display="inline"><mrow><mi mathvariant="normal">Ω</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></mrow></math> additional space.</p>
</div>
</section>
<section id="S7.SS5" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">7.5 </span>Stable</h3>

<div id="S7.SS5.p1" class="ltx_para ltx_noindent">
<p class="ltx_p">A sorting algorithm is said to be stable if it preserves the relative order of equal elements.</p>
</div>
</section>
<section id="S7.SS6" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">7.6 </span>Master Theorem</h3>

<div id="S7.SS6.p1" class="ltx_para ltx_noindent">
<p class="ltx_p">Let <math id="S7.SS6.p1.m1" class="ltx_Math" alttext="a&gt;0" display="inline"><mrow><mi>a</mi><mo>&gt;</mo><mn>0</mn></mrow></math> and <math id="S7.SS6.p1.m2" class="ltx_Math" alttext="b&gt;1" display="inline"><mrow><mi>b</mi><mo>&gt;</mo><mn>1</mn></mrow></math> be constants, let <math id="S7.SS6.p1.m3" class="ltx_Math" alttext="f(n)" display="inline"><mrow><mi>f</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></mrow></math> be a function, and let <math id="S7.SS6.p1.m4" class="ltx_Math" alttext="T(n)" display="inline"><mrow><mi>T</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></mrow></math> be non-negative function for large enough <math id="S7.SS6.p1.m5" class="ltx_Math" alttext="n" display="inline"><mi>n</mi></math>.
Then the recurrence <math id="S7.SS6.p1.m6" class="ltx_Math" alttext="T(n)=aT(n/b)+f(n)" display="inline"><mrow><mrow><mi>T</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><mrow><mi>a</mi><mo>⁢</mo><mi>T</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mi>n</mi><mo>/</mo><mi>b</mi></mrow><mo stretchy="false">)</mo></mrow></mrow><mo>+</mo><mrow><mi>f</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></mrow></mrow></mrow></math> has the following asymptotic bounds:</p>
</div>
<div id="S7.SS6.p2" class="ltx_para ltx_noindent">
<ol id="S7.I1" class="ltx_enumerate">
<li id="S7.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1.</span> 
<div id="S7.I1.i1.p1" class="ltx_para ltx_noindent">
<p class="ltx_p">If <math id="S7.I1.i1.p1.m1" class="ltx_Math" alttext="f(n)=O(n^{\log_{b}a-\epsilon})" display="inline"><mrow><mrow><mi>f</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><mi>O</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><msup><mi>n</mi><mrow><mrow><msub><mi>log</mi><mi>b</mi></msub><mo>⁡</mo><mi>a</mi></mrow><mo>-</mo><mi>ϵ</mi></mrow></msup><mo stretchy="false">)</mo></mrow></mrow></mrow></math> for some constant <math id="S7.I1.i1.p1.m2" class="ltx_Math" alttext="\epsilon&gt;0" display="inline"><mrow><mi>ϵ</mi><mo>&gt;</mo><mn>0</mn></mrow></math>, then <math id="S7.I1.i1.p1.m3" class="ltx_Math" alttext="T(n)=\Theta(n^{\log_{b}a})" display="inline"><mrow><mrow><mi>T</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><mi mathvariant="normal">Θ</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><msup><mi>n</mi><mrow><msub><mi>log</mi><mi>b</mi></msub><mo>⁡</mo><mi>a</mi></mrow></msup><mo stretchy="false">)</mo></mrow></mrow></mrow></math>.</p>
</div>
</li>
<li id="S7.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">2.</span> 
<div id="S7.I1.i2.p1" class="ltx_para ltx_noindent">
<p class="ltx_p">If <math id="S7.I1.i2.p1.m1" class="ltx_Math" alttext="f(n)=\Theta(n^{\log_{b}a}\log^{k}n)" display="inline"><mrow><mrow><mi>f</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><mi mathvariant="normal">Θ</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><msup><mi>n</mi><mrow><msub><mi>log</mi><mi>b</mi></msub><mo>⁡</mo><mi>a</mi></mrow></msup><mo>⁢</mo><mrow><msup><mi>log</mi><mi>k</mi></msup><mo>⁡</mo><mi>n</mi></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow></mrow></math> for some constant <math id="S7.I1.i2.p1.m2" class="ltx_Math" alttext="k\geq 0" display="inline"><mrow><mi>k</mi><mo>≥</mo><mn>0</mn></mrow></math>, then <math id="S7.I1.i2.p1.m3" class="ltx_Math" alttext="T(n)=\Theta(n^{\log_{b}a}\log^{k+1}n)" display="inline"><mrow><mrow><mi>T</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><mi mathvariant="normal">Θ</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><msup><mi>n</mi><mrow><msub><mi>log</mi><mi>b</mi></msub><mo>⁡</mo><mi>a</mi></mrow></msup><mo>⁢</mo><mrow><msup><mi>log</mi><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msup><mo>⁡</mo><mi>n</mi></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow></mrow></math>.</p>
</div>
</li>
<li id="S7.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">3.</span> 
<div id="S7.I1.i3.p1" class="ltx_para ltx_noindent">
<p class="ltx_p">If <math id="S7.I1.i3.p1.m1" class="ltx_Math" alttext="f(n)=\Omega(n^{\log_{b}a+\epsilon})" display="inline"><mrow><mrow><mi>f</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><mi mathvariant="normal">Ω</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><msup><mi>n</mi><mrow><mrow><msub><mi>log</mi><mi>b</mi></msub><mo>⁡</mo><mi>a</mi></mrow><mo>+</mo><mi>ϵ</mi></mrow></msup><mo stretchy="false">)</mo></mrow></mrow></mrow></math> for some constant <math id="S7.I1.i3.p1.m2" class="ltx_Math" alttext="\epsilon&gt;0" display="inline"><mrow><mi>ϵ</mi><mo>&gt;</mo><mn>0</mn></mrow></math>, and if <math id="S7.I1.i3.p1.m3" class="ltx_Math" alttext="af(n/b)\leq cf(n)" display="inline"><mrow><mrow><mi>a</mi><mo>⁢</mo><mi>f</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mi>n</mi><mo>/</mo><mi>b</mi></mrow><mo stretchy="false">)</mo></mrow></mrow><mo>≤</mo><mrow><mi>c</mi><mo>⁢</mo><mi>f</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></mrow></mrow></math> for some constant <math id="S7.I1.i3.p1.m4" class="ltx_Math" alttext="c&lt;1" display="inline"><mrow><mi>c</mi><mo>&lt;</mo><mn>1</mn></mrow></math> and all sufficiently large <math id="S7.I1.i3.p1.m5" class="ltx_Math" alttext="n" display="inline"><mi>n</mi></math>, then <math id="S7.I1.i3.p1.m6" class="ltx_Math" alttext="T(n)=\Theta(f(n))" display="inline"><mrow><mrow><mi>T</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><mi mathvariant="normal">Θ</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mi>f</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow></mrow></math>.</p>
</div>
</li>
</ol>
</div>
</section>
<section id="S7.SS7" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">7.7 </span>Acylic Graph</h3>

<div id="S7.SS7.p1" class="ltx_para ltx_noindent">
<p class="ltx_p">A directed graph is acyclic if it has no directed cycles.</p>
</div>
</section>
</section>
<section id="S8" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">8 </span>Problems from Homework</h2>

<section id="S8.SSx1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">Problem 1</h3>

<div id="S8.SSx1.p1" class="ltx_para ltx_noindent">
<p class="ltx_p">Explain why the statement “The running time of Algorithm A is at least <math id="S8.SSx1.p1.m1" class="ltx_Math" alttext="O(n^{2})" display="inline"><mrow><mi>O</mi><mo>⁢</mo><mrow><mo stretchy="false">(</mo><msup><mi>n</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mrow></mrow></math> is meaningless.</p>
</div>
</section>
<section id="S8.SSx2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">Problem 2</h3>

<div id="S8.SSx2.p1" class="ltx_para ltx_noindent">
<p class="ltx_p">Prove by induction that every nonempty binary tree satisfies <math id="S8.SSx2.p1.m1" class="ltx_Math" alttext="|V|=|E|+1" display="inline"><mrow><mrow><mo stretchy="false">|</mo><mi>V</mi><mo stretchy="false">|</mo></mrow><mo>=</mo><mrow><mrow><mo stretchy="false">|</mo><mi>E</mi><mo stretchy="false">|</mo></mrow><mo>+</mo><mn>1</mn></mrow></mrow></math>.</p>
</div>
</section>
</section>
</article>
</div>
</div>
</body>
</html>
